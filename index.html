<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMSÊàêÈïøÁ≥ªÁªü - Â≠¶‰π†ËÆ°ÂàíÊó•ÂéÜ</title>
    <link rel="stylesheet" href="gms.css">
</head>
<body>
    <!-- È°∂ÈÉ®Âõ∫ÂÆöHeader -->
    <header class="top-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="40"  height="40"  viewBox="0 0 24 24"  fill="#607f9e"  class="icon icon-tabler icons-tabler-filled icon-tabler-copy-check"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18.333 6a3.667 3.667 0 0 1 3.667 3.667v8.666a3.667 3.667 0 0 1 -3.667 3.667h-8.666a3.667 3.667 0 0 1 -3.667 -3.667v-8.666a3.667 3.667 0 0 1 3.667 -3.667zm-3.333 -4c1.094 0 1.828 .533 2.374 1.514a1 1 0 1 1 -1.748 .972c-.221 -.398 -.342 -.486 -.626 -.486h-10c-.548 0 -1 .452 -1 1v9.998c0 .32 .154 .618 .407 .805l.1 .065a1 1 0 1 1 -.99 1.738a3 3 0 0 1 -1.517 -2.606v-10c0 -1.652 1.348 -3 3 -3zm1.293 9.293l-3.293 3.292l-1.293 -1.292a1 1 0 0 0 -1.414 1.414l2 2a1 1 0 0 0 1.414 0l4 -4a1 1 0 0 0 -1.414 -1.414" /></svg>
                    <span>Development<br>Management<br>System</span></div>
            </div>
            <nav class="main-nav">
                <a href="#" class="nav-item active" data-page="home">È¶ñÈ°µ</a>
                <a href="#" class="nav-item" data-page="process-management">ËøõÁ®ãÁÆ°ÁêÜ</a>
                <a href="#" class="nav-item" data-page="process">ÁõÆÊ†áÁÆ°ÁêÜ</a>
                <a href="#" class="nav-item" data-page="project">È°πÁõÆÁÆ°ÁêÜ</a>
                <a href="#" class="nav-item" data-page="plan">ËÆ°ÂàíÁÆ°ÁêÜ</a>
                <a href="#" class="nav-item" data-page="learning-resources">Â≠¶‰π†ËµÑÊ∫ê</a>
            </nav>
            <div class="header-right">
                <a href="#" class="nav-item" id="systemsettingBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-settings settings-icon" >
                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                        <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />
                        <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                    </svg>
                    Settings
                </a>
                <a href="#" class="nav-item" id="loginBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
                        <polyline points="10,17 15,12 10,7"/>
                        <line x1="15" y1="12" x2="3" y2="12"/>
                    </svg>
                    ÁôªÂΩï
                </a>
            </div>
        </div>
    </header>


    
    <!-- ÂÜÖÂÆπÂÆπÂô® -->
    <div class="content-container">
        <!-- È¶ñÈ°µÂÆπÂô® -->
        <div class="content-panel active" id="home-panel">
            <div class="panel-content">
                <!-- ÁªüËÆ°Âç°ÁâáÂå∫Âüü -->
                <div class="stats-cards">
                    <div class="stats-card">
                        <div class="stats-icon">üìÖ</div>
                        <div class="stats-content">
                            <div class="stats-title">‰ªäÊó•‰ªªÂä°</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">Â∑≤ÂÆåÊàê</span>
                                    <span class="stats-value" id="todayCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">ÊÄª‰ªªÂä°</span>
                                    <span class="stats-value" id="todayTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">Áî®Êó∂</span>
                                    <span class="stats-value" id="todayTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon">üìä</div>
                        <div class="stats-content">
                            <div class="stats-title">Êú¨Âë®‰ªªÂä°</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">Â∑≤ÂÆåÊàê</span>
                                    <span class="stats-value" id="weekCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">ÊÄª‰ªªÂä°</span>
                                    <span class="stats-value" id="weekTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">Áî®Êó∂</span>
                                    <span class="stats-value" id="weekTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon">üìà</div>
                        <div class="stats-content">
                            <div class="stats-title">Êú¨Êúà‰ªªÂä°</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">Â∑≤ÂÆåÊàê</span>
                                    <span class="stats-value" id="monthCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">ÊÄª‰ªªÂä°</span>
                                    <span class="stats-value" id="monthTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">Áî®Êó∂</span>
                                    <span class="stats-value" id="monthTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon">üéØ</div>
                        <div class="stats-content">
                            <div class="stats-title">Âπ¥‰ªªÂä°Êï∞ÊçÆ</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">Â∑≤ÂÆåÊàê</span>
                                    <span class="stats-value" id="yearCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">ÊÄª‰ªªÂä°</span>
                                    <span class="stats-value" id="yearTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">Áî®Êó∂</span>
                                    <span class="stats-value" id="yearTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÂàÜÁ±ªÁî®Êó∂ÁªüËÆ°ÂÆπÂô® -->
                <div class="category-time-stats">
                    <div class="category-time-header">
                        <div class="category-time-title-section">
                            <h3>ÂàÜÁ±ªÁî®Êó∂ÁªüËÆ°</h3>
                            <select id="categoryTimeFilter" class="category-time-select">
                                <option value="all">ÂÖ®ÈÉ®</option>
                                <option value="thisYear">‰ªäÂπ¥</option>
                                <option value="thisMonth">Êú¨Êúà</option>
                                <option value="1">1Êúà</option>
                                <option value="2">2Êúà</option>
                                <option value="3">3Êúà</option>
                                <option value="4">4Êúà</option>
                                <option value="5">5Êúà</option>
                                <option value="6">6Êúà</option>
                                <option value="7">7Êúà</option>
                                <option value="8">8Êúà</option>
                                <option value="9">9Êúà</option>
                                <option value="10">10Êúà</option>
                                <option value="11">11Êúà</option>
                                <option value="12">12Êúà</option>
                            </select>
                        </div>
                        <span class="category-time-subtitle">ÂêÑÂàÜÁ±ªÂ∑≤ÂÆåÊàê‰ªªÂä°Áî®Êó∂ÂØπÊØî</span>
                    </div>
                    <div class="category-time-bars" id="categoryTimeBars">
                        <!-- ÂàÜÁ±ªÁî®Êó∂Êù°Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
                
                <!-- Êñ∞Â¢ûÁöÑ‰∏§‰∏™Âπ∂ÊéíÂÆπÂô® -->
                <div class="additional-containers">
                    <div class="additional-container left-container">
                        <div class="container-header">
                            <h3>È°πÁõÆÁî®Êó∂ÊéíÂêç</h3>
                            <span class="container-subtitle">Â∑≤ÂÆåÊàê‰ªªÂä°Áî®Êó∂ÊéíË°å</span>
                        </div>
                        <div class="project-time-ranking">
                            <div class="ranking-header">
                                <div class="ranking-project-name">È°πÁõÆÂêçÁß∞</div>
                                <div class="ranking-time">Áî®Êó∂</div>
                                <div class="ranking-progress">ËøõÂ∫¶</div>
                            </div>
                            <div class="ranking-list" id="projectTimeRankingList">
                                <!-- È°πÁõÆÊéíÂêçÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                            </div>
                            <div class="load-more-container" id="loadMoreContainer" style="display: none;">
                                <button class="load-more-btn" id="loadMoreBtn">Âä†ËΩΩÊõ¥Â§ö</button>
                            </div>
                        </div>
                    </div>
                    <div class="additional-container right-container">
                        <div class="container-header">
                            <h3>‰ªªÂä°Áî®Êó∂ÁªüËÆ°</h3>
                            <div class="view-toggle">
                                <button class="toggle-btn active" data-view="daily">ÊåâÊó•</button>
                                <button class="toggle-btn" data-view="monthly">ÊåâÊúà</button>
                            </div>
                        </div>
                        <div class="task-time-stats-container">
                            <!-- ÊåâÊó•ËßÜÂõæ -->
                            <div class="task-time-view daily-view" id="dailyTaskView">
                                <div class="task-time-header">
                                    <div class="task-time-date sortable" data-sort="date">
                                        Êó•Êúü <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-count sortable" data-sort="count">
                                        Â∑≤ÂÆåÊàê <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-duration sortable" data-sort="duration">
                                        Áî®Êó∂ <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-progress">ËøõÂ∫¶</div>
                                </div>
                                <div class="task-time-list" id="dailyTaskList">
                                    <!-- Êó•‰ªªÂä°ÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                                </div>
                            </div>
                            
                            <!-- ÊåâÊúàËßÜÂõæ -->
                            <div class="task-time-view monthly-view" id="monthlyTaskView" style="display: none;">
                                <div class="task-time-header">
                                    <div class="task-time-month sortable" data-sort="month">
                                        Êúà‰ªΩ <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-count sortable" data-sort="count">
                                        Â∑≤ÂÆåÊàê <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-duration sortable" data-sort="duration">
                                        Áî®Êó∂ <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-average sortable" data-sort="average">
                                        Âπ≥ÂùáÁî®Êó∂ <span class="sort-icon">‚Üï</span>
                                    </div>
                                    <div class="task-time-progress">ËøõÂ∫¶</div>
                                </div>
                                <div class="task-time-list" id="monthlyTaskList">
                                    <!-- Êúà‰ªªÂä°ÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="intro-cards">
                    <div class="intro-card">
                        <h3>ËøõÁ®ãÁÆ°ÁêÜËØ¥Êòé</h3>
                        <h4>Process Management</h4>
                        <p>ÂÜÖÂÆπÂáÜÂ§á‰∏≠...</p>
                    </div>
                    <div class="intro-card">
                        <h3>È°πÁõÆÁÆ°ÁêÜËØ¥Êòé</h3>
                        <h4>Project Management</h4>
                        <p>ÂÜÖÂÆπÂáÜÂ§á‰∏≠...</p>
                    </div>
                    <div class="intro-card">
                        <h3>ËÆ°ÂàíÁÆ°ÁêÜ</h3>
                        <h4>Plan Management</h4>
                        <p>ÂÜÖÂÆπÂáÜÂ§á‰∏≠...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ËøõÁ®ãÁÆ°ÁêÜÂÆπÂô® -->
        <div class="content-panel" id="process-management-panel">
            <div class="panel-content">
                <!-- Á¨¨‰∏Ä‰∏™ÂÆπÂô®ÔºöÁª¥Â∫¶ÂíåÁª¥Â∫¶ÂÄºÂ±ïÁ§∫ -->
                <div class="dimension-container">
                    <div class="dimensions-content" id="dimensions-content">
                        <!-- Áª¥Â∫¶Êï∞ÊçÆÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
                    </div>
                </div>
                
                <!-- Á¨¨‰∫å‰∏™ÂÆπÂô®ÔºöÂ∑¶Âè≥ÂàÜÊ†èÂ∏ÉÂ±Ä -->
                <div class="placeholder-container">
                    <div class="split-container">
                        <div class="left-container" id="milestones-container">
                            <!-- ÈáåÁ®ãÁ¢ëÊ†áÈ¢òÂå∫Âüü -->
                            <div class="milestone-header" style="padding: 5px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #eee; margin-bottom: 10px; width: 100%;">
                                <!-- Ê†áÈ¢òÂíåÊêúÁ¥¢Âå∫Âüü -->
                                <div class="milestone-title-section" style="display: flex; align-items: center; gap: 10px; flex: 1;">
                                    <h2 id="milestoneTitle" style="margin: 0; font-size: 24px; color: #333; font-weight: 600; text-align: left;">ÈáåÁ®ãÁ¢ëÂàóË°®</h2>
                                    <!-- ÊêúÁ¥¢ÂõæÊ†á -->
                                    <div class="milestone-search-icon" id="milestoneSearchIcon" style="cursor: pointer; padding: 5px; border-radius: 4px; transition: background-color 0.3s;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <circle cx="11" cy="11" r="8"></circle>
                                            <path d="m21 21-4.35-4.35"></path>
                                        </svg>
                                    </div>
                                    <!-- ÊêúÁ¥¢Ê°Ü -->
                                    <div class="milestone-search-container" id="milestoneSearchContainer" style="display: none; flex: 1; max-width: 300px;">
                                        <input type="text" id="milestoneSearchInput" placeholder="ÊêúÁ¥¢ÈáåÁ®ãÁ¢ë..." style="width: 100%; padding: 8px 35px 8px 12px; border: 1px solid #ddd; border-radius: 20px; font-size: 14px; outline: none; transition: border-color 0.3s;">
                                        <button id="milestoneSearchClose" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 18px; color: #999; cursor: pointer; padding: 0; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">√ó</button>
                                    </div>
                                </div>
                                <div id="addMilestoneBtn" class="add-milestone-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="#50b767" class="icon icon-tabler icons-tabler-filled icon-tabler-square-rounded-plus">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                        <path d="M12 2l.324 .001l.318 .004l.616 .017l.299 .013l.579 .034l.553 .046c4.785 .464 6.732 2.411 7.196 7.196l.046 .553l.034 .579c.005 .098 .01 .198 .013 .299l.017 .616l.005 .642l-.005 .642l-.017 .616l-.013 .299l-.034 .579l-.046 .553c-.464 4.785 -2.411 6.732 -7.196 7.196l-.553 .046l-.579 .034c-.098 .005 -.198 .01 -.299 .013l-.616 .017l-.642 .005l-.642 -.005l-.616 -.017l-.299 -.013l-.579 -.034l-.553 -.046c-4.785 -.464 -6.732 -2.411 -7.196 -7.196l-.046 -.553l-.034 -.579a28.058 28.058 0 0 1 -.013 -.299l-.017 -.616c-.003 -.21 -.005 -.424 -.005 -.642l.001 -.324l.004 -.318l.017 -.616l.013 -.299l.034 -.579l.046 -.553c.464 -4.785 2.411 -6.732 7.196 -7.196l.553 -.046l.579 -.034c.098 -.005 .198 -.01 .299 -.013l.616 -.017c.21 -.003 .424 -.005 .642 -.005zm0 6a1 1 0 0 0 -1 1v2h-2l-.117 .007a1 1 0 0 0 .117 1.993h2v2l.007 .117a1 1 0 0 0 1.993 -.117v-2h2l.117 -.007a1 1 0 0 0 -.117 -1.993h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z" fill="#50b767" stroke-width="0" />
                                    </svg>
                                    <div class="text-button">Ê∑ªÂä†ÈáåÁ®ãÁ¢ë</div>
                                </div>
                            </div>
                            <!-- ÈáåÁ®ãÁ¢ëÊï∞ÊçÆÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
                        </div>
                        <div class="right-container">
                            <p>ÂÜÖÂÆπÂæÖÂºÄÂèë</p>
                        </div>
                    </div>
                </div>
                

            </div>
        </div>
        
        <!-- ÁõÆÊ†áÁÆ°ÁêÜÂÆπÂô® -->
        <div class="content-panel" id="process-panel">
            <!-- Á¨¨‰∏Ä‰∏™ÂÆπÂô® -->
            <div class="goal-container-1" id="process-container-1">
                <div class="container-content">
                    <!-- ÂæÆÁõÆÊ†áÊ†áÁ≠æËøáÊª§Âå∫Âüü -->
                    <div class="micro-goals-filter-section">
                        <div class="filter-tags-container" id="microGoalsFilterTags">
                            <!-- Ê†áÁ≠æÊåâÈíÆÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                    
                    <!-- Êúà‰ªΩÁ≠õÈÄâÂå∫Âüü -->
                    <div class="calendar-filter-section">
                        <div class="calendar-navigation-container">
                            <button class="calendar-nav-btn calendar-nav-prev" id="calendarNavPrev">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="m15 18-6-6 6-6"/>
                                </svg>
                            </button>
                            <div class="calendar-months-container" id="calendarMonthsContainer">
                                <!-- Êúà‰ªΩÊ†áÁ≠æÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                            </div>
                            <button class="calendar-nav-btn calendar-nav-next" id="calendarNavNext">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="m9 18 6-6-6-6"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Á¨¨‰∫å‰∏™ÂÆπÂô® -->
            <div class="goal-container-2" id="process-container-2">
                <div class="container-content">
                    <!-- Â∑¶Âè≥‰∏§‰∏™Èù¢ÊùøÂÆπÂô® -->
                    <div class="left-panel">
                        <!-- Â∑¶‰æßÈù¢ÊùøÂÜÖÂÆπ -->
                        <div class="top-section">
                            <!-- ÁõÆÊ†áÂàóË°®Â§¥ÈÉ® -->
                            <div class="goal-header" style="padding: 5px; display: flex; align-items: center; justify-content: space-between; /* border-bottom: 1px solid #eee; */ margin-bottom: 10px; width: 100%; box-sizing: border-box;">
                                <!-- Ê†áÈ¢òÂå∫Âüü -->
                                <div class="goal-title-section" style="display: flex; align-items: center; gap: 10px; flex: 1; position: relative;">
                                    <!-- Ê†áÈ¢òÂíåÊêúÁ¥¢ÂõæÊ†áÂÆπÂô® -->
                                    <div class="title-search-wrapper" style="display: flex; align-items: center; justify-content: flex-start; gap: 15px; width: 100%;">
                                        <!-- ÊêúÁ¥¢ÂõæÊ†á -->
                                        <div class="search-icon-wrapper" id="searchIconWrapper" style="margin-right: auto;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-svg-icon">
                                                <circle cx="11" cy="11" r="8"></circle>
                                                <path d="m21 21-4.35-4.35"></path>
                                            </svg>
                                        </div>
                                        <h2 id="goalTitle" style="margin: 0; font-size: 24px; color: #333; font-weight: 600; text-align: center; transition: opacity 0.3s ease; flex: 1;">ÁõÆÊ†áÂàóË°®</h2>
                                    </div>
                                    <!-- ÊêúÁ¥¢Ê°ÜÂÆπÂô® -->
                                    <div class="search-input-container" id="searchInputContainer" style="position: absolute; left: 0; top: 0; width: 100%; opacity: 0; visibility: hidden; transition: all 0.3s ease;">
                                        <div class="search-input-wrapper" style="display: flex; align-items: center; background: white; border: 2px solid #50b767; border-radius: 8px; padding: 0; height: 36px; width: 80%;">
                                            <input type="text" id="modernSearchInput" placeholder="ÊêúÁ¥¢ÁõÆÊ†á..." class="modern-search-input" style="flex: 1; border: none; outline: none; padding: 0 12px; font-size: 14px; color: #374151; background: transparent;">
                                            <button id="searchClearBtn" class="search-clear-btn" title="Ê∏ÖÈô§" style="width: 28px; height: 28px; border: none; background: transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #9ca3af; border-radius: 6px; margin-right: 2px; transition: all 0.2s ease;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                                </svg>
                                            </button>
                                            <button id="searchCloseBtn" class="search-close-btn" title="ÂÖ≥Èó≠" style="width: 28px; height: 28px; border: none; background: transparent; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #9ca3af; border-radius: 6px; margin-right: 4px; transition: all 0.2s ease;">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <!-- Ê∑ªÂä†ÁõÆÊ†áÊåâÈíÆ -->
                                <div id="addGoalBtn" class="add-goal-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="#50b767" class="icon icon-tabler icons-tabler-filled icon-tabler-square-rounded-plus">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                        <path d="M12 2l.324 .001l.318 .004l.616 .017l.299 .013l.579 .034l.553 .046c4.785 .464 6.732 2.411 7.196 7.196l.046 .553l.034 .579c.005 .098 .01 .198 .013 .299l.017 .616l.005 .642l-.005 .642l-.017 .616l-.013 .299l-.034 .579l-.046 .553c-.464 4.785 -2.411 6.732 -7.196 7.196l-.553 .046l-.579 .034c-.098 .005 -.198 .01 -.299 .013l-.616 .017l-.642 .005l-.642 -.005l-.616 -.017l-.299 -.013l-.579 -.034l-.553 -.046c-4.785 -.464 -6.732 -2.411 -7.196 -7.196l-.046 -.553l-.034 -.579a28.058 28.058 0 0 1 -.013 -.299l-.017 -.616c-.003 -.21 -.005 -.424 -.005 -.642l.001 -.324l.004 -.318l.017 -.616l.013 -.299l.034 -.579l.046 -.553c.464 -4.785 2.411 -6.732 7.196 -7.196l.553 -.046l.579 -.034c.098 -.005 .198 -.01 .299 -.013l.616 -.017c.21 -.003 .424 -.005 .642 -.005zm0 6a1 1 0 0 0 -1 1v2h-2l-.117 .007a1 1 0 0 0 .117 1.993h2v2l.007 .117a1 1 0 0 0 1.993 -.117v-2h2l.117 -.007a1 1 0 0 0 -.117 -1.993h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z" fill="#50b767" stroke-width="0" />
                                    </svg>
                                    <div class="text-button">Ê∑ªÂä†ÁõÆÊ†á</div>
                                </div>
                            </div>
                        </div>
                        <div class="bottom-section">
                        </div>
                    </div>
                    <div class="right-panel">
                        <div class="panel-section panel-section-1">
                            <div class="default-hint" id="defaultHint">
                                <div class="hint-text">ËØ∑Âú®ÁõÆÊ†áÂàóË°®‰∏≠ÈÄâÊã©ÁõÆÊ†áÊü•Áúã</div>
                            </div>
                        </div>
                        <div class="panel-section panel-section-2">
                            <!-- ÂÖ≥ËÅî‰ªªÂä°Âå∫Âüü -->
                            <div class="related-tasks-section">
                                <!-- Â∑≤ÂÖ≥ËÅî‰ªªÂä°ÊòæÁ§∫Âå∫Âüü -->
                                <div class="related-tasks-container" id="relatedTasksContainer">
                                    <!-- Â∑≤ÂÖ≥ËÅîÁöÑ‰ªªÂä°Ê†áÁ≠æÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÊòæÁ§∫ -->
                                </div>
                                
                                <!-- ÂõûÂà∞È°∂ÈÉ®ÊåâÈíÆ -->
                                <div id="backToTopBtn" class="back-to-top-btn">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="m18 15-6-6-6 6"/>
                                    </svg>
                                </div>
                            </div>
                            
                        </div>
                        <div class="panel-section panel-section-2 panel-section-record" style="display: none;">
                            <!-- ËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÂÜÖÂÆπ -->
                            <div class="progress-record-section">
                                <!-- Á¨¨‰∏ÄÈÉ®ÂàÜÔºöÁõÆÊ†áÊèèËø∞Ê°Ü -->
                                <div class="goal-description-section">
                                    
                                    <div class="goal-description-content" id="recordGoalDescription">
                                        <!-- ÁõÆÊ†áÊèèËø∞ÂÜÖÂÆπÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                                        <p class="placeholder-text">ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†áÊü•ÁúãÊèèËø∞</p>
                                    </div>
                                </div>
                                
                                <!-- ËøõÂ±ïËÆ∞ÂΩïÊ†áÈ¢òÂíåÂàÜÂâ≤Á∫ø -->
                                <div class="progress-records-header">
                                    <h3 class="progress-records-title">ËøõÂ±ïËÆ∞ÂΩï</h3>
                                    <div class="progress-records-divider"></div>
                                </div>
                                
                                <!-- Á¨¨‰∫åÈÉ®ÂàÜÔºöËøõÂ±ïËÆ∞ÂΩïÂå∫Âüü -->
                                <div class="progress-records-section" id="progressRecordsSection">
                                    <p class="progress-placeholder-text" id="progressPlaceholderText">ËØ∑Âú®Ê≠§Â§ÑÂ°´ÂÜôËøõÂ±ï... ...<svg  xmlns="http://www.w3.org/2000/svg"  width="20"  height="20"  viewBox="0 0 24 24"  fill="none"  stroke="#ccc"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-edit"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1" /><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z" /><path d="M16 5l3 3" /></svg></p>
                                    <div class="progress-input-form" id="progressInputForm" style="display: none;">
                                        <div class="progress-form-row">
                                            <div class="progress-form-field">
                                                <label>Áä∂ÊÄÅÔºö</label>
                                                <select id="progressStatus" class="progress-select">
                                                    <option value="ÊöÇÊó†">ÊöÇÊó†</option>
                                                    <option value="Ê≠£Â∏∏">Ê≠£Â∏∏</option>
                                                    <option value="È£éÈô©">È£éÈô©</option>
                                                    <option value="Âª∂Êúü">Âª∂Êúü</option>
                                                </select>
                                            </div>
                                            <div class="progress-form-field">
                                                <label>È¢ÑÊúüÔºö</label>
                                                <select id="progressExpectation" class="progress-select">
                                                    <option value="Á¨¶ÂêàÈ¢ÑÊúü">Á¨¶ÂêàÈ¢ÑÊúü</option>
                                                    <option value="Ë∂ÖÂá∫È¢ÑÊúü">Ë∂ÖÂá∫È¢ÑÊúü</option>
                                                    <option value="‰Ωé‰∫éÈ¢ÑÊúü">‰Ωé‰∫éÈ¢ÑÊúü</option>
                                                    <option value="‰∏•Èáç‰Ωé‰∫éÈ¢ÑÊúü">‰∏•Èáç‰Ωé‰∫éÈ¢ÑÊúü</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="progress-form-content">
                                            <div id="progressContent" class="progress-editor" contenteditable="true" data-placeholder="ËøôÈáåÊòØËæìÂÖ•Ê°Ü"></div>
                                        </div>
                                        <div class="progress-form-toolbar">
                                            <div class="progress-toolbar-left">
                                                <button type="button" class="toolbar-btn"><strong>B</strong></button>
                                                <button type="button" class="toolbar-btn"><em>S</em></button>
                                                <button type="button" class="toolbar-btn"><u>A</u></button>
                                                <button type="button" class="toolbar-btn">‚â°</button>
                                                <button type="button" class="toolbar-btn">‚ãÆ‚ãÆ‚ãÆ</button>
                                                <button type="button" class="toolbar-btn">üîó</button>
                                                <button type="button" class="toolbar-btn">‚òë</button>
                                                <div class="color-picker-container">
                                                    <button type="button" class="toolbar-btn color-btn" id="colorPickerBtn">üé®</button>
                                                    <input type="color" id="colorPicker" class="color-input" value="#000000">
                                                </div>
                                            </div>
                                            <div class="progress-toolbar-right">
                                                <button type="button" class="progress-cancel-btn" id="progressCancelBtn">ÂèñÊ∂à</button>
                                                <button type="button" class="progress-submit-btn" id="progressSubmitBtn">ÂèëÂ∏É</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Á¨¨‰∏âÈÉ®ÂàÜÔºöËøõÂ±ïËÆ∞ÂΩïÂ±ïÁ§∫Âå∫Âüü -->
                                <div class="progress-records-display" id="progressRecordsDisplaySection">
                                    <div class="records-list" id="progressRecordsList">
                                        <div class="records-empty">ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†áÊü•ÁúãËøõÂ±ïËÆ∞ÂΩï</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel-section panel-section-3">
                            <!-- ÁõÆÊ†áÊèèËø∞ÂíåÂÖ≥ËÅî‰ªªÂä°ÊåâÈíÆÁöÑÁà∂ÂÆπÂô® -->
                            <div class="goal-description-button-container">
                                <!-- ÁõÆÊ†áÂÖ≥ËÅî‰ªªÂä°Êï∞ÊçÆÂÆπÂô® -->
                                <div class="goal-tasks-info">
                                    <!-- ‰ªªÂä°ÁªüËÆ°ÂÆπÂô®Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÊ∑ªÂä†Âà∞ËøôÈáå -->
                                </div>
                                
                                <!-- ËøîÂõû‰ªªÂä°ÊåâÈíÆ -->
                                <button class="back-to-tasks-btn" id="backToTasksBtn" style="flex-shrink: 0; margin-right: 10px; display: none;">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                       <path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 14l-4 -4l4 -4" />
                                       <path d="M5 10h11a4 4 0 1 1 0 8h-1" />
                                    </svg>
                                </button>
                                
                                <!-- ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆ -->
                                <button class="add-related-task-btn" id="progressRecordBtn" style="flex-shrink: 0; margin-right: 10px;">
                                    <span class="btn-icon"><svg  xmlns="http://www.w3.org/2000/svg"  width="20"  height="20"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-timeline-event"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 20m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M10 20h-6" /><path d="M14 20h6" /><path d="M12 15l-2 -2h-3a1 1 0 0 1 -1 -1v-8a1 1 0 0 1 1 -1h10a1 1 0 0 1 1 1v8a1 1 0 0 1 -1 1h-3l-2 2z" /></svg></span>
                                    <span class="btn-text">ËøõÂ±ïËÆ∞ÂΩï (0)</span>
                                </button>
                                
                                <!-- Ê∑ªÂä†ÂÖ≥ËÅî‰ªªÂä°ÊåâÈíÆ -->
                                <button class="add-related-task-btn" id="addRelatedTaskBtn" style="flex-shrink: 0;">
                                    <span class="btn-icon"><svg  xmlns="http://www.w3.org/2000/svg"  width="20"  height="20"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-copy-plus"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path stroke="none" d="M0 0h24v24H0z" /><path d="M7 9.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2 2 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /><path d="M11 14h6" /><path d="M14 11v6" /></svg></span>
                                    <span class="btn-text">ÂÖ≥ËÅî‰ªªÂä°</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            

        </div>
        
        <!-- È°πÁõÆÁÆ°ÁêÜÂÆπÂô® -->
        <div class="content-panel" id="project-panel">
            <div class="panel-content">
                
                <!-- ÊêúÁ¥¢ÂíåÁ≠õÈÄâÈù¢Êùø -->
                <div class="project-search-panel">
                    <!-- ÊêúÁ¥¢Âå∫Âüü - Â∑≤ÁßªËá≥Ê†áÈ¢òÊ†è -->
                    <!-- ÂàÜÁ±ªÊ†áÁ≠æÂå∫Âüü -->
                    <div class="category-section">
                        <span class="category-label">ÂàÜÁ±ªÔºö</span>
                        <div id="projectPanelCategoryTags" class="category-tags-container"></div>
                    </div>
                </div>
                
                <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
                <div class="project-main-content">
                    <!-- Â∑¶‰æßÁõÆÊ†áÊ∏ÖÂçï -->
                    <div class="project-list-section">
                        <div class="project-list-header">
                            <!-- ÊêúÁ¥¢ÂõæÊ†á -->
                            <div class="search-icon-container" id="searchIconContainer">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <path d="m21 21-4.35-4.35"></path>
                                </svg>
                                <!-- Â±ïÂºÄÁöÑÊêúÁ¥¢Ê°Ü -->
                                <div class="search-input-expanded" id="searchInputExpanded">
                                    <input type="text" id="headerProjectSearch" placeholder="ÊêúÁ¥¢È°πÁõÆ..." class="header-search-input">
                                    <button id="headerClearSearch" class="header-clear-btn">√ó</button>
                                </div>
                            </div>
                            <h3>ÁõÆÊ†áÊ∏ÖÂçï</h3>
                            <div id="addProjectBtn" class="add-project-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="#50b767" class="icon icon-tabler icons-tabler-filled icon-tabler-square-rounded-plus">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                    <path d="M12 2l.324 .001l.318 .004l.616 .017l.299 .013l.579 .034l.553 .046c4.785 .464 6.732 2.411 7.196 7.196l.046 .553l.034 .579c.005 .098 .01 .198 .013 .299l.017 .616l.005 .642l-.005 .642l-.017 .616l-.013 .299l-.034 .579l-.046 .553c-.464 4.785 -2.411 6.732 -7.196 7.196l-.553 .046l-.579 .034c-.098 .005 -.198 .01 -.299 .013l-.616 .017l-.642 .005l-.642 -.005l-.616 -.017l-.299 -.013l-.579 -.034l-.553 -.046c-4.785 -.464 -6.732 -2.411 -7.196 -7.196l-.046 -.553l-.034 -.579a28.058 28.058 0 0 1 -.013 -.299l-.017 -.616c-.003 -.21 -.005 -.424 -.005 -.642l.001 -.324l.004 -.318l.017 -.616l.013 -.299l.034 -.579l.046 -.553c.464 -4.785 2.411 -6.732 7.196 -7.196l.553 -.046l.579 -.034c.098 -.005 .198 -.01 .299 -.013l.616 -.017c.21 -.003 .424 -.005 .642 -.005zm0 6a1 1 0 0 0 -1 1v2h-2l-.117 .007a1 1 0 0 0 .117 1.993h2v2l.007 .117a1 1 0 0 0 1.993 -.117v-2h2l.117 -.007a1 1 0 0 0 -.117 -1.993h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z" fill="#50b767" stroke-width="0" />
                                </svg>
                                <div class="text-button">Ê∑ªÂä†È°πÁõÆ</div>
                            </div>
                        </div>
                        <div id="projectPanelList" class="project-panel-list">
                            <!-- ÂºπÂäõÂå∫Âüü -->
                            <div class="bounce-area">
                                <div class="bounce-message">
                                    <span class="bounce-icon">üîù</span>
                                    <span>Â∑≤ÁªèÂà∞È°∂Âï¶ÔºÅ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Âè≥‰æßÂ≠ê‰ªªÂä°Â±ïÁ§∫ -->
                    <div class="subtask-section">
                        <div class="subtask-header">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <h3>ÂÖ≥ËÅîÁöÑ‰ªªÂä°</h3>
                                <span id="selectedProjectName" class="selected-project-name"></span>
                            </div>

                        </div>
                        

                        
                        <div id="projectPanelSubtaskList" class="subtask-panel-list"></div>
                        
                        <!-- Â≠ê‰ªªÂä°Â∫ïÈÉ®Êìç‰ΩúÊ†è -->
                        <div class="subtask-bottom" id="subtaskBottom" style="display: none;">
                            <div class="subtask-bottom-left">
                                <label class="select-all-checkbox">
                                    <input type="checkbox" id="selectAllSubtasks">
                                    <span>ÂÖ®ÈÄâÊú™ÂÆåÊàê‰ªªÂä° <span class="selected-count">(0)</span></span>
                                </label>
                            </div>
                            <div class="subtask-bottom-right">
                                <button class="batch-btn batch-delete-btn" id="batchDeleteSubtasks" disabled>ÊâπÈáèÂà†Èô§</button>
                                <div style="position: relative;">
                                    <button class="batch-btn batch-edit-btn" id="batchEditSubtasks" disabled>ÊâπÈáèÁºñËæë</button>
                                    <div class="batch-edit-menu" id="batchEditMenu">
                                        <div class="batch-menu-item" data-action="consumingTime">ÊâπÈáèÊîπÁî®Êó∂</div>
                                        <div class="batch-menu-item" data-action="schedule">ÊâπÈáèÊéíÊúü</div>
                                        <div class="batch-menu-item" data-action="editPoints">ÊâπÈáè‰øÆÊîπÁßØÂàÜ</div>
                                        <div class="batch-menu-item" data-action="startTime">ÊâπÈáèÂºÄÂßãÊó∂Èó¥</div>
                                        <div class="batch-menu-item" data-action="complete">ÊâπÈáèÂÆåÊàê</div>
                                        <div class="batch-menu-item" data-action="dailyPlan">ÊâπÈáèËÆ°ÂàíÊØèÂ§©</div>
                                        <div class="batch-menu-item" data-action="weeklyPlan">ÊâπÈáèËÆ°ÂàíÊØèÂë®</div>
                                        <div class="batch-menu-item" data-action="noPlan">ÊâπÈáèÂèñÊ∂àËÆ°Âàí</div>
                                        <div class="batch-menu-item" data-action="unifyName">Áªü‰∏ÄÂêçÁß∞</div>
                                        <div class="batch-menu-item" data-action="unifyDate">Áªü‰∏ÄÊó•Êúü</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    

                </div>
            </div>
        </div>
        
                <!-- Â≠¶‰π†ËµÑÊ∫êÂÆπÂô® -->
        <div class="content-panel" id="learning-resources-panel">
            <div class="panel-content">
                <div class="learning-resources-container">
                    <div class="resources-header">
                        <h2>Â≠¶‰π†ËµÑÊ∫êÁÆ°ÁêÜ</h2>
                        <p>ÁÆ°ÁêÜÊÇ®ÁöÑÂ≠¶‰π†ËµÑÊ∫êÈìæÊé•ÔºåÊîØÊåÅÂ§ñÈÉ®ÈìæÊé•ÂíåÊú¨Âú∞Êñá‰ª∂</p>
                    </div>
                    
                    <!-- Â≠¶‰π†ËµÑÊ∫êË°®Ê†º -->
                    <div class="resources-table-container">
                        <table class="resources-table" id="resourcesTable">
                            <tbody id="resourcesTableBody">
                                <!-- Ë°®Ê†ºË°åÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
                            </tbody>
                        </table>
                        
                        <!-- Ë°åÁÆ°ÁêÜÊåâÈíÆ -->
                        <div class="row-controls">
                            <button class="add-row-btn" id="addRowBtn" title="Ê∑ªÂä†Ë°å">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Ê∑ªÂä†Ë°å
                            </button>
                            <button class="delete-row-btn" id="deleteRowBtn" title="Âà†Èô§Á©∫Ë°å">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                                Âà†Èô§Á©∫Ë°å
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- ÁºñËæëÂºπÁ™ó -->
                <div class="edit-modal" id="editModal" style="display: none;">
                    <div class="edit-modal-content">
                        <div class="edit-modal-header">
                            <h3>ÁºñËæëËµÑÊ∫ê</h3>
                            <button class="close-btn" id="closeEditModal">&times;</button>
                        </div>
                        <div class="edit-modal-body">
                            <div class="form-group">
                                <label for="resourceTitle">Ê†áÈ¢òÔºö</label>
                                <input type="text" id="resourceTitle" placeholder="ËØ∑ËæìÂÖ•ËµÑÊ∫êÊ†áÈ¢ò">
                            </div>
                            <div class="form-group">
                                <label for="resourceLink">ÈìæÊé•Ôºö</label>
                                <input type="text" id="resourceLink" placeholder="ËØ∑ËæìÂÖ•ÈìæÊé•ÊàñÊú¨Âú∞Êñá‰ª∂ÂêçÔºàÊîØÊåÅhtml„ÄÅjpg„ÄÅjpeg„ÄÅpng„ÄÅpdfÔºâ">
                                <small>ÊîØÊåÅÂ§ñÈÉ®ÈìæÊé•ÊàñÊú¨Âú∞Êñá‰ª∂ÂêçÔºåÂ¶ÇÔºötest.html</small>
                            </div>
                        </div>
                        <div class="edit-modal-footer">
                            <button class="save-btn" id="saveResource">‰øùÂ≠ò</button>
                            <button class="cancel-btn" id="cancelEdit">ÂèñÊ∂à</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ËÆ°ÂàíÁÆ°ÁêÜÂÆπÂô® -->
        <div class="content-panel" id="plan-panel">
            <div class="calendar-container">
                <div class="month-view active-view" id="monthView">
                    <div class="day-panel" id="dayPanel">
                        
                    </div>
                    <div class="month-panel" id="monthPanel"></div>
                    <div class="taskpicker-panel" id="taskpickerPanel">
                        <div class="taskpicker-header">
                          <!--  <h3 style="text-align: center; color: #50b767; margin-bottom: 15px;">‰ªªÂä°ÈÄâÊã©Âô®</h3>-->
                            
                            <!-- ÊêúÁ¥¢ÂäüËÉΩ -->
                            <div class="taskpicker-search-section">
                                <div class="taskpicker-search-section-left">Âú®ËøôÈáåÈÄâÊã©Ë¶ÅÊ∑ªÂä†ÁöÑ‰ªªÂä°Ôºö</div>
                                <input type="text" id="taskpickerSearchInput" placeholder="ÊêúÁ¥¢È°πÁõÆÊàñ‰ªªÂä°..." class="taskpicker-search-input">
                                <button id="taskpickerClearSearch" class="taskpicker-clear-btn">Ê∏ÖÈô§</button>
                </div>
                            
                            <!-- ÂàÜÁ±ªÊ†áÁ≠æ -->
                            <div class="taskpicker-category-section">
                                <span class="taskpicker-category-label">ÂàÜÁ±ªÔºö</span>
                                <div id="taskpickerCategoryTags" class="taskpicker-category-tags-container"></div>
                            </div>
                        </div>
                        
                        <div id="projectListContainer" class="project-list-container">
                            <!-- È°πÁõÆÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ê®°ÊÄÅÈÅÆÁΩ©Â±Ç -->
    <div id="modalOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999;"></div>
    
    <!-- ËÆæÁΩÆÂºπÁ™ó -->
    <div id="calendarSettingModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 630px; background: white; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 2000; padding: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
            <h3 style="margin: 0;">Êó•ÂéÜËÆæÁΩÆ</h3>
           <button id="closeSettingsBtn" style="background: transparent; border: none; font-size: 20px; cursor: pointer;">&times;</button>
        </div>
        <div style="display: flex; border-bottom: 1px solid #eee; margin-bottom: 15px;">
            <button class="tab-btn active" data-tab="holidays" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #50b767;">ËäÇÂÅáÊó•ËÆæÁΩÆ</button>
            <button class="tab-btn" data-tab="temporary" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">‰∏¥Êó∂ËÆ°ÂàíÁÆ°ÁêÜ</button>
            <button class="tab-btn" data-tab="schedule" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">ËØæË°®ËÆæÁΩÆ</button>
        </div>
        <div class="tab-content" id="holidaysContent">
            <!-- ËäÇÂÅáÊó•ËÆæÁΩÆÂÜÖÂÆπ -->
            <div style="margin-bottom: 15px;">
                <h4 style="margin: 0 0 10px 0;">Ëá™ÂÆö‰πâËäÇÂÅáÊó•</h4>
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <input type="text" id="holidayDate" placeholder="Êó•Êúü (MM-DD)" style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="text" id="holidayName" placeholder="ËäÇÂÅáÊó•ÂêçÁß∞" style="flex: 2; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <button id="addHolidayBtn" style="padding: 8px 15px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer;">Ê∑ªÂä†</button>
                    <button id="refreshHolidaysBtn" style="padding: 8px 15px; background: #ffc107; color: white; border: none; border-radius: 4px; cursor: pointer;">Âà∑Êñ∞ÂàóË°®</button>
                </div>

            </div>
            <div>
                <h4 style="margin: 0 0 10px 0;">ËäÇÂÅáÊó•ÂàóË°®</h4>
                <div id="holidaysList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 4px; padding: 10px;"></div>
            </div>
        </div>
        <div class="tab-content" id="temporaryContent" style="display: none;">
            <!-- ‰∏¥Êó∂ËÆ°ÂàíÁÆ°ÁêÜÂÜÖÂÆπ -->
            <div style="margin-bottom: 15px;">
                <h4 style="margin: 0 0 10px 0;">Ê∑ªÂä†‰∏¥Êó∂ËÆ°Âàí</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" id="planName" placeholder="ËÆ°ÂàíÂêçÁß∞" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="date" id="planDate" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="time" id="planStartTime" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="time" id="planEndTime" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <button id="addPlanBtn" style="padding: 8px 15px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer;">Ê∑ªÂä†ËÆ°Âàí</button>
            </div>
            <div>
                <h4 style="margin: 0 0 10px 0;">‰∏¥Êó∂ËÆ°ÂàíÂàóË°®</h4>
                <div id="plansList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 4px; padding: 10px;"></div>
            </div>
        </div>
        <div class="tab-content" id="scheduleContent" style="display: none;">
            <!-- ËØæË°®ËÆæÁΩÆÂÜÖÂÆπ -->
            <div style="margin-bottom: 15px;">
                <h4 style="margin: 0 0 10px 0;">Ê∑ªÂä†ËØæÁ®ã</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" id="courseName" placeholder="ËØæÁ®ãÂêçÁß∞" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <select id="courseDay" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                        <option value="">ÈÄâÊã©ÊòüÊúü</option>
                        <option value="1">ÊòüÊúü‰∏Ä</option>
                        <option value="2">ÊòüÊúü‰∫å</option>
                        <option value="3">ÊòüÊúü‰∏â</option>
                        <option value="4">ÊòüÊúüÂõõ</option>
                        <option value="5">ÊòüÊúü‰∫î</option>
                        <option value="6">ÊòüÊúüÂÖ≠</option>
                        <option value="0">ÊòüÊúüÊó•</option>
                    </select>
                    <input type="time" id="courseStartTime" placeholder="ÂºÄÂßãÊó∂Èó¥" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="time" id="courseEndTime" placeholder="ÁªìÊùüÊó∂Èó¥" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="text" id="courseLocation" placeholder="‰∏äËØæÂú∞ÁÇπ" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="text" id="courseTeacher" placeholder="‰ªªËØæÊïôÂ∏à" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <button id="addCourseBtn" style="padding: 8px 15px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer;">Ê∑ªÂä†ËØæÁ®ã</button>
            </div>
            <div>
                <h4 style="margin: 0 0 10px 0;">ËØæÁ®ãË°®</h4>
                <div id="coursesList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 4px; padding: 10px;"></div>
            </div>
        </div>

        <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
            <button id="confirmSettingsBtn" style="padding: 5px 10px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">Á°ÆËÆ§</button>
        </div>
    </div>

    <!-- Á≥ªÁªüËÆæÁΩÆÂºπÁ™ó -->
    <div id="systemSettingModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 630px; background: white; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 2000; padding: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
            <h3 style="margin: 0;">Á≥ªÁªüËÆæÁΩÆ</h3>
            <button id="closeSystemSettingBtn" style="background: transparent; border: none; font-size: 20px; cursor: pointer;">&times;</button>
        </div>
        <div style="display: flex; border-bottom: 1px solid #eee; margin-bottom: 15px;">
            <button class="system-tab-btn active" data-tab="backup" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #50b767;">Êï∞ÊçÆÂ§á‰ªΩ</button>
            <button class="system-tab-btn" data-tab="autoBackup" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">Ëá™Âä®Â§á‰ªΩËÆæÁΩÆ</button>
            <button class="system-tab-btn" data-tab="basic" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">Âü∫Êú¨ËÆæÁΩÆ</button>
        </div>
        <div class="system-tab-content" id="systemBackupContent">
            <!-- Êï∞ÊçÆÂ§á‰ªΩÂíåÊÅ¢Â§çÂÜÖÂÆπ -->
            <div style="height: 400px; overflow-y: auto; padding-right: 10px;">
                <h4 style="margin: 0 0 15px 0; color: #50b767;">üíæ Êï∞ÊçÆÂ§á‰ªΩ‰∏éÊÅ¢Â§ç</h4>
                
                <!-- Â§á‰ªΩÂäüËÉΩ -->
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 10px 0; color: #333;">üì§ Â§á‰ªΩÊï∞ÊçÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 13px; color: #666;">Â∞ÜÂΩìÂâçÊâÄÊúâÊï∞ÊçÆÂØºÂá∫‰∏∫Â§á‰ªΩÊñá‰ª∂ÔºåÂåÖÂê´È°πÁõÆ„ÄÅÊ†áÁ≠æ„ÄÅËÆæÁΩÆÁ≠â‰ø°ÊÅØ„ÄÇ</p>
                    <button id="manualBackupBtn" style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">Á´ãÂç≥Â§á‰ªΩ</button>
                </div>
                
                <!-- ÊÅ¢Â§çÂäüËÉΩ -->
                <div style="margin-bottom: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                    <h5 style="margin: 0 0 10px 0; color: #856404;">üì• ÊÅ¢Â§çÊï∞ÊçÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 13px; color: #856404;">‚ö†Ô∏è Ë≠¶ÂëäÔºöÊÅ¢Â§çÊï∞ÊçÆÂ∞ÜË¶ÜÁõñÂΩìÂâçÊâÄÊúâÊï∞ÊçÆÔºåËØ∑Ë∞®ÊÖéÊìç‰ΩúÔºÅ</p>
                    <input type="file" id="restoreFileInput" accept=".json" style="display: none;">
                    <button id="restoreDataBtn" style="padding: 8px 16px; background: #ffc107; color: #333; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">ÈÄâÊã©Â§á‰ªΩÊñá‰ª∂ÊÅ¢Â§ç</button>
                </div>
                
                <!-- localStorage‰ΩøÁî®ÈáèÁõëÊéß -->
                <div style="margin-bottom: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                    <h5 style="margin: 0 0 10px 0; color: #856404;">üíæ localStorage‰ΩøÁî®ÈáèÁõëÊéß</h5>
                    <p style="margin: 0 0 15px 0; font-size: 13px; color: #856404;">ÁõëÊéßÊµèËßàÂô®Êú¨Âú∞Â≠òÂÇ®Á©∫Èó¥‰ΩøÁî®ÊÉÖÂÜµ</p>
                    
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <span style="font-size: 13px; color: #856404;">‰ΩøÁî®ËøõÂ∫¶</span>
                            <span id="storageUsageText" style="font-size: 12px; color: #856404; font-weight: bold;">0 KB / 5 MB</span>
                        </div>
                        <div style="width: 100%; height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">
                            <div id="storageUsageBar" style="height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); width: 0%; transition: width 0.3s ease; border-radius: 4px;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #856404;">
                        <span>Â∑≤‰ΩøÁî®Ôºö<span id="usedStorage">0 KB</span></span>
                        <span>ÂèØÁî®Ôºö<span id="availableStorage">5 MB</span></span>
                    </div>
                    
                    <div style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.5); border-radius: 4px;">
                        <div style="font-size: 11px; color: #856404;">
                            <div style="margin-bottom: 3px;">üìä Â≠òÂÇ®ËØ¶ÊÉÖÔºö</div>
                            <div id="storageDetails" style="font-family: monospace; font-size: 10px;">
                                <!-- Âä®ÊÄÅÊòæÁ§∫Â≠òÂÇ®ËØ¶ÊÉÖ -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Â§á‰ªΩËØ¥Êòé -->
                <div style="padding: 15px; background: #e7f3ff; border-radius: 8px; border: 1px solid #b3d9ff;">
                    <h5 style="margin: 0 0 10px 0; color: #0066cc;">‚ÑπÔ∏è Â§á‰ªΩËØ¥Êòé</h5>
                    <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #0066cc;">
                        <li>Ëá™Âä®Â§á‰ªΩÔºöÊ†πÊçÆËÆæÁΩÆËá™Âä®Â§á‰ªΩÔºàÂèØÂú®"Ëá™Âä®Â§á‰ªΩËÆæÁΩÆ"‰∏≠ÈÖçÁΩÆÔºâ</li>
                        <li>ÊâãÂä®Â§á‰ªΩÔºöÁÇπÂáª"Á´ãÂç≥Â§á‰ªΩ"ÊåâÈíÆÊâãÂä®ÂàõÂª∫Â§á‰ªΩ</li>
                        <li>Â§á‰ªΩÊñá‰ª∂ÔºöÂåÖÂê´È°πÁõÆ„ÄÅÊ†áÁ≠æ„ÄÅËÆæÁΩÆÁ≠âÂÆåÊï¥Êï∞ÊçÆ</li>
                        <li>Êñá‰ª∂‰ΩçÁΩÆÔºöÂ§á‰ªΩÊñá‰ª∂Â∞Ü‰∏ãËΩΩÂà∞ÊÇ®ÁöÑ"‰∏ãËΩΩ"Êñá‰ª∂Â§π</li>
                        <li>ËØ¶ÁªÜËÆæÁΩÆÔºöËØ∑Êü•Áúã"Ëá™Âä®Â§á‰ªΩËÆæÁΩÆ"Ê†áÁ≠æÈ°µ</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="system-tab-content" id="systemAutoBackupContent" style="display: none;">
            <!-- Ëá™Âä®Â§á‰ªΩËÆæÁΩÆÂÜÖÂÆπ -->
            <div style="height: 400px; overflow-y: auto; padding-right: 10px;">
                <h4 style="margin: 0 0 15px 0; color: #50b767;">‚öôÔ∏è Ëá™Âä®Â§á‰ªΩËÆæÁΩÆ</h4>
                
                <!-- Ëá™Âä®Â§á‰ªΩÂºÄÂÖ≥ -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                        <div>
                            <h5 style="margin: 0 0 3px 0; color: #333; font-size: 14px;">üîÑ Ëá™Âä®Â§á‰ªΩÂäüËÉΩ</h5>
                            <p style="margin: 0; font-size: 12px; color: #666;">ÂêØÁî®ÂêéÔºåÁ≥ªÁªü‰ºöÂú®Êï∞ÊçÆÂèòÊõ¥Êó∂Ëá™Âä®ÂàõÂª∫Â§á‰ªΩ</p>
                        </div>
                        <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                            <input type="checkbox" id="autoBackupEnabled" style="opacity: 0; width: 0; height: 0;">
                            <span id="autoBackupToggle" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;">
                                <span id="autoBackupSlider" style="position: absolute; content: ''; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%;"></span>
                            </span>
                        </label>
                    </div>
                </div>
                
                <!-- Â§á‰ªΩÈó¥ÈöîËÆæÁΩÆ -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">‚è±Ô∏è Â§á‰ªΩÈó¥ÈöîËÆæÁΩÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">ËÆæÁΩÆËá™Âä®Â§á‰ªΩÁöÑÊúÄÂ∞èÊó∂Èó¥Èó¥ÈöîÔºåÈÅøÂÖçÈ¢ëÁπÅÂ§á‰ªΩ</p>
                    
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <label style="font-size: 13px; color: #333;">ÊúÄÂ∞èÂ§á‰ªΩÈó¥ÈöîÔºö</label>
                        <select id="backupIntervalSelect" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            <option value="1">1ÂàÜÈíü</option>
                            <option value="5" selected>5ÂàÜÈíü</option>
                            <option value="10">10ÂàÜÈíü</option>
                            <option value="15">15ÂàÜÈíü</option>
                            <option value="30">30ÂàÜÈíü</option>
                            <option value="60">1Â∞èÊó∂</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label style="font-size: 13px; color: #333;">Âª∂ËøüÊâßË°åÊó∂Èó¥Ôºö</label>
                        <select id="backupDelaySelect" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            <option value="1">1Áßí</option>
                            <option value="2" selected>2Áßí</option>
                            <option value="3">3Áßí</option>
                            <option value="5">5Áßí</option>
                        </select>
                    </div>
                </div>
                
                <!-- Â§á‰ªΩÊ®°ÂºèËÆæÁΩÆ -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">üìÅ Â§á‰ªΩÊ®°ÂºèËÆæÁΩÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">ÈÄâÊã©Ëá™Âä®Â§á‰ªΩÁöÑË°å‰∏∫ÊñπÂºè</p>
                    
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="radio" id="backupModeDownload" name="backupMode" value="download" checked>
                            <span>Ëá™Âä®‰∏ãËΩΩÂ§á‰ªΩÊñá‰ª∂</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">ÊØèÊ¨°Â§á‰ªΩÊó∂Ëá™Âä®‰∏ãËΩΩÊñá‰ª∂Âà∞‰∏ãËΩΩÊñá‰ª∂Â§π</p>
                    </div>
                    
                    <div>
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="radio" id="backupModeSilent" name="backupMode" value="silent">
                            <span>ÈùôÈªò‰øùÂ≠òÂà∞ÊµèËßàÂô®</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">Â§á‰ªΩÊñá‰ª∂‰øùÂ≠òÂú®ÊµèËßàÂô®ÂÜÖÈÉ®Ôºå‰∏çËá™Âä®‰∏ãËΩΩ</p>
                    </div>
                </div>
                
                <!-- Â§á‰ªΩÈÄöÁü•ËÆæÁΩÆ -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">üîî Â§á‰ªΩÈÄöÁü•ËÆæÁΩÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">ËÆæÁΩÆÂ§á‰ªΩÂÆåÊàêÂêéÁöÑÈÄöÁü•ÊñπÂºè</p>
                    
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="checkbox" id="backupNotificationEnabled" checked>
                            <span>ÊòæÁ§∫Â§á‰ªΩÁä∂ÊÄÅÊèêÁ§∫</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">Â§á‰ªΩÂÆåÊàêÂêéÂú®Âè≥‰∏äËßíÊòæÁ§∫Áä∂ÊÄÅÊèêÁ§∫</p>
                    </div>
                    
                    <div>
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="checkbox" id="backupConsoleLogEnabled" checked>
                            <span>Âú®ÊéßÂà∂Âè∞ËæìÂá∫Êó•Âøó</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">Âú®ÊµèËßàÂô®ÊéßÂà∂Âè∞ÊòæÁ§∫ËØ¶ÁªÜÁöÑÂ§á‰ªΩÊó•Âøó</p>
                    </div>
                </div>
                
                <!-- ÂΩìÂâçËÆæÁΩÆÁä∂ÊÄÅ -->
                <div style="padding: 12px; background: #e7f3ff; border-radius: 8px; border: 1px solid #b3d9ff;">
                    <h5 style="margin: 0 0 8px 0; color: #0066cc; font-size: 14px;">üìä ÂΩìÂâçËÆæÁΩÆÁä∂ÊÄÅ</h5>
                    <div id="backupSettingsStatus" style="font-size: 12px; color: #0066cc;">
                        <div style="margin-bottom: 3px;">Ëá™Âä®Â§á‰ªΩÔºö<span id="statusAutoBackup">Â∑≤ÂêØÁî®</span></div>
                        <div style="margin-bottom: 3px;">Â§á‰ªΩÈó¥ÈöîÔºö<span id="statusInterval">5ÂàÜÈíü</span></div>
                        <div style="margin-bottom: 3px;">Â§á‰ªΩÊ®°ÂºèÔºö<span id="statusMode">Ëá™Âä®‰∏ãËΩΩ</span></div>
                        <div>‰∏äÊ¨°Â§á‰ªΩÔºö<span id="statusLastBackup">Êú™Â§á‰ªΩ</span></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="system-tab-content" id="systemBasicContent" style="display: none;">
            <!-- Âü∫Êú¨ËÆæÁΩÆÂÜÖÂÆπ -->
            <div style="height: 400px; overflow-y: auto; padding-right: 10px;">
                <h4 style="margin: 0 0 15px 0; color: #50b767;">‚öôÔ∏è Âü∫Êú¨ËÆæÁΩÆ</h4>
                
                <!-- Â≠ó‰ΩìÂ§ßÂ∞èËÆæÁΩÆ -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">üî§ Â≠ó‰ΩìÂ§ßÂ∞èËÆæÁΩÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">Ë∞ÉÊï¥Á≥ªÁªüÁïåÈù¢ÁöÑÂ≠ó‰ΩìÂ§ßÂ∞è</p>
                    
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <label style="font-size: 13px; color: #333;">Â≠ó‰ΩìÂ§ßÂ∞èÔºö</label>
                        <select id="fontSizeSelect" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            <option value="12">12px (Â∞è)</option>
                            <option value="14" selected>14px (ÈªòËÆ§)</option>
                            <option value="16">16px (‰∏≠)</option>
                            <option value="18">18px (Â§ß)</option>
                            <option value="20">20px (ÁâπÂ§ß)</option>
                        </select>
                    </div>
                    
                    <div style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.5); border-radius: 4px;">
                        <div style="font-size: 11px; color: #666;">È¢ÑËßàÊïàÊûúÔºö</div>
                        <div id="fontPreview" style="margin-top: 5px; padding: 5px; border: 1px solid #ddd; border-radius: 3px; background: white;">ËøôÊòØÂ≠ó‰ΩìÈ¢ÑËßàÊñáÊú¨</div>
                    </div>
                </div>
                
                <!-- Âü∫Á°ÄÁßØÂàÜËÆæÁΩÆ -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">‚≠ê Âü∫Á°ÄÁßØÂàÜËÆæÁΩÆ</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">ËÆæÁΩÆÊØè‰∏™Â≠ê‰ªªÂä°ÁöÑÈªòËÆ§Âü∫Á°ÄÁßØÂàÜ</p>
                    
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <label style="font-size: 13px; color: #333;">Âü∫Á°ÄÁßØÂàÜÔºö</label>
                        <input type="number" id="basePointsInput" min="1" max="100" value="5" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px; width: 80px;">
                        <span style="font-size: 13px; color: #333;">ÂàÜ</span>
                    </div>
                    
                    <div style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.5); border-radius: 4px;">
                        <div style="font-size: 11px; color: #666;">ËØ¥ÊòéÔºö</div>
                        <div style="font-size: 11px; color: #666; margin-top: 3px;">‚Ä¢ Êñ∞ÂàõÂª∫ÁöÑÂ≠ê‰ªªÂä°Â∞Ü‰ΩøÁî®Ê≠§ÁßØÂàÜ‰Ωú‰∏∫ÈªòËÆ§ÂÄº</div>
                        <div style="font-size: 11px; color: #666;">‚Ä¢ Â∑≤Â≠òÂú®ÁöÑÂ≠ê‰ªªÂä°ÁßØÂàÜ‰∏ç‰ºöËá™Âä®Êõ¥Êñ∞</div>
                        <div style="font-size: 11px; color: #666;">‚Ä¢ ÁßØÂàÜËåÉÂõ¥Ôºö1-100ÂàÜ</div>
                    </div>
                </div>
            </div>
        </div>
        <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
            <button id="confirmSystemSettingsBtn" style="padding: 5px 10px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">Á°ÆËÆ§</button>
        </div>
    </div>
    <div id="systemModalOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999;"></div>

    <!-- ÁôªÂΩïÊ®°ÊÄÅÊ°Ü -->
    <div id="loginModal" class="auth-modal" style="display: none;">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h3>Áî®Êà∑ÁôªÂΩï</h3>
                <button class="auth-modal-close" id="loginModalClose">&times;</button>
            </div>
            <div class="auth-modal-body">
                <form id="loginForm">
                    <div class="auth-form-group">
                        <label for="loginUsername">Áî®Êà∑Âêç</label>
                        <input type="text" id="loginUsername" name="username" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="loginPassword">ÂØÜÁ†Å</label>
                        <input type="password" id="loginPassword" name="password" required>
                    </div>
                    <div class="auth-form-group">
                        <label class="auth-checkbox-label">
                            <input type="checkbox" id="rememberMe"> ËÆ∞‰ΩèÊàë
                        </label>
                    </div>
                    <button type="submit" class="auth-submit-btn">ÁôªÂΩï</button>
                </form>
                <div class="auth-footer">
                    <p>ËøòÊ≤°ÊúâË¥¶Âè∑Ôºü <a href="#" id="showSignupModal">Á´ãÂç≥Ê≥®ÂÜå</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Ê≥®ÂÜåÊ®°ÊÄÅÊ°Ü -->
    <div id="signupModal" class="auth-modal" style="display: none;">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h3>Áî®Êà∑Ê≥®ÂÜå</h3>
                <button class="auth-modal-close" id="signupModalClose">&times;</button>
            </div>
            <div class="auth-modal-body">
                <form id="signupForm">
                    <div class="auth-form-group">
                        <label for="signupUsername">Áî®Êà∑Âêç</label>
                        <input type="text" id="signupUsername" name="username" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="signupPassword">ÂØÜÁ†Å</label>
                        <input type="password" id="signupPassword" name="password" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="confirmPassword">Á°ÆËÆ§ÂØÜÁ†Å</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="userRole">Áî®Êà∑ËßíËâ≤</label>
                        <select id="userRole" name="role" required>
                            <option value="">ËØ∑ÈÄâÊã©ËßíËâ≤</option>
                            <option value="parent">ÂÆ∂Èïø</option>
                            <option value="child">Â≠©Â≠ê</option>
                        </select>
                    </div>
                    <div class="auth-form-group" id="parentIdGroup" style="display: none;">
                        <label for="parentId">ÂÆ∂ÈïøIDÔºàÂ¶ÇÊûúÊòØÂ≠©Â≠êË¥¶Âè∑Ôºâ</label>
                        <input type="text" id="parentId" name="parentId" placeholder="ËØ∑ËæìÂÖ•ÂÆ∂ÈïøÁî®Êà∑ID">
                    </div>
                    <button type="submit" class="auth-submit-btn">Ê≥®ÂÜå</button>
                </form>
                <div class="auth-footer">
                    <p>Â∑≤ÊúâË¥¶Âè∑Ôºü <a href="#" id="showLoginModal">Á´ãÂç≥ÁôªÂΩï</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- ËÆ§ËØÅÊ®°ÊÄÅÊ°ÜÈÅÆÁΩ©Â±Ç -->
    <div id="authModalOverlay" class="auth-modal-overlay" style="display: none;"></div>

    <!-- ÈÄâÊã©È°πÁõÆÂíå‰ªªÂä°ÂºπÁ™ó -->
    <div id="selectTaskModal" class="goal-modal-overlay" style="display: none;">
        <div class="goal-modal">
            <div class="goal-modal-header">
                <h3>ÈÄâÊã©È°πÁõÆÂíå‰ªªÂä°</h3>
                <button class="goal-modal-close" id="selectTaskModalClose">&times;</button>
            </div>
            <div class="goal-modal-body">
                <div class="select-task-content">
                    <!-- Â∑¶‰æßÈÄâÊã©Âå∫Âüü -->
                    <div class="select-task-left">
                        <div class="select-task-search">
                            <input type="text" id="taskSearchInput" placeholder="ÊêúÁ¥¢È°πÁõÆÊàñ‰ªªÂä°..." class="task-search-input">
                        </div>
                        <div class="select-task-list" id="selectTaskList">
                            <!-- È°πÁõÆÂíå‰ªªÂä°ÂàóË°®Â∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                    <!-- Âè≥‰æßÈ¢ÑËßàÂå∫Âüü -->
                    <div class="select-task-right">
                        <h4>Â∑≤ÈÄâÊã©ÁöÑ‰ªªÂä°</h4>
                        <div class="selected-task-preview" id="selectedTaskPreview">
                            <div class="empty-preview">ËØ∑‰ªéÂ∑¶‰æßÈÄâÊã©‰ªªÂä°</div>
                        </div>
                    </div>
                    
                    <!-- È¢ÑÁΩÆÊ†áÁ≠æÈÄâÊã©ÂÆπÂô® -->
                    <div class="form-group">
                        <label>ÈÄâÊã©Ê†áÁ≠æ</label>
                        <div class="preset-tags-container" id="presetTagsContainer">
                            <span class="preset-tag" data-tag="ËØ≠Êñá">ËØ≠Êñá</span>
                            <span class="preset-tag" data-tag="Êï∞Â≠¶">Êï∞Â≠¶</span>
                            <span class="preset-tag" data-tag="Ëã±ËØ≠">Ëã±ËØ≠</span>
                            <span class="preset-tag" data-tag="ÁßëÂ≠¶">ÁßëÂ≠¶</span>
                            <span class="preset-tag" data-tag="ÂéÜÂè≤">ÂéÜÂè≤</span>
                            <span class="preset-tag" data-tag="Âú∞ÁêÜ">Âú∞ÁêÜ</span>
                            <span class="preset-tag" data-tag="Áâ©ÁêÜ">Áâ©ÁêÜ</span>
                            <span class="preset-tag" data-tag="ÂåñÂ≠¶">ÂåñÂ≠¶</span>
                            <span class="preset-tag" data-tag="ÁîüÁâ©">ÁîüÁâ©</span>
                            <span class="preset-tag" data-tag="ÁºñÁ®ã">ÁºñÁ®ã</span>
                            <span class="preset-tag" data-tag="Ëâ∫ÊúØ">Ëâ∫ÊúØ</span>
                            <span class="preset-tag" data-tag="‰ΩìËÇ≤">‰ΩìËÇ≤</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="goal-modal-footer">
                <button type="button" class="goal-modal-btn cancel-btn" id="selectTaskCancel">ÂèñÊ∂à</button>
                <button type="button" class="goal-modal-btn confirm-btn" id="selectTaskConfirm">Á°ÆËÆ§ÂÖ≥ËÅî</button>
            </div>
        </div>
    </div>

    <!-- ÁºñËæëÈáåÁ®ãÁ¢ëÂºπÁ™ó -->
    <div id="editMilestoneModal" class="goal-modal-overlay" style="display: none;">
        <div class="goal-modal">
            <div class="goal-modal-header">
                <h3>ÁºñËæëÈáåÁ®ãÁ¢ë</h3>
                <button class="goal-modal-close" id="editMilestoneModalClose">&times;</button>
            </div>
            <div class="goal-modal-body">
                <div class="edit-milestone-form">
                    <div class="form-group">
                        <label for="editMilestoneTitle">ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò</label>
                        <input type="text" id="editMilestoneTitle" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò">
                    </div>
                    
                    <div id="dynamicDimensionSelectors">
                        <!-- Áª¥Â∫¶ÈÄâÊã©Âô®Â∞ÜÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
            <div class="goal-modal-footer">
                <button type="button" class="goal-modal-btn cancel-btn" id="editMilestoneCancel">ÂèñÊ∂à</button>
                <button type="button" class="goal-modal-btn confirm-btn" id="editMilestoneSave">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Êñ∞Â¢ûÈáåÁ®ãÁ¢ëÂºπÁ™ó -->
    <div id="addMilestoneModal" class="goal-modal-overlay" style="display: none;">
        <div class="goal-modal">
            <div class="goal-modal-header">
                <h3>Êñ∞Â¢ûÈáåÁ®ãÁ¢ë</h3>
                <button class="goal-modal-close" id="addMilestoneModalClose">&times;</button>
            </div>
            <div class="goal-modal-body">
                <div class="add-milestone-form">
                    <div class="form-group">
                        <label for="addMilestoneTitle">ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò</label>
                        <input type="text" id="addMilestoneTitle" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò">
                    </div>
                    
                    <div id="addDynamicDimensionSelectors">
                        <!-- Áª¥Â∫¶ÈÄâÊã©Âô®Â∞ÜÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
            <div class="goal-modal-footer">
                <button type="button" class="goal-modal-btn cancel-btn" id="addMilestoneCancel">ÂèñÊ∂à</button>
                <button type="button" class="goal-modal-btn confirm-btn" id="addMilestoneSave">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Ê∑ªÂä†ÁõÆÊ†áÂºπÁ™ó -->
    <div id="addGoalModal" class="goal-modal-overlay" style="display: none;">
        <div class="goal-modal">
            <div class="goal-modal-header">
                <h3>Ê∑ªÂä†ÁõÆÊ†á</h3>
                <button class="goal-modal-close" id="addGoalModalClose">&times;</button>
            </div>
            <div class="goal-modal-body">
                <div class="add-goal-form">
                    <div class="form-group">
                        <label for="addGoalTitle">ÁõÆÊ†áÂêçÁß∞ <span class="required">*</span></label>
                        <input type="text" id="addGoalTitle" class="form-input" placeholder="ËØ∑ËæìÂÖ•ÁõÆÊ†áÂêçÁß∞" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="addGoalDescription">ÁõÆÊ†áÊèèËø∞</label>
                        <textarea id="addGoalDescription" class="form-textarea" placeholder="ËØ∑ËæìÂÖ•ÁõÆÊ†áÊèèËø∞" rows="3"></textarea>
                    </div>
                    

                    
                    <!-- Ëµ∑ÂßãÊó•ÊúüÂíåÊà™Ê≠¢Êó•ÊúüÂπ∂ÊéíÊòæÁ§∫ -->
                    <div class="form-row">
                        <div class="form-group form-group-half">
                            <label for="addGoalStartDate">Ëµ∑ÂßãÊó•Êúü</label>
                            <input type="date" id="addGoalStartDate" class="form-input">
                        </div>
                        
                        <div class="form-group form-group-half">
                            <label for="addGoalDeadline">Êà™Ê≠¢Êó•Êúü</label>
                            <input type="date" id="addGoalDeadline" class="form-input">
                        </div>
                    </div>
                    
                    <!-- Ê†áÁ≠æÈÄâÊã© -->
                    <div class="form-group">
                        <label for="addGoalTags">Ê†áÁ≠æ</label>
                        <input type="text" id="addGoalTags" class="form-input" placeholder="ÈÄâÊã©Ê†áÁ≠æ..." readonly>
                    </div>
                    
                    <!-- È¢ÑÁΩÆÊ†áÁ≠æÈÄâÊã©ÂÆπÂô® -->
                    <div class="form-group">
                        <label>ÈÄâÊã©Ê†áÁ≠æ</label>
                        <div class="preset-tags-container" id="presetTagsContainer">
                            <span class="preset-tag" data-tag="ËØ≠Êñá">ËØ≠Êñá</span>
                            <span class="preset-tag" data-tag="Êï∞Â≠¶">Êï∞Â≠¶</span>
                            <span class="preset-tag" data-tag="Ëã±ËØ≠">Ëã±ËØ≠</span>
                            <span class="preset-tag" data-tag="ÁßëÂ≠¶">ÁßëÂ≠¶</span>
                            <span class="preset-tag" data-tag="ÂéÜÂè≤">ÂéÜÂè≤</span>
                            <span class="preset-tag" data-tag="Âú∞ÁêÜ">Âú∞ÁêÜ</span>
                            <span class="preset-tag" data-tag="Áâ©ÁêÜ">Áâ©ÁêÜ</span>
                            <span class="preset-tag" data-tag="ÂåñÂ≠¶">ÂåñÂ≠¶</span>
                            <span class="preset-tag" data-tag="ÁîüÁâ©">ÁîüÁâ©</span>
                            <span class="preset-tag" data-tag="ÁºñÁ®ã">ÁºñÁ®ã</span>
                            <span class="preset-tag" data-tag="Ëâ∫ÊúØ">Ëâ∫ÊúØ</span>
                            <span class="preset-tag" data-tag="‰ΩìËÇ≤">‰ΩìËÇ≤</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="goal-modal-footer">
                <button type="button" class="goal-modal-btn cancel-btn" id="addGoalCancel">ÂèñÊ∂à</button>
                <button type="button" class="goal-modal-btn confirm-btn" id="addGoalSave">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <script src="gms.js"></script>
<script src="process.js"></script>
<script src="auth.js"></script>
<script src="create_test_data.js"></script>
<script src="create_test_projects.js"></script>
<script src="goal_task_links.js"></script>
<script src="link-task-modal.js"></script>
    
    <script>
        // Âä®ÊÄÅÂä†ËΩΩÁª¥Â∫¶Êï∞ÊçÆ
        function loadDimensionsData() {
            // Á°Æ‰øùprocessManagerÂ∑≤ÂàùÂßãÂåñ
            if (typeof processManager === 'undefined') {
                setTimeout(loadDimensionsData, 100);
                return;
            }
            
            const dimensionsContainer = document.getElementById('dimensions-content');
            if (!dimensionsContainer) return;
            
            // Ëé∑ÂèñÁª¥Â∫¶ÂíåÁª¥Â∫¶ÂÄºÊï∞ÊçÆ
            const dimensions = processManager.getDimensions();
            const allDimensionValues = processManager.getDimensionValues();
            
            // Ê∏ÖÁ©∫ÂÆπÂô®
            dimensionsContainer.innerHTML = '';
            

            
            // ‰∏∫ÊØè‰∏™Áª¥Â∫¶ÂàõÂª∫ÁªÑ
            dimensions.forEach(dimension => {
                // Ëé∑ÂèñËØ•Áª¥Â∫¶ÁöÑÊâÄÊúâÂÄº
                const dimensionValues = allDimensionValues.filter(v => v.dimension_id === dimension.dimension_id);
                
                if (dimensionValues.length === 0) return;
                
                // ÂàõÂª∫Áª¥Â∫¶ÁªÑÂÆπÂô®
                const dimensionGroup = document.createElement('div');
                dimensionGroup.className = 'dimension-group';
                
                // ÂàõÂª∫Áª¥Â∫¶Ê†áÈ¢ò
                const dimensionTitle = document.createElement('div');
                dimensionTitle.className = 'dimension-title';
                dimensionTitle.textContent = dimension.name;
                
                // ÂàõÂª∫Áª¥Â∫¶ÂÄºÂÆπÂô®
                const dimensionValuesContainer = document.createElement('div');
                dimensionValuesContainer.className = 'dimension-values';
                
                // ÊåâorderÊéíÂ∫èÁª¥Â∫¶ÂÄº
                dimensionValues.sort((a, b) => (a.order || 0) - (b.order || 0));
                
                // ‰∏∫ÊØè‰∏™Áª¥Â∫¶ÂÄºÂàõÂª∫Ê†áÁ≠æ
                dimensionValues.forEach(value => {
                    const tag = document.createElement('span');
                    tag.className = 'dimension-tag';
                    tag.setAttribute('data-dimension', dimension.name.toLowerCase());
                    tag.setAttribute('data-value', value.value);
                    tag.setAttribute('data-dimension-id', dimension.dimension_id);
                    tag.setAttribute('data-value-id', value.value_id);
                    tag.textContent = value.value;
                    
                    // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                    tag.addEventListener('click', function() {
                        // ÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅ
                        this.classList.toggle('selected');
                        
                        // Á≠õÈÄâÈáåÁ®ãÁ¢ë
                        filterMilestonesByDimensions();
                        
                        console.log('ÈÄâÊã©Áª¥Â∫¶ÂÄº:', {
                            dimension: dimension.name,
                            value: value.value,
                            selected: this.classList.contains('selected')
                        });
                    });
                    
                    dimensionValuesContainer.appendChild(tag);
                });
                
                // ÁªÑË£ÖÁª¥Â∫¶ÁªÑ
                dimensionGroup.appendChild(dimensionTitle);
                dimensionGroup.appendChild(dimensionValuesContainer);
                dimensionsContainer.appendChild(dimensionGroup);
            });
        }
        
        // Á≠õÈÄâÈáåÁ®ãÁ¢ëÂáΩÊï∞
        function filterMilestonesByDimensions() {
            const selectedTags = document.querySelectorAll('.dimension-tag.selected');
            const milestoneItems = document.querySelectorAll('.milestone-item');
            
            if (selectedTags.length === 0) {
                // Ê≤°ÊúâÈÄâ‰∏≠‰ªª‰ΩïÁª¥Â∫¶ÂÄºÔºåÊòæÁ§∫ÊâÄÊúâÈáåÁ®ãÁ¢ë
                milestoneItems.forEach(item => {
                    item.style.visibility = 'visible';
                    item.style.position = 'static';
                    item.style.height = 'auto';
                });
                return;
            }
            
            // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑÁª¥Â∫¶ÂÄº‰ø°ÊÅØ
            const selectedDimensions = {};
            selectedTags.forEach(tag => {
                const dimensionId = tag.getAttribute('data-dimension-id');
                const valueId = tag.getAttribute('data-value-id');
                
                if (!selectedDimensions[dimensionId]) {
                    selectedDimensions[dimensionId] = [];
                }
                selectedDimensions[dimensionId].push(valueId);
            });
            
            // Á≠õÈÄâÈáåÁ®ãÁ¢ë
            milestoneItems.forEach(item => {
                const milestoneId = item.getAttribute('data-milestone-id');
                let shouldShow = true;
                
                // Ê£ÄÊü•ÊØè‰∏™ÈÄâ‰∏≠ÁöÑÁª¥Â∫¶
                Object.keys(selectedDimensions).forEach(dimensionId => {
                    const requiredValues = selectedDimensions[dimensionId];
                    const milestoneHasValue = requiredValues.some(valueId => {
                        // Ê£ÄÊü•ÈáåÁ®ãÁ¢ëÊòØÂê¶ÊúâËøô‰∏™Áª¥Â∫¶ÂÄº
                        return item.querySelector(`[data-value-id="${valueId}"]`) !== null;
                    });
                    
                    if (!milestoneHasValue) {
                        shouldShow = false;
                    }
                });
                
                if (shouldShow) {
                    item.style.visibility = 'visible';
                    item.style.position = 'static';
                    item.style.height = 'auto';
                } else {
                    item.style.visibility = 'hidden';
                    item.style.position = 'absolute';
                    item.style.height = '0';
                }
            });
        }
        

        
        // Ê∑ªÂä†ÂºπÁ™óÊ†∑ÂºèÂáΩÊï∞
        function addGoalModalStyles() {
            // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊ∑ªÂä†ËøáÊ†∑Âºè
            if (document.getElementById('goal-modal-styles')) {
                return;
            }
            
            const style = document.createElement('style');
            style.id = 'goal-modal-styles';
            style.textContent = `
                .goal-modal-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                }
                
                .goal-modal {
                    background: white;
                    border-radius: 12px;
                    width: 85%;
                    max-width: 600px;
                    max-height: 80vh;
                    overflow: hidden;
                    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                }
                
                .goal-modal-header {
                    padding: 20px;
                    border-bottom: 1px solid #eee;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    background: #f8f9fa;
                }
                
                .goal-modal-header h3 {
                    margin: 0;
                    color: #333;
                }
                
                .goal-modal-close {
                    background: none;
                    border: none;
                    font-size: 24px;
                    cursor: pointer;
                    color: #666;
                }
                
                .goal-modal-close:hover {
                    color: #333;
                }
                
                .goal-modal-body {
                    padding: 20px;
                    max-height: 400px;
                    overflow-y: auto;
                }
                
                .goal-modal .form-group {
                    margin-bottom: 15px;
                }
                
                .goal-modal .form-group label {
                    display: block;
                    margin-bottom: 5px;
                    font-weight: bold;
                    color: #333;
                }
                
                .goal-modal .form-group input,
                .goal-modal .form-group textarea,
                .goal-modal .form-group select {
                    width: 100%;
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-size: 14px;
                    box-sizing: border-box;
                }
                
                .goal-modal-footer {
                    padding: 15px 20px;
                    border-top: 1px solid #eee;
                    display: flex;
                    justify-content: flex-end;
                    gap: 10px;
                    background: #f8f9fa;
                }
                
                .goal-modal-btn {
                    padding: 8px 16px;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 14px;
                    transition: all 0.2s ease;
                }
                
                .goal-modal .save-btn {
                    background: #50b767;
                    color: white;
                }
                
                .goal-modal .save-btn:hover {
                    background: #45a049;
                }
                
                .goal-modal .cancel-btn {
                    background: #f0f0f0;
                    color: #333;
                    border: 1px solid #ddd;
                }
                
                .goal-modal .cancel-btn:hover {
                    background: #e0e0e0;
                }
                
                /* Ê∑ªÂä†ÁõÆÊ†áÂºπÁ™óÁâπÊúâÊ†∑Âºè */
                .goal-modal .form-textarea {
                    width: 100%;
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-size: 14px;
                    box-sizing: border-box;
                    resize: vertical;
                    min-height: 80px;
                    font-family: inherit;
                }
                
                .goal-modal .required {
                    color: #e74c3c;
                    font-weight: bold;
                }
                
                .goal-modal .confirm-btn {
                    background: #50b767;
                    color: white;
                }
                
                .goal-modal .confirm-btn:hover {
                    background: #45a049;
                }
                
                /* Âπ∂ÊéíÂ∏ÉÂ±ÄÊ†∑Âºè */
                .goal-modal .form-row {
                    display: flex;
                    gap: 15px;
                    margin-bottom: 15px;
                }
                
                .goal-modal .form-group-half {
                    flex: 1;
                    margin-bottom: 0;
                }
                
                /* ÈöêËóè‰∏ãÊãâÊ°ÜÊªöÂä®Êù° */
                .goal-modal .form-select {
                    scrollbar-width: none; /* Firefox */
                    -ms-overflow-style: none; /* IE and Edge */
                }
                
                .goal-modal .form-select::-webkit-scrollbar {
                    display: none; /* Chrome, Safari, Opera */
                }
                
                /* È¢ÑÁΩÆÊ†áÁ≠æÊ†∑Âºè */
                .preset-tags-container {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 8px;
                    margin-top: 8px;
                }
                
                .preset-tag {
                    display: inline-block;
                    padding: 6px 12px;
                    background: #f8f9fa;
                    border: 1px solid #dee2e6;
                    border-radius: 20px;
                    font-size: 12px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    user-select: none;
                }
                
                .preset-tag:hover {
                    background: #e9ecef;
                    border-color: #adb5bd;
                }
                
                .preset-tag.selected {
                    background: #007bff;
                    color: white;
                    border-color: #007bff;
                }
                
                .preset-tag.selected:hover {
                    background: #0056b3;
                    border-color: #0056b3;
                }
                
                /* ÂìçÂ∫îÂºèËÆæËÆ° */
                @media (max-width: 600px) {
                    .goal-modal .form-row {
                        flex-direction: column;
                        gap: 0;
                    }
                    
                    .goal-modal .form-group-half {
                        margin-bottom: 15px;
                    }
                    
                    .preset-tags-container {
                        gap: 6px;
                    }
                    
                    .preset-tag {
                        padding: 4px 8px;
                        font-size: 11px;
                    }
                }
            `;
            
            document.head.appendChild(style);
        }
        
        // ÁºñËæëÈáåÁ®ãÁ¢ëÂäüËÉΩ
        let currentEditingMilestone = null;
        
        // ÊòæÁ§∫ÁºñËæëÈáåÁ®ãÁ¢ëÂºπÁ™ó
        function showEditMilestoneModal(milestoneId) {
            // Á°Æ‰øùÂºπÁ™óÊ†∑ÂºèÂ∑≤Âä†ËΩΩ
            addGoalModalStyles();
            
            currentEditingMilestone = milestoneId;
            const modal = document.getElementById('editMilestoneModal');
            
            // Ëé∑ÂèñÈáåÁ®ãÁ¢ëÊï∞ÊçÆ
            const milestone = milestoneDataLoader.processManager.getMilestones().find(m => m.milestone_id === milestoneId);
            if (!milestone) {
                console.error('Êâæ‰∏çÂà∞ÈáåÁ®ãÁ¢ëÊï∞ÊçÆ:', milestoneId);
                return;
            }
            
            // Â°´ÂÖÖÊ†áÈ¢ò
            document.getElementById('editMilestoneTitle').value = milestone.title;
            
            // Âä†ËΩΩÁª¥Â∫¶ÈÄâÊã©Âô®
            loadDimensionSelectors();
            
            // Â°´ÂÖÖÂΩìÂâçÈÄâ‰∏≠ÁöÑÁª¥Â∫¶ÂÄº
            fillCurrentDimensionValues(milestoneId);
            
            // ÊòæÁ§∫ÂºπÁ™ó
            modal.style.display = 'flex';
        }
        
        // Âä†ËΩΩÁª¥Â∫¶ÈÄâÊã©Âô®
        function loadDimensionSelectors() {
            const dimensions = milestoneDataLoader.processManager.getDimensions();
            const dimensionValues = milestoneDataLoader.processManager.getDimensionValues();
            const container = document.getElementById('dynamicDimensionSelectors');
            
            if (!container) {
                console.error('Êâæ‰∏çÂà∞Âä®ÊÄÅÁª¥Â∫¶ÈÄâÊã©Âô®ÂÆπÂô®');
                return;
            }
            
            // Ê∏ÖÁ©∫ÂÆπÂô®
            container.innerHTML = '';
            
            // ‰∏∫ÊØè‰∏™Áª¥Â∫¶Âä®ÊÄÅÂàõÂª∫ÈÄâÊã©Âô®
            dimensions.forEach(dimension => {
                // ÂàõÂª∫Áª¥Â∫¶ÁªÑÂÆπÂô®
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group';
                
                // ÂàõÂª∫Ê†áÁ≠æ
                const label = document.createElement('label');
                label.textContent = dimension.name;
                
                // ÂàõÂª∫ÈÄâÊã©Âô®ÂÆπÂô®
                const selector = document.createElement('div');
                selector.className = 'dimension-selector';
                selector.id = `editDimensionSelector_${dimension.dimension_id}`;
                
                // Ëé∑ÂèñËØ•Áª¥Â∫¶ÁöÑÊâÄÊúâÂÄº
                const values = dimensionValues.filter(v => v.dimension_id === dimension.dimension_id);
                values.sort((a, b) => (a.order || 0) - (b.order || 0));
                
                // ‰∏∫ÊØè‰∏™Áª¥Â∫¶ÂÄºÂàõÂª∫ÈÄâÈ°π
                values.forEach(value => {
                    const option = document.createElement('div');
                    option.className = 'dimension-option';
                    option.setAttribute('data-value-id', value.value_id);
                    option.setAttribute('data-dimension-id', dimension.dimension_id);
                    option.textContent = value.value;
                    
                    // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                    option.addEventListener('click', function() {
                        // ÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅ
                        if (this.classList.contains('selected')) {
                            // Â¶ÇÊûúÂ∑≤ÈÄâ‰∏≠ÔºåÂàôÂèñÊ∂àÈÄâ‰∏≠
                            this.classList.remove('selected');
                        } else {
                            // Â¶ÇÊûúÊú™ÈÄâ‰∏≠ÔºåÂàôÈÄâ‰∏≠
                            this.classList.add('selected');
                        }
                    });
                    
                    selector.appendChild(option);
                });
                
                // ÁªÑË£ÖÁª¥Â∫¶ÁªÑ
                formGroup.appendChild(label);
                formGroup.appendChild(selector);
                container.appendChild(formGroup);
            });
        }
        
        // Â°´ÂÖÖÂΩìÂâçÈáåÁ®ãÁ¢ëÁöÑÁª¥Â∫¶ÂÄº
        function fillCurrentDimensionValues(milestoneId) {
            const relations = milestoneDataLoader.processManager.getMilestoneDimensionRelations();
            const milestoneRelations = relations.filter(r => r.milestone_id === milestoneId);
            
            console.log('Â°´ÂÖÖÁª¥Â∫¶ÂÄº - ÈáåÁ®ãÁ¢ëID:', milestoneId);
            console.log('ÊâæÂà∞ÁöÑÂÖ≥ËÅîÂÖ≥Á≥ª:', milestoneRelations);
            
            milestoneRelations.forEach(relation => {
                // Áõ¥Êé•ÈÄöËøádata-value-idÊü•ÊâæÂØπÂ∫îÁöÑÁª¥Â∫¶ÈÄâÈ°π
                const option = document.querySelector(`#editMilestoneModal [data-value-id="${relation.dimension_value_id}"]`);
                console.log('Êü•ÊâæÁª¥Â∫¶ÈÄâÈ°π:', relation.dimension_value_id, 'ÊâæÂà∞ÂÖÉÁ¥†:', option);
                
                if (option) {
                    // ÈÄâ‰∏≠ÂΩìÂâçÈÄâÈ°π
                    option.classList.add('selected');
                    console.log('Â∑≤ËÆæÁΩÆÈÄâ‰∏≠Áä∂ÊÄÅ:', option.textContent);
                }
            });
        }
        
        // Âà†Èô§ÈáåÁ®ãÁ¢ë
        function deleteMilestone(milestoneId) {
            if (!milestoneId) {
                console.error('ÈáåÁ®ãÁ¢ëID‰∏çËÉΩ‰∏∫Á©∫');
                return;
            }
            
            // Ëé∑ÂèñÈáåÁ®ãÁ¢ë‰ø°ÊÅØÁî®‰∫éÁ°ÆËÆ§ÊèêÁ§∫
            const milestone = milestoneDataLoader.processManager.getMilestones().find(m => m.milestone_id === milestoneId);
            const milestoneTitle = milestone ? milestone.title : 'Êú™Áü•ÈáåÁ®ãÁ¢ë';
            
            // ÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü
            if (!confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§ÈáåÁ®ãÁ¢ë„Äå${milestoneTitle}„ÄçÂêóÔºü\n\nÂà†Èô§ÂêéÂ∞ÜÊó†Ê≥ïÊÅ¢Â§çÔºåÁõ∏ÂÖ≥ÁöÑÁª¥Â∫¶ÂÖ≥ËÅî‰πü‰ºöË¢´Ê∏ÖÈô§„ÄÇ`)) {
                return;
            }
            
            try {
                // Âà†Èô§ÈáåÁ®ãÁ¢ëÊï∞ÊçÆ
                const success = milestoneDataLoader.processManager.deleteMilestone(milestoneId);
                
                if (success) {
                    // Âà†Èô§Áõ∏ÂÖ≥ÁöÑÁª¥Â∫¶ÂÖ≥ËÅî
                    let relations = milestoneDataLoader.processManager.getMilestoneDimensionRelations();
                    relations = relations.filter(r => r.milestone_id !== milestoneId);
                    localStorage.setItem('gms_milestone_dimension_relations', JSON.stringify(relations));
                    
                    // ‰ªéÈ°µÈù¢‰∏≠ÁßªÈô§ËØ•ÈáåÁ®ãÁ¢ëÂÖÉÁ¥†
                    const milestoneElement = document.querySelector(`[data-milestone-id="${milestoneId}"]`);
                    if (milestoneElement) {
                        milestoneElement.remove();
                    }
                    
                    // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                    alert('ÈáåÁ®ãÁ¢ëÂà†Èô§ÊàêÂäüÔºÅ');
                    
                    // ÈáçÊñ∞Âä†ËΩΩÈáåÁ®ãÁ¢ëÂàóË°®‰ª•Á°Æ‰øùÊï∞ÊçÆÂêåÊ≠•
                    milestoneDataLoader.loadMilestonesToContainer();
                } else {
                    throw new Error('Âà†Èô§ÈáåÁ®ãÁ¢ëÂ§±Ë¥•');
                }
            } catch (error) {
                console.error('Âà†Èô§ÈáåÁ®ãÁ¢ëÊó∂ÂèëÁîüÈîôËØØ:', error);
                alert('Âà†Èô§ÈáåÁ®ãÁ¢ëÂ§±Ë¥•ÔºåËØ∑ÈáçËØï„ÄÇ');
            }
        }
        
        // ‰øùÂ≠òÁºñËæëÁöÑÈáåÁ®ãÁ¢ë
        function saveEditedMilestone() {
            if (!currentEditingMilestone) return;
            
            const title = document.getElementById('editMilestoneTitle').value.trim();
            if (!title) {
                alert('ËØ∑ËæìÂÖ•ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò');
                return;
            }
            
            // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑÁª¥Â∫¶ÂÄº
            const selectedOptions = document.querySelectorAll('#editMilestoneModal .dimension-option.selected');
            if (selectedOptions.length === 0) {
                alert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰∏™Áª¥Â∫¶ÂÄº');
                return;
            }
            
            // Êõ¥Êñ∞ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò
            const milestones = milestoneDataLoader.processManager.getMilestones();
            const milestone = milestones.find(m => m.milestone_id === currentEditingMilestone);
            if (milestone) {
                milestone.title = title;
                localStorage.setItem('gms_milestones', JSON.stringify(milestones));
            }
            
            // Êõ¥Êñ∞Áª¥Â∫¶ÂÖ≥ËÅî
            let relations = milestoneDataLoader.processManager.getMilestoneDimensionRelations();
            
            // Âà†Èô§ÂéüÊúâÂÖ≥ËÅî
            relations = relations.filter(r => r.milestone_id !== currentEditingMilestone);
            
            // Ê∑ªÂä†Êñ∞ÂÖ≥ËÅî
            selectedOptions.forEach((option, index) => {
                const relationId = `mr_${currentEditingMilestone}_${option.getAttribute('data-dimension-id')}_${Date.now()}_${index}`;
                relations.push({
                    relation_id: relationId,
                    milestone_id: currentEditingMilestone,
                    dimension_id: parseInt(option.getAttribute('data-dimension-id')),
                    dimension_value_id: parseInt(option.getAttribute('data-value-id')),
                    weight: 1.0
                });
            });
            
            // ‰øùÂ≠òÂÖ≥ËÅîÊï∞ÊçÆ
            localStorage.setItem('gms_milestone_dimension_relations', JSON.stringify(relations));
            
            // ÂÖ≥Èó≠ÂºπÁ™ó
            document.getElementById('editMilestoneModal').style.display = 'none';
            
            // Âà∑Êñ∞ÈáåÁ®ãÁ¢ëÂàóË°®
            milestoneDataLoader.loadMilestonesToContainer();
            
            alert('ÈáåÁ®ãÁ¢ëÊõ¥Êñ∞ÊàêÂäüÔºÅ');
        }
        
        // ÊòæÁ§∫Êñ∞Â¢ûÈáåÁ®ãÁ¢ëÂºπÁ™ó
        function showAddMilestoneModal() {
            // Á°Æ‰øùÂºπÁ™óÊ†∑ÂºèÂ∑≤Âä†ËΩΩ
            addGoalModalStyles();
            
            const modal = document.getElementById('addMilestoneModal');
            
            // Ê∏ÖÁ©∫Ë°®Âçï
            document.getElementById('addMilestoneTitle').value = '';
            
            // Âä†ËΩΩÁª¥Â∫¶ÈÄâÊã©Âô®
            loadAddDimensionSelectors();
            
            // ÊòæÁ§∫ÂºπÁ™ó
            modal.style.display = 'flex';
        }
        
        // ÊòæÁ§∫Ê∑ªÂä†ÁõÆÊ†áÂºπÁ™ó
        function showAddGoalModal() {
            console.log('ÊòæÁ§∫Ê∑ªÂä†ÁõÆÊ†áÂºπÁ™ó');
            
            // Á°Æ‰øùÂºπÁ™óÊ†∑ÂºèÂ∑≤Âä†ËΩΩ
            addGoalModalStyles();
            
            // ‰øùÂ≠òÂéüÂßãÂáΩÊï∞Âà∞windowÂØπË±°Ôºå‰æõgms.jsË∞ÉÁî®
            if (!window.originalShowAddGoalModal) {
                window.originalShowAddGoalModal = showAddGoalModal;
            }
            
            const modal = document.getElementById('addGoalModal');
            console.log('ÊâæÂà∞ÂºπÁ™óÂÖÉÁ¥†:', modal);
            
            // Ê∏ÖÁ©∫Ë°®Âçï - ‰ΩøÁî®Ê≠£Á°ÆÁöÑID
            const goalTitle = document.getElementById('addGoalTitle');
            const goalDescription = document.getElementById('addGoalDescription');
            const goalStartDate = document.getElementById('addGoalStartDate');
            const goalDeadline = document.getElementById('addGoalDeadline');
            const goalTags = document.getElementById('addGoalTags');
            
            console.log('Ë°®ÂçïÂÖÉÁ¥†Ê£ÄÊü•:', {
                goalTitle: !!goalTitle,
                goalDescription: !!goalDescription,
                goalStartDate: !!goalStartDate,
                goalDeadline: !!goalDeadline,
                goalTags: !!goalTags
            });
            
            // Ê∑ªÂä†nullÊ£ÄÊü•Èò≤Êä§
            if (goalTitle) goalTitle.value = '';
            if (goalDescription) goalDescription.value = '';
            if (goalDeadline) goalDeadline.value = '';
            if (goalTags) goalTags.value = '';
            
            // ËÆæÁΩÆËµ∑ÂßãÊó•ÊúüÈªòËÆ§ÂÄº‰∏∫‰ªäÂ§©
            if (goalStartDate) {
                const today = new Date();
                const todayString = today.getFullYear() + '-' + 
                    String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                    String(today.getDate()).padStart(2, '0');
                goalStartDate.value = todayString;
            }
            
            // Ê∏ÖÁ©∫ÊâÄÊúâÈ¢ÑÁΩÆÊ†áÁ≠æÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
            const presetTags = document.querySelectorAll('.preset-tag');
            console.log('ÊâæÂà∞È¢ÑÁΩÆÊ†áÁ≠æÊï∞Èáè:', presetTags.length);
            presetTags.forEach(tag => {
                tag.classList.remove('selected');
            });
            
            // ÊòæÁ§∫ÂºπÁ™ó
            if (modal) {
                modal.style.display = 'flex';
                console.log('ÂºπÁ™óÂ∑≤ÊòæÁ§∫');
                
                // Âª∂ËøüÂàùÂßãÂåñÊ†áÁ≠æÈÄâÊã©‰∫ã‰ª∂ÔºåÁ°Æ‰øùDOMÂ∑≤Ê∏≤Êüì
                setTimeout(() => {
                    console.log('ÂºÄÂßãÂàùÂßãÂåñÊ†áÁ≠æÈÄâÊã©‰∫ã‰ª∂');
                    initTagSelection();
                }, 100);
            }
        }
        
        // Ê†áÁ≠æÁÇπÂáªÂ§ÑÁêÜÂáΩÊï∞
        function handleTagClick(event) {
            const tag = event.target;
            const tagText = tag.getAttribute('data-tag');
            
            console.log('Ê†áÁ≠æË¢´ÁÇπÂáª:', tagText);
            
            // ÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅ
            tag.classList.toggle('selected');
            
            console.log('Ê†áÁ≠æÈÄâ‰∏≠Áä∂ÊÄÅ:', tag.classList.contains('selected'));
            
            // Êõ¥Êñ∞ËæìÂÖ•Ê°ÜÊòæÁ§∫
            updateTagsInput();
        }
        
        // Êõ¥Êñ∞Ê†áÁ≠æËæìÂÖ•Ê°Ü
        function updateTagsInput() {
            const selectedTags = document.querySelectorAll('.preset-tag.selected');
            const selectedTagTexts = Array.from(selectedTags).map(tag => tag.getAttribute('data-tag'));
            const tagsInput = document.getElementById('addGoalTags');
            
            console.log('ÈÄâ‰∏≠ÁöÑÊ†áÁ≠æ:', selectedTagTexts);
            
            if (tagsInput) {
                tagsInput.value = selectedTagTexts.join(', ');
                console.log('ËæìÂÖ•Ê°ÜÊõ¥Êñ∞‰∏∫:', tagsInput.value);
            }
        }
        
        // ÂàùÂßãÂåñÊ†áÁ≠æÈÄâÊã©ÂäüËÉΩ
        function initTagSelection() {
            const presetTags = document.querySelectorAll('.preset-tag');
            
            console.log('ÂàùÂßãÂåñÊ†áÁ≠æÈÄâÊã©ÔºåÊâæÂà∞Ê†áÁ≠æÊï∞Èáè:', presetTags.length);
            console.log('Ê†áÁ≠æÂÖÉÁ¥†ÂàóË°®:', presetTags);
            
            if (presetTags.length === 0) {
                console.warn('Êú™ÊâæÂà∞‰ªª‰ΩïÈ¢ÑÁΩÆÊ†áÁ≠æÂÖÉÁ¥†');
                return;
            }
            
            presetTags.forEach((tag, index) => {
                const tagText = tag.getAttribute('data-tag');
                console.log(`ÁªëÂÆöÁ¨¨${index + 1}‰∏™Ê†áÁ≠æ:`, tagText, 'ÂÖÉÁ¥†:', tag);
                
                // ÁßªÈô§‰πãÂâçÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºàÂ¶ÇÊûúÊúâÔºâ
                tag.removeEventListener('click', handleTagClick);
                // Ê∑ªÂä†Êñ∞ÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
                tag.addEventListener('click', handleTagClick);
                
                // È™åËØÅ‰∫ã‰ª∂ÊòØÂê¶ÁªëÂÆöÊàêÂäü
                console.log(`Ê†áÁ≠æ ${tagText} ‰∫ã‰ª∂ÁªëÂÆöÂÆåÊàê`);
            });
            
            console.log('ÊâÄÊúâÊ†áÁ≠æ‰∫ã‰ª∂ÁªëÂÆöÂÆåÊàê');
        }
        
        // ‰øùÂ≠òÊñ∞Â¢ûÁöÑÁõÆÊ†á
        function saveAddGoal() {
            // Ëé∑ÂèñË°®ÂçïÂÖÉÁ¥†Âπ∂Ê∑ªÂä†nullÊ£ÄÊü•
            const nameElement = document.getElementById('addGoalTitle');
            const descriptionElement = document.getElementById('addGoalDescription');
            const startDateElement = document.getElementById('addGoalStartDate');
            const deadlineElement = document.getElementById('addGoalDeadline');
            const tagsElement = document.getElementById('addGoalTags');
            
            // Ê£ÄÊü•ÂÖÉÁ¥†ÊòØÂê¶Â≠òÂú®
            if (!nameElement || !descriptionElement || !startDateElement || !deadlineElement || !tagsElement) {
                alert('Ë°®ÂçïÂÖÉÁ¥†Êú™ÊâæÂà∞ÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØï');
                return;
            }
            
            const title = nameElement.value.trim();
            const description = descriptionElement.value.trim();
            const priority = 'medium'; // ËÆæÁΩÆÈªòËÆ§‰ºòÂÖàÁ∫ß
            const startDate = startDateElement.value || null; // Ëµ∑ÂßãÊó•ÊúüÔºåÊ†ºÂºè‰∏∫YYYY-MM-DD
            const endDate = deadlineElement.value || null; // Êà™Ê≠¢Êó•ÊúüÔºåÊ†ºÂºè‰∏∫YYYY-MM-DD
            const tagsString = tagsElement.value.trim();
            
            // Â∞ÜÊ†áÁ≠æÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Êï∞ÁªÑ
            const tags = tagsString ? tagsString.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0) : [];
            
            // Ë°®ÂçïÈ™åËØÅ
            if (!title) {
                alert('ËØ∑ËæìÂÖ•ÁõÆÊ†áÂêçÁß∞');
                return;
            }
            
            // È™åËØÅÊ†áÁ≠æ‰∏çËÉΩ‰∏∫Á©∫
            if (tags.length === 0) {
                alert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰∏™Ê†áÁ≠æ');
                return;
            }
            
            // Ëé∑ÂèñÁé∞ÊúâÂæÆÁõÆÊ†áÊï∞ÊçÆ
            const goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
            
            // ÂÆâÂÖ®Âú∞ËÆ°ÁÆóÊúÄÂ§ßID
            let maxId = 10000;
            if (goals.length > 0) {
                const validIds = goals
                    .map(g => {
                        if (g.goal_id && typeof g.goal_id === 'string' && g.goal_id.startsWith('g_')) {
                            const numPart = g.goal_id.replace('g_', '');
                            const parsed = parseInt(numPart);
                            return isNaN(parsed) ? 0 : parsed;
                        }
                        return 0;
                    })
                    .filter(id => id > 0);
                
                if (validIds.length > 0) {
                    maxId = Math.max(...validIds);
                }
            }
            
            // ÂàõÂª∫Êñ∞ÂæÆÁõÆÊ†áÔºà‰ΩøÁî®ÂæÆÁõÆÊ†áÊï∞ÊçÆÂ∫ìÁöÑÁªìÊûÑÔºâ
            const newGoal = {
                goal_id: `g_${maxId + 1}`,
                title: title,
                description: description,
                order: goals.length + 1,
                is_optional: false,
                base_points: 100,
                tags: tags,
                start_date: startDate, // Ëµ∑ÂßãÊó•ÊúüÔºåÊ†ºÂºè‰∏∫YYYY-MM-DD
                end_date: endDate, // Êà™Ê≠¢Êó•ÊúüÔºåÊ†ºÂºè‰∏∫YYYY-MM-DD
                status: 'Êú™ÂºÄÂßã',
                progress: 0,
                created_at: new Date().toISOString(),
                updated_at: new Date().toISOString()
            };
            
            // Ê∑ªÂä†Êñ∞ÁõÆÊ†áÂà∞ÂæÆÁõÆÊ†áÊï∞ÊçÆÂ∫ì
            goals.push(newGoal);
            localStorage.setItem('gms_micro_goals', JSON.stringify(goals));
            
            // ÂÖ≥Èó≠ÂºπÁ™ó
            const modal = document.getElementById('addGoalModal');
            if (modal) {
                modal.style.display = 'none';
            }
            
            // ÈáçÊñ∞Âä†ËΩΩÊ†áÁ≠æËøáÊª§Âô®ÂíåÁõÆÊ†áÂàóË°®
            if (window.microGoalTagFilter) {
                window.microGoalTagFilter.reload();
            }
            
            // Âà∑Êñ∞ÁõÆÊ†áÂàóË°®ÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâ
            if (typeof loadGoalsToContainer === 'function') {
                loadGoalsToContainer();
            }
            
            alert('ÁõÆÊ†áÂàõÂª∫ÊàêÂäüÔºÅ');
        }
        
        // Âä†ËΩΩÊñ∞Â¢ûÈáåÁ®ãÁ¢ëÁöÑÁª¥Â∫¶ÈÄâÊã©Âô®
        function loadAddDimensionSelectors() {
            const container = document.getElementById('addDynamicDimensionSelectors');
            if (!container) return;
            
            // Ê∏ÖÁ©∫ÂÆπÂô®
            container.innerHTML = '';
            
            // Ëé∑ÂèñÁª¥Â∫¶Êï∞ÊçÆ
            const dimensions = milestoneDataLoader.processManager.getDimensions();
            const allDimensionValues = milestoneDataLoader.processManager.getDimensionValues();
            
            dimensions.forEach(dimension => {
                const values = allDimensionValues.filter(v => v.dimension_id === dimension.dimension_id);
                if (values.length === 0) return;
                
                // ÂàõÂª∫Áª¥Â∫¶ÁªÑ
                const formGroup = document.createElement('div');
                formGroup.className = 'form-group';
                
                // ÂàõÂª∫Ê†áÁ≠æ
                const label = document.createElement('label');
                label.textContent = dimension.name;
                label.className = 'dimension-label';
                
                // ÂàõÂª∫ÈÄâÊã©Âô®ÂÆπÂô®
                const selector = document.createElement('div');
                selector.className = 'dimension-selector';
                
                // ÊåâorderÊéíÂ∫èÁª¥Â∫¶ÂÄº
                values.sort((a, b) => (a.order || 0) - (b.order || 0));
                
                // ‰∏∫ÊØè‰∏™Áª¥Â∫¶ÂÄºÂàõÂª∫ÈÄâÈ°π
                values.forEach(value => {
                    const option = document.createElement('div');
                    option.className = 'dimension-option';
                    option.setAttribute('data-value-id', value.value_id);
                    option.setAttribute('data-dimension-id', dimension.dimension_id);
                    option.textContent = value.value;
                    
                    // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                    option.addEventListener('click', function() {
                        // ÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅ
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                        } else {
                            this.classList.add('selected');
                        }
                    });
                    
                    selector.appendChild(option);
                });
                
                // ÁªÑË£ÖÁª¥Â∫¶ÁªÑ
                formGroup.appendChild(label);
                formGroup.appendChild(selector);
                container.appendChild(formGroup);
            });
        }
        
        // ÈáåÁ®ãÁ¢ëÊêúÁ¥¢ËøáÊª§ÂáΩÊï∞
        function filterMilestones(searchTerm) {
            const milestoneItems = document.querySelectorAll('.milestone-item');
            let visibleCount = 0;
            
            milestoneItems.forEach(item => {
                const title = item.querySelector('.milestone-title');
                if (title) {
                    const titleText = title.textContent.toLowerCase();
                    if (searchTerm === '' || titleText.includes(searchTerm)) {
                        item.style.visibility = 'visible';
                        item.style.position = 'relative';
                        visibleCount++;
                    } else {
                        item.style.visibility = 'hidden';
                        item.style.position = 'absolute';
                    }
                }
            });
            
            // ÊòæÁ§∫ÊêúÁ¥¢ÁªìÊûúÊèêÁ§∫
            const container = document.getElementById('milestones-container');
            let noResultsMsg = container.querySelector('.no-results-message');
            
            if (searchTerm !== '' && visibleCount === 0) {
                if (!noResultsMsg) {
                    noResultsMsg = document.createElement('div');
                    noResultsMsg.className = 'no-results-message';
                    noResultsMsg.style.cssText = 'text-align: center; color: #999; padding: 20px; font-size: 14px;';
                    container.appendChild(noResultsMsg);
                }
                noResultsMsg.textContent = `Êú™ÊâæÂà∞ÂåÖÂê´"${searchTerm}"ÁöÑÈáåÁ®ãÁ¢ë`;
                noResultsMsg.style.display = 'block';
            } else {
                if (noResultsMsg) {
                    noResultsMsg.style.display = 'none';
                }
            }
        }
        
        // ‰øùÂ≠òÊñ∞Â¢ûÁöÑÈáåÁ®ãÁ¢ë
        function saveAddMilestone() {
            const title = document.getElementById('addMilestoneTitle').value.trim();
            if (!title) {
                alert('ËØ∑ËæìÂÖ•ÈáåÁ®ãÁ¢ëÊ†áÈ¢ò');
                return;
            }
            
            // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑÁª¥Â∫¶ÂÄº
            const selectedOptions = document.querySelectorAll('#addMilestoneModal .dimension-option.selected');
            if (selectedOptions.length === 0) {
                alert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰∏™Áª¥Â∫¶ÂÄº');
                return;
            }
            
            // ÁîüÊàêÊñ∞ÁöÑÈáåÁ®ãÁ¢ëID
            const milestoneId = `milestone_${Date.now()}`;
            
            // ÂàõÂª∫Êñ∞ÈáåÁ®ãÁ¢ë
            const newMilestone = {
                milestone_id: milestoneId,
                title: title,
                description: '',
                created_at: new Date().toISOString(),
                updated_at: new Date().toISOString()
            };
            
            // ‰øùÂ≠òÈáåÁ®ãÁ¢ë
            const milestones = milestoneDataLoader.processManager.getMilestones();
            milestones.push(newMilestone);
            localStorage.setItem('gms_milestones', JSON.stringify(milestones));
            
            // ÂàõÂª∫Áª¥Â∫¶ÂÖ≥ËÅî
            let relations = milestoneDataLoader.processManager.getMilestoneDimensionRelations();
            
            selectedOptions.forEach((option, index) => {
                const relationId = `mr_${milestoneId}_${option.getAttribute('data-dimension-id')}_${Date.now()}_${index}`;
                relations.push({
                    relation_id: relationId,
                    milestone_id: milestoneId,
                    dimension_id: parseInt(option.getAttribute('data-dimension-id')),
                    dimension_value_id: parseInt(option.getAttribute('data-value-id')),
                    weight: 1.0
                });
            });
            
            // ‰øùÂ≠òÂÖ≥ËÅîÊï∞ÊçÆ
            localStorage.setItem('gms_milestone_dimension_relations', JSON.stringify(relations));
            
            // ÂÖ≥Èó≠ÂºπÁ™ó
            document.getElementById('addMilestoneModal').style.display = 'none';
            
            // Âà∑Êñ∞ÈáåÁ®ãÁ¢ëÂàóË°®
            milestoneDataLoader.loadMilestonesToContainer();
            
            alert('ÈáåÁ®ãÁ¢ëÂàõÂª∫ÊàêÂäüÔºÅ');
        }

        // Ê†áÁ≠æÈ¢úËâ≤Á¥¢ÂºïÊò†Â∞ÑÂíåËÆ°Êï∞Âô®
        let tagColorMap = {};
        let colorCounter = 0;
        
        // ÁîüÊàêÊ†áÁ≠æÈ¢úËâ≤Á±ªÂêçÁöÑÂáΩÊï∞
        function getTagColorClass(tagText) {
            // Â¶ÇÊûúÊ†áÁ≠æÂ∑≤ÁªèÊúâÈ¢úËâ≤Êò†Â∞ÑÔºåÁõ¥Êé•ËøîÂõû
            if (tagColorMap[tagText] !== undefined) {
                return `tag-color-${tagColorMap[tagText]}`;
            }
            
            // ‰∏∫Êñ∞Ê†áÁ≠æÂàÜÈÖç‰∏ã‰∏Ä‰∏™È¢úËâ≤Á¥¢Âºï
            const colorIndex = (colorCounter % 11) + 1;
            tagColorMap[tagText] = colorIndex;
            colorCounter++;
            
            return `tag-color-${colorIndex}`;
        }

        // ÁªüËÆ°ÊåáÂÆöÁõÆÊ†áIDÁöÑËøõÂ±ïËÆ∞ÂΩïÊï∞Èáè
        function getProgressRecordCount(goalId) {
            console.log('getProgressRecordCount Ë¢´Ë∞ÉÁî®ÔºåÁõÆÊ†áID:', goalId);
            
            if (!goalId) {
                console.log('ÁõÆÊ†áID‰∏∫Á©∫ÔºåËøîÂõûÊï∞Èáè: 0');
                return 0;
            }
            
            // ‰ªélocalStorageËé∑ÂèñËøõÂ±ïËÆ∞ÂΩïÊï∞ÊçÆ
            const allRecords = JSON.parse(localStorage.getItem('objective_records') || '[]');
            console.log('‰ªélocalStorageËé∑ÂèñÁöÑÊâÄÊúâËøõÂ±ïËÆ∞ÂΩï:', allRecords);
            
            // Á≠õÈÄâÂΩìÂâçÁõÆÊ†áÁöÑËÆ∞ÂΩï
            const goalRecords = allRecords.filter(record => record.goal_id === goalId);
            console.log(`ÁõÆÊ†áID ${goalId} ÁöÑËøõÂ±ïËÆ∞ÂΩï:`, goalRecords);
            console.log(`ÁõÆÊ†áID ${goalId} ÁöÑËøõÂ±ïËÆ∞ÂΩïÊï∞Èáè:`, goalRecords.length);
            
            return goalRecords.length;
        }
        
        // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÁöÑÊï∞ÈáèÊòæÁ§∫
        function updateProgressRecordButtonCount(goalId) {
            console.log('updateProgressRecordButtonCount Ë¢´Ë∞ÉÁî®ÔºåÁõÆÊ†áID:', goalId);
            
            const progressRecordBtn = document.getElementById('progressRecordBtn');
            if (!progressRecordBtn) {
                console.log('Êú™ÊâæÂà∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÂÖÉÁ¥†');
                return;
            }
            
            const count = getProgressRecordCount(goalId);
            const btnText = progressRecordBtn.querySelector('.btn-text');
            if (btnText) {
                console.log(`Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊñáÊú¨‰∏∫: ËøõÂ±ïËÆ∞ÂΩï (${count})`);
                btnText.textContent = `ËøõÂ±ïËÆ∞ÂΩï (${count})`;
            } else {
                console.log('Êú™ÊâæÂà∞ÊåâÈíÆÊñáÊú¨ÂÖÉÁ¥†');
            }
        }

        // Âä†ËΩΩÁõÆÊ†áÂàóË°®Âà∞bottom-sectionÂÆπÂô®
        function loadGoalsToContainer(selectedTags = []) {
            const container = document.querySelector('.bottom-section');
            if (!container) {
                console.error('Êú™ÊâæÂà∞bottom-sectionÂÆπÂô®');
                return;
            }
            
            // ‰ªélocalStorageËé∑ÂèñÂæÆÁõÆÊ†áÊï∞ÊçÆ
            let goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
            
            // Ê†πÊçÆÈÄâ‰∏≠ÁöÑÊ†áÁ≠æËøáÊª§ÁõÆÊ†á
            if (selectedTags.length > 0) {
                goals = goals.filter(goal => {
                    if (!goal.tags || !Array.isArray(goal.tags)) {
                        return false;
                    }
                    // Ê£ÄÊü•ÁõÆÊ†áÁöÑÊ†áÁ≠æÊòØÂê¶ÂåÖÂê´‰ªª‰ΩïÈÄâ‰∏≠ÁöÑÊ†áÁ≠æ
                    return goal.tags.some(tag => selectedTags.includes(tag));
                });
            }
            
            // Ê†πÊçÆÈÄâ‰∏≠ÁöÑÊúà‰ªΩËøáÊª§ÁõÆÊ†á
            if (selectedMonths && selectedMonths.length > 0) {
                goals = goals.filter(goal => {
                    return isGoalInSelectedMonths(goal, selectedMonths);
                });
            }
            
            // ÊåâÊà™Ê≠¢Êó•ÊúüÊéíÂ∫èÔºöË∑ùÁ¶ª‰ªäÂ§©ÊúÄËøëÁöÑÊéíÂú®ÂâçÈù¢
            goals.sort((a, b) => {
                const today = new Date();
                today.setHours(0, 0, 0, 0); // ËÆæÁΩÆ‰∏∫ÂΩìÂ§©0ÁÇπÔºå‰æø‰∫éÊØîËæÉ
                
                // Â¶ÇÊûúÈÉΩÊ≤°ÊúâÊà™Ê≠¢Êó•ÊúüÔºå‰øùÊåÅÂéüÈ°∫Â∫è
                if (!a.end_date && !b.end_date) {
                    return 0;
                }
                
                // Ê≤°ÊúâÊà™Ê≠¢Êó•ÊúüÁöÑÊîæÂú®ÊúÄÂêé
                if (!a.end_date) return 1;
                if (!b.end_date) return -1;
                
                // ÈÉΩÊúâÊà™Ê≠¢Êó•ÊúüÔºåÊåâÊó•ÊúüÊéíÂ∫èÔºàÊúÄËøëÁöÑÂú®ÂâçÔºâ
                const dateA = new Date(a.end_date);
                const dateB = new Date(b.end_date);
                
                return dateA - dateB;
            });
            
            // Ê∏ÖÁ©∫ÂÆπÂô®
            container.innerHTML = '';
            
            // Â¶ÇÊûúÊ≤°ÊúâÁõÆÊ†áÔºåÊòæÁ§∫Á©∫Áä∂ÊÄÅ
            if (goals.length === 0) {
                let emptyText, emptyHint;
                if (selectedTags.length > 0) {
                    emptyText = 'Ê≤°ÊúâÂåπÈÖçÁöÑÁõÆÊ†á';
                    emptyHint = `Ê≤°ÊúâÊâæÂà∞ÂåÖÂê´Ê†áÁ≠æ "${selectedTags.join('„ÄÅ')}" ÁöÑÁõÆÊ†á`;
                } else {
                    emptyText = 'ÊöÇÊó†ÁõÆÊ†á';
                    emptyHint = 'ÁÇπÂáª‰∏äÊñπ"Ê∑ªÂä†ÁõÆÊ†á"ÊåâÈíÆÂàõÂª∫ÊÇ®ÁöÑÁ¨¨‰∏Ä‰∏™ÁõÆÊ†á';
                }
                
                container.innerHTML = `
                    <div class="goals-empty-state">
                        <div class="empty-icon">üìã</div>
                        <div class="empty-text">${emptyText}</div>
                        <div class="empty-hint">${emptyHint}</div>
                    </div>
                `;
                return;
            }
            
            // ÂàõÂª∫ÁõÆÊ†áÂàóË°®ÂÆπÂô®
            const goalsListContainer = document.createElement('div');
            goalsListContainer.className = 'goals-list-container';
            
            // Ê∏≤ÊüìÊØè‰∏™ÁõÆÊ†á
            goals.forEach(goal => {
                const goalCard = createGoalCard(goal);
                goalsListContainer.appendChild(goalCard);
            });
            
            container.appendChild(goalsListContainer);
            
            // ÊÅ¢Â§ç‰πãÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†áÂç°ÁâáÁä∂ÊÄÅ
            const selectedGoalId = sessionStorage.getItem('selectedGoalId');
            if (selectedGoalId) {
                const selectedGoalCard = container.querySelector(`[data-goal-id="${selectedGoalId}"]`);
                if (selectedGoalCard) {
                    selectedGoalCard.classList.add('selected');
                    // Á°Æ‰øùËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊï∞ÈáèÊ≠£Á°ÆÊòæÁ§∫
                    console.log('filterGoalsÊÅ¢Â§çÈÄâ‰∏≠Áä∂ÊÄÅÂêéÊõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊï∞ÈáèÔºåÁõÆÊ†áID:', selectedGoalId);
                    updateProgressRecordButtonCount(selectedGoalId);
                }
            }
        }
        
        // ÁõÆÊ†áÊêúÁ¥¢ËøáÊª§ÂáΩÊï∞
        function filterGoals(searchTerm) {
            const container = document.querySelector('.bottom-section');
            if (!container) {
                console.error('Êú™ÊâæÂà∞bottom-sectionÂÆπÂô®');
                return;
            }
            
            // ‰ªélocalStorageËé∑ÂèñÂæÆÁõÆÊ†áÊï∞ÊçÆ
            let goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
            
            // Â¶ÇÊûúÊêúÁ¥¢ËØç‰∏∫Á©∫ÔºåÊòæÁ§∫ÊâÄÊúâÁõÆÊ†á
            if (!searchTerm) {
                loadGoalsToContainer();
                return;
            }
            
            // Ê†πÊçÆÊêúÁ¥¢ËØçËøáÊª§ÁõÆÊ†á
            const filteredGoals = goals.filter(goal => {
                // ÊêúÁ¥¢ÁõÆÊ†áÊ†áÈ¢ò
                const titleMatch = goal.title && goal.title.toLowerCase().includes(searchTerm);
                
                // ÊêúÁ¥¢ÁõÆÊ†áÊ†áÁ≠æ
                const tagMatch = goal.tags && goal.tags.some(tag => 
                    tag.toLowerCase().includes(searchTerm)
                );
                
                return titleMatch || tagMatch;
            });
            
            // ÂØπÊêúÁ¥¢ÁªìÊûúÊåâÊà™Ê≠¢Êó•ÊúüÊéíÂ∫è
            filteredGoals.sort((a, b) => {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                if (!a.end_date && !b.end_date) {
                    return 0;
                }
                
                if (!a.end_date) return 1;
                if (!b.end_date) return -1;
                
                const dateA = new Date(a.end_date);
                const dateB = new Date(b.end_date);
                
                return dateA - dateB;
            });
            
            // Ê∏ÖÁ©∫ÂÆπÂô®
            container.innerHTML = '';
            
            // Â¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÁöÑÁõÆÊ†áÔºåÊòæÁ§∫Á©∫Áä∂ÊÄÅ
            if (filteredGoals.length === 0) {
                container.innerHTML = `
                    <div class="goals-empty-state">
                        <div class="empty-icon">üîç</div>
                        <div class="empty-text">Êú™ÊâæÂà∞ÂåπÈÖçÁöÑÁõÆÊ†á</div>
                        <div class="empty-hint">Ê≤°ÊúâÊâæÂà∞ÂåÖÂê´ "${searchTerm}" ÁöÑÁõÆÊ†áÊàñÊ†áÁ≠æ</div>
                    </div>
                `;
                return;
            }
            
            // ÂàõÂª∫ÁõÆÊ†áÂàóË°®ÂÆπÂô®
            const goalsListContainer = document.createElement('div');
            goalsListContainer.className = 'goals-list-container';
            
            // Ê∏≤ÊüìÂåπÈÖçÁöÑÁõÆÊ†á
            filteredGoals.forEach(goal => {
                const goalCard = document.createElement('div');
                goalCard.className = 'goal-card';
                goalCard.setAttribute('data-goal-id', goal.goal_id);
                
                // ÂàõÂª∫Ê†áÈ¢òÂíåÊ†áÁ≠æÁöÑÂÆπÂô®
                const titleTagContainer = document.createElement('div');
                titleTagContainer.className = 'goal-title-tag-container';
                
                // ÂàõÂª∫Ê†áÁ≠æÂÆπÂô®
                const tagsContainer = document.createElement('div');
                tagsContainer.className = 'goal-tags';
                
                // ÂàõÂª∫ÁõÆÊ†áÊ†áÈ¢òÔºàÈ´ò‰∫ÆÊêúÁ¥¢ËØçÔºâ
                const goalTitle = document.createElement('div');
                goalTitle.className = 'goal-title';
                const titleText = goal.title || 'Êú™ÂëΩÂêçÁõÆÊ†á';
                goalTitle.innerHTML = highlightSearchTerm(titleText, searchTerm);
                
                // Ê∏≤ÊüìÊ†áÁ≠æÔºàÈ´ò‰∫ÆÊêúÁ¥¢ËØçÔºâ
                if (goal.tags && goal.tags.length > 0) {
                    goal.tags.forEach(tag => {
                        const tagElement = document.createElement('span');
                        tagElement.className = 'goal-tag';
                        tagElement.innerHTML = highlightSearchTerm(tag, searchTerm);
                        tagsContainer.appendChild(tagElement);
                    });
                } else {
                    const noTagsElement = document.createElement('span');
                    noTagsElement.className = 'goal-no-tags';
                    noTagsElement.textContent = 'Êó†Ê†áÁ≠æ';
                    tagsContainer.appendChild(noTagsElement);
                }
                
                // Ê∑ªÂä†Êó•Êúü‰ø°ÊÅØÊòæÁ§∫
                const dateInfoContainer = document.createElement('div');
                dateInfoContainer.className = 'goal-date-info';
                
                // Ê∑ªÂä†‰ªªÂä°Áä∂ÊÄÅÊ†áÁ≠æ
                const taskStatusElement = document.createElement('span');
                taskStatusElement.className = 'goal-task-status';
                
                // Ëé∑Âèñ‰ªªÂä°ÁªüËÆ°‰ø°ÊÅØ
                const taskStats = getGoalTaskStats(goal.goal_id);
                const completedCount = taskStats.completedCount;
                const totalCount = taskStats.totalCount;
                const percentage = taskStats.percentage;
                const uncompletedCount = taskStats.uncompletedCount;
                
                taskStatusElement.innerHTML = `
                    <span class="stats-text">${completedCount}/${totalCount} (${percentage}%) Êú™ÂÆåÊàêÔºö${uncompletedCount}</span>
                `;
                
                // ËÆæÁΩÆËøõÂ∫¶Êù°ÂÆΩÂ∫¶ÂíåÁä∂ÊÄÅÁ±ª
                taskStatusElement.style.setProperty('--progress-width', `${percentage}%`);
                
                // Ê†πÊçÆÂÆåÊàêÁôæÂàÜÊØîÊ∑ªÂä†Áä∂ÊÄÅÁ±ª
                if (percentage === 100) {
                    taskStatusElement.classList.add('completed');
                } else if (percentage === 0) {
                    taskStatusElement.classList.add('no-progress');
                }
                
                dateInfoContainer.appendChild(taskStatusElement);
                
                // Ëµ∑ÂßãÊó•Êúü
                if (goal.start_date) {
                    const startDateElement = document.createElement('span');
                    startDateElement.className = 'goal-date-item start-date';
                    startDateElement.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="date-icon">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                            <circle cx="8" cy="14" r="1"></circle>
                        </svg>
                        <span class="date-text">${goal.start_date}</span>
                    `;
                    dateInfoContainer.appendChild(startDateElement);
                }
                
                // Êà™Ê≠¢Êó•Êúü
                if (goal.end_date) {
                    const endDateElement = document.createElement('span');
                    endDateElement.className = 'goal-date-item end-date';
                    
                    // ËÆ°ÁÆóÂâ©‰ΩôÂ§©Êï∞
                    const remainingDays = calculateRemainingDays(goal.end_date);
                    const remainingInfo = formatRemainingDays(remainingDays, goal.goal_id);
                
                endDateElement.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="date-icon">
                        <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                        <line x1="4" y1="22" x2="4" y2="15"></line>
                    </svg>
                    <span class="date-text">${goal.end_date}</span>
                    ${remainingInfo.text ? `<span class="${remainingInfo.className}">${remainingInfo.text}</span>` : ''}
                `;
                    dateInfoContainer.appendChild(endDateElement);
                }
                
                // ÂàõÂª∫Êìç‰ΩúÊåâÈíÆÂå∫Âüü
                const actionButtons = document.createElement('div');
                actionButtons.className = 'goal-action-buttons';
                
                // ÁºñËæëÊåâÈíÆ
                const editButton = document.createElement('button');
                editButton.className = 'goal-action-btn edit-btn';
                editButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                `;
                editButton.title = 'ÁºñËæëÁõÆÊ†á';
                
                // Âà†Èô§ÊåâÈíÆ
                const deleteButton = document.createElement('button');
                deleteButton.className = 'goal-action-btn delete-btn';
                deleteButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3,6 5,6 21,6"></polyline>
                        <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                `;
                deleteButton.title = 'Âà†Èô§ÁõÆÊ†á';
                
                // Ê∑ªÂä†ÊåâÈíÆÂà∞Êìç‰ΩúÂå∫Âüü
                actionButtons.appendChild(editButton);
                actionButtons.appendChild(deleteButton);
                
                // ÂàõÂª∫Áä∂ÊÄÅÂúÜÁéØÂÆπÂô®
                const statusCircle = document.createElement('div');
                statusCircle.className = 'goal-status-circle';
                
                // ËÆ°ÁÆóÊó∂Èó¥ËøõÂ∫¶Âíå‰ªªÂä°ÂÆåÊàêÁä∂ÊÄÅ
                const goalTaskStats = getGoalTaskStats(goal.goal_id);
                const remainingDays = calculateRemainingDays(goal.end_date);
                const isOverdue = remainingDays !== null && remainingDays < 0;
                const isCompleted = goalTaskStats.percentage === 100;
                
                // ËÆæÁΩÆÂúÜÁéØÂÜÖÂÆπÂíåÈ¢úËâ≤
                if (isCompleted) {
                    // ‰ªªÂä°100%ÂÆåÊàêÔºåÊòæÁ§∫ÁªøËâ≤ÂãæÂè∑
                    statusCircle.innerHTML = '‚úì';
                    statusCircle.style.backgroundColor = '#4CAF50';
                    statusCircle.style.color = 'white';
                } else if (isOverdue) {
                    // Â∑≤ËøáÊúü‰∏îÊú™ÂÆåÊàêÔºåÊòæÁ§∫Á∫¢Ëâ≤Ë≠¶ÂëäÂõæÊ†á
                    statusCircle.innerHTML = '‚ö†';
                    statusCircle.style.backgroundColor = '#f44336';
                    statusCircle.style.color = 'white';
                } else if (remainingDays !== null) {
                    // ÊòæÁ§∫Ââ©‰ΩôÂ§©Êï∞
                    statusCircle.textContent = remainingDays;
                    if (remainingDays <= 3) {
                        statusCircle.style.backgroundColor = '#ff9800'; // Ê©ôËâ≤Ë≠¶Âëä
                        statusCircle.style.color = 'white';
                    } else {
                        statusCircle.style.backgroundColor = '#2196F3'; // ËìùËâ≤Ê≠£Â∏∏
                        statusCircle.style.color = 'white';
                    }
                } else {
                    // Êó†Êà™Ê≠¢Êó•ÊúüÔºåÊòæÁ§∫ËøõÂ∫¶ÁôæÂàÜÊØî
                    statusCircle.textContent = goalTaskStats.percentage + '%';
                    statusCircle.style.backgroundColor = '#9E9E9E'; // ÁÅ∞Ëâ≤
                    statusCircle.style.color = 'white';
                }
                
                // Â∞ÜÁä∂ÊÄÅÂúÜÁéØ„ÄÅÊ†áÁ≠æÂíåÊ†áÈ¢òÊ∑ªÂä†Âà∞ÂÆπÂô®‰∏≠ÔºàÁä∂ÊÄÅÂúÜÁéØÂú®Â∑¶ÔºåÊ†áÁ≠æÂú®‰∏≠ÔºåÊ†áÈ¢òÂú®Âè≥Ôºâ
                titleTagContainer.appendChild(statusCircle);
                titleTagContainer.appendChild(tagsContainer);
                titleTagContainer.appendChild(goalTitle);
                
                // ÁªÑË£ÖÁõÆÊ†áÂç°Áâá
                goalCard.appendChild(titleTagContainer);
                // Â¶ÇÊûúÊúâÊó•Êúü‰ø°ÊÅØÔºåÂçïÁã¨Ê∑ªÂä†Êó•Êúü‰ø°ÊÅØÂÆπÂô®
                if (goal.start_date || goal.end_date) {
                    goalCard.appendChild(dateInfoContainer);
                }
                goalCard.appendChild(actionButtons);
                
                goalsListContainer.appendChild(goalCard);
            });
            
            container.appendChild(goalsListContainer);
        }
        
        // ËÆ°ÁÆóÂâ©‰ΩôÂ§©Êï∞ÂáΩÊï∞
        function calculateRemainingDays(endDate) {
            if (!endDate) return null;
            
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const targetDate = new Date(endDate);
            targetDate.setHours(0, 0, 0, 0);
            
            const timeDiff = targetDate.getTime() - today.getTime();
            const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
            
            return daysDiff;
        }
        
        // Ê†ºÂºèÂåñÂâ©‰ΩôÂ§©Êï∞ÊòæÁ§∫ÊñáÊú¨ÂíåÊ†∑Âºè
        function formatRemainingDays(days, goalId = null) {
            if (days === null) return { text: '', className: '' };
            
            let text, className;
            
            if (days > 3) {
                text = `ËøòÂâ©${days}Â§©`;
                className = 'remaining-days';
            } else if (days > 0) {
                text = `ËøòÂâ©${days}Â§©`;
                className = 'remaining-days urgent';
            } else if (days === 0) {
                text = '‰ªäÂ§©Êà™Ê≠¢';
                className = 'remaining-days urgent';
            } else {
                // Â∑≤ËøáÊúüÁöÑÊÉÖÂÜµ
                text = `Â∑≤ËøáÊúü${Math.abs(days)}Â§©`;
                className = 'remaining-days overdue';
                
                // Â¶ÇÊûúÊèê‰æõ‰∫ÜgoalIdÔºåÊ£ÄÊü•‰ªªÂä°ÂÆåÊàêÁä∂ÊÄÅ
                if (goalId) {
                    const goalTaskStats = getGoalTaskStats(goalId);
                    // Â¶ÇÊûú‰ªªÂä°100%ÂÆåÊàê‰∏îÂ∑≤ËøáÊúüÔºå‰∏çÊòæÁ§∫ËøáÊúüÊ†áÁ≠æ
                    if (goalTaskStats.percentage === 100) {
                        return { text: '', className: '' };
                    }
                }
            }
            
            return { text, className };
        }

        // È´ò‰∫ÆÊêúÁ¥¢ËØçÂáΩÊï∞
        function highlightSearchTerm(text, searchTerm) {
            if (!searchTerm) return text;
            
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }
        
        // Âú®Âè≥‰æßÈù¢ÊùøÊòæÁ§∫ÁõÆÊ†á‰ø°ÊÅØ
        function displayGoalInRightPanel(goal) {
            console.log('displayGoalInRightPanelË¢´Ë∞ÉÁî®ÔºåÂèÇÊï∞goal:', goal);
            
            // ÂèÇÊï∞È™åËØÅ
            if (!goal) {
                console.error('displayGoalInRightPanel: goalÂèÇÊï∞‰∏∫Á©∫ÊàñÊú™ÂÆö‰πâ');
                return;
            }
            
            if (!goal.goal_id) {
                console.error('displayGoalInRightPanel: goalÂØπË±°Áº∫Â∞ëgoal_idÂ±ûÊÄß', goal);
                return;
            }
            
            console.log('displayGoalInRightPanel: ÁõÆÊ†áÊï∞ÊçÆÈ™åËØÅÈÄöËøáÔºågoal_id:', goal.goal_id, 'title:', goal.title);
            
            const panelSection1 = document.querySelector('.panel-section-1');
            const panelSection2 = document.querySelector('.panel-section-2');
            const panelSection3 = document.querySelector('.panel-section-3');
            
            if (!panelSection1) {
                console.error('Êú™ÊâæÂà∞panel-section-1ÂÆπÂô®');
                return;
            }
            
            // ÈöêËóèÈªòËÆ§ÊèêÁ§∫ÊñáÂ≠ó
            const defaultHint = document.getElementById('defaultHint');
            if (defaultHint) {
                defaultHint.style.display = 'none';
            }
            
            // ÈáçÁΩÆËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÁä∂ÊÄÅÔºöÈöêËóèËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÔºåÊòæÁ§∫ÈªòËÆ§‰ªªÂä°Èù¢Êùø
            const panelSectionRecord = document.querySelector('.panel-section-record');
            if (panelSectionRecord) {
                panelSectionRecord.style.display = 'none';
            }
            
            // ÊòæÁ§∫panel-section-2Âíåpanel-section-3
            if (panelSection2) {
                panelSection2.style.display = 'block';
            }
            if (panelSection3) {
                panelSection3.style.display = 'block';
            }
            
            // Ê∏ÖÁ©∫Èù¢ÊùøÂÜÖÂÆπÔºà‰øùÁïôÈªòËÆ§ÊèêÁ§∫‰ΩÜÈöêËóèÔºâ
            const existingGoalInfo = panelSection1.querySelector('.goal-info-container');
            if (existingGoalInfo) {
                existingGoalInfo.remove();
            }
            
            // ÂàõÂª∫ÁõÆÊ†á‰ø°ÊÅØÂÆπÂô®
            const goalInfoContainer = document.createElement('div');
            goalInfoContainer.className = 'goal-info-container';
            
            // ÂàõÂª∫Ê†áÈ¢ò
            const titleElement = document.createElement('h3');
            titleElement.className = 'goal-info-title';
            titleElement.textContent = goal.title || 'Êú™ÂëΩÂêçÁõÆÊ†á';
            
            // ÂàõÂª∫Ê†áÁ≠æÂÆπÂô®
            const tagsContainer = document.createElement('div');
            tagsContainer.className = 'goal-info-tags';
            
            if (goal.tags && goal.tags.length > 0) {
                goal.tags.forEach(tag => {
                    const tagElement = document.createElement('span');
                    const colorClass = getTagColorClass(tag);
                    tagElement.className = `goal-info-tag ${colorClass}`;
                    tagElement.textContent = tag;
                    tagsContainer.appendChild(tagElement);
                });
            } else {
                const noTagsElement = document.createElement('span');
                noTagsElement.className = 'goal-info-no-tags';
                noTagsElement.textContent = 'Êó†Ê†áÁ≠æ';
                tagsContainer.appendChild(noTagsElement);
            }
            
            // ÂàõÂª∫Ê†áÈ¢òÂíåÁªüËÆ°‰ø°ÊÅØÁöÑÂÆπÂô®
            const titleStatsContainer = document.createElement('div');
            titleStatsContainer.className = 'goal-title-stats-container';
            titleStatsContainer.style.cssText = 'display: flex; align-items: center; justify-content: space-between; width: 100%;';
            
            // ÂàõÂª∫‰ªªÂä°ÁªüËÆ°ÂÆπÂô®
            const taskStatsContainer = document.createElement('div');
            taskStatsContainer.className = 'task-stats-container';
            taskStatsContainer.id = 'taskStatsContainer';
            
            // Ê∑ªÂä†Á§∫‰æãÁªüËÆ°Êï∞ÊçÆÔºàÂ∞ÜÂú®ÂêéÁª≠Âä®ÊÄÅÊõ¥Êñ∞Ôºâ
            taskStatsContainer.innerHTML = `
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
                <span class="stats-text">0/0 (0%) Êú™ÂÆåÊàêÔºö0</span>
            `;
            
            // Â∞ÜÊ†áÈ¢òÊ∑ªÂä†Âà∞Ê†áÈ¢òÁªüËÆ°ÂÆπÂô®
            titleStatsContainer.appendChild(titleElement);
            
            // Â∞Ü‰ªªÂä°ÁªüËÆ°ÂÆπÂô®Ê∑ªÂä†Âà∞goal-tasks-infoÂÆπÂô®ÂÜÖÈÉ®
            const goalTasksInfo = document.querySelector('.goal-tasks-info');
            if (goalTasksInfo) {
                goalTasksInfo.innerHTML = ''; // Ê∏ÖÁ©∫Âç†‰ΩçÂÜÖÂÆπ
                goalTasksInfo.appendChild(taskStatsContainer);
            }
            
            // ÂàõÂª∫goal-title-headÂÆπÂô®
            const goalTitleHead = document.createElement('div');
            goalTitleHead.className = 'goal-title-head';
            
            // ÂàõÂª∫goal-status-detailsÂÆπÂô®
            const goalStatusDetails = document.createElement('div');
            goalStatusDetails.className = 'goal-status-details';
            
            // ÂàõÂª∫Êó•Êúü‰ø°ÊÅØÂÆπÂô®
            const dateInfoContainer = document.createElement('div');
            dateInfoContainer.className = 'goal-date-info';
            
            // Ëµ∑ÂßãÊó•Êúü
            if (goal.start_date) {
                const startDateElement = document.createElement('span');
                startDateElement.className = 'goal-date-item start-date';
                startDateElement.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="date-icon">
                        <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                        <line x1="4" y1="22" x2="4" y2="15"></line>
                    </svg>
                    <span class="date-text">${goal.start_date}</span>
                `;
                dateInfoContainer.appendChild(startDateElement);
            }
            
            // Êà™Ê≠¢Êó•Êúü
            if (goal.end_date) {
                const endDateElement = document.createElement('span');
                endDateElement.className = 'goal-date-item end-date';
                
                // ËÆ°ÁÆóÂâ©‰ΩôÂ§©Êï∞
                const remainingDays = calculateRemainingDays(goal.end_date);
                const remainingInfo = formatRemainingDays(remainingDays, goal.goal_id);
                
                endDateElement.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="date-icon">
                        <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                        <line x1="4" y1="22" x2="4" y2="15"></line>
                    </svg>
                    <span class="date-text">${goal.end_date}</span>
                `;
                dateInfoContainer.appendChild(endDateElement);
                
                // ÂàõÂª∫Ââ©‰ΩôÂ§©Êï∞ÂÖÉÁ¥†Âπ∂ÊîæÂú®Êà™Ê≠¢Êó•ÊúüÂ§ñÈÉ®Âè≥‰æß
                if (remainingInfo.text) {
                    const remainingElement = document.createElement('span');
                    remainingElement.className = remainingInfo.className;
                    remainingElement.textContent = remainingInfo.text;
                    dateInfoContainer.appendChild(remainingElement);
                }
            }
            
            // ÂàõÂª∫‰ªªÂä°Áä∂ÊÄÅÂÖÉÁ¥†
            const taskStatusElement = document.createElement('div');
            taskStatusElement.className = 'goal-task-status';
            
            // Ëé∑Âèñ‰ªªÂä°ÁªüËÆ°‰ø°ÊÅØ
            const taskStats = getGoalTaskStats(goal.goal_id);
            const completedCount = taskStats.completedCount;
            const totalCount = taskStats.totalCount;
            const percentage = taskStats.percentage;
            const uncompletedCount = taskStats.uncompletedCount;
            
            // Ê†πÊçÆËøõÂ∫¶ÁôæÂàÜÊØîÊòæÁ§∫‰∏çÂêåÁä∂ÊÄÅ
            if (percentage === 100) {
                // 100%ÂÆåÊàêÊó∂ÊòæÁ§∫ÁªøËâ≤"Â∑≤ÂÆåÊàê"Ê†áÁ≠æ
                taskStatusElement.innerHTML = `<span class="status-text">Â∑≤ÂÆåÊàê</span>`;
                taskStatusElement.classList.add('status-completed');
            } else if (percentage === 0) {
                // 0%ÂÆåÊàêÊó∂ÊòæÁ§∫ÁÅ∞Ëâ≤"Êú™ÂºÄÂßã"Ê†áÁ≠æ
                taskStatusElement.innerHTML = `<span class="status-text">Êú™ÂºÄÂßã</span>`;
                taskStatusElement.classList.add('status-not-started');
            } else {
                // ÂÖ∂‰ªñËøõÂ∫¶ÊòæÁ§∫ËøõÂ∫¶Êù°ÂíåÁªüËÆ°‰ø°ÊÅØ
                taskStatusElement.innerHTML = `
                    <span class="stats-text">${completedCount}/${totalCount} (${percentage}%) Êú™ÂÆåÊàêÔºö${uncompletedCount}</span>
                `;
                // ËÆæÁΩÆËøõÂ∫¶Êù°ÂÆΩÂ∫¶
                taskStatusElement.style.setProperty('--progress-width', `${percentage}%`);
            }
            
            // Â∞ÜÊó•Êúü‰ø°ÊÅØÂÆπÂô®Âíå‰ªªÂä°Áä∂ÊÄÅÂÖÉÁ¥†Ê∑ªÂä†Âà∞goal-status-details‰∏≠
            goalStatusDetails.appendChild(dateInfoContainer);
            goalStatusDetails.appendChild(taskStatusElement);
            
            // Â∞ÜÊ†áÁ≠æÂíåÊ†áÈ¢òÁªüËÆ°ÂÆπÂô®Ê∑ªÂä†Âà∞goal-title-head‰∏≠
            goalTitleHead.appendChild(tagsContainer);
            goalTitleHead.appendChild(titleStatsContainer);
            
            // ÁªÑË£ÖÂÆπÂô®
            goalInfoContainer.appendChild(goalTitleHead);
            goalInfoContainer.appendChild(goalStatusDetails);
            
            panelSection1.appendChild(goalInfoContainer);
            
            // ÊòæÁ§∫ÁõÆÊ†áÊèèËø∞
            displayGoalDescription(goal);
            
            // ÊòæÁ§∫ÂÖ≥ËÅî‰ªªÂä°
            displayRelatedTasks(goal.goal_id);
        }

        // ÈöêËóèÂè≥‰æßÈù¢Êùø
        function hideRightPanel() {
            const panelSection1 = document.querySelector('.panel-section-1');
            const panelSection2 = document.querySelector('.panel-section-2');
            const panelSection3 = document.querySelector('.panel-section-3');
            const panelSectionRecord = document.querySelector('.panel-section.panel-section-2.panel-section-record');
            const backToTasksBtn = document.getElementById('backToTasksBtn');
            
            // ÈöêËóèpanel-section-2Âíåpanel-section-3
            if (panelSection2) {
                panelSection2.style.display = 'none';
            }
            if (panelSection3) {
                panelSection3.style.display = 'none';
            }
            
            // ÈöêËóèËøõÂ±ïËÆ∞ÂΩïÈù¢Êùø
            if (panelSectionRecord) {
                panelSectionRecord.style.display = 'none';
            }
            
            // ÈöêËóèËøîÂõûÊåâÈíÆ
            if (backToTasksBtn) {
                backToTasksBtn.style.display = 'none';
            }
            
            // Ê∏ÖÈô§ÁõÆÊ†á‰ø°ÊÅØ
            if (panelSection1) {
                const existingGoalInfo = panelSection1.querySelector('.goal-info-container');
                if (existingGoalInfo) {
                    existingGoalInfo.remove();
                }
            }
            
            // ÊòæÁ§∫ÈªòËÆ§ÊèêÁ§∫ÊñáÂ≠ó
            const defaultHint = document.getElementById('defaultHint');
            if (defaultHint) {
                defaultHint.style.display = 'flex';
            }
        }

        // ÊòæÁ§∫ÈªòËÆ§ÊèêÁ§∫ÊñáÂ≠ó
        function showDefaultHint() {
            const panelSection1 = document.querySelector('.panel-section-1');
            const panelSection2 = document.querySelector('.panel-section-2');
            const panelSection3 = document.querySelector('.panel-section-3');
            const panelSectionRecord = document.querySelector('.panel-section.panel-section-2.panel-section-record');
            const backToTasksBtn = document.getElementById('backToTasksBtn');
            
            if (!panelSection1) {
                console.error('Êú™ÊâæÂà∞panel-section-1ÂÆπÂô®');
                return;
            }
            
            // ÈöêËóèpanel-section-2Âíåpanel-section-3
            if (panelSection2) {
                panelSection2.style.display = 'none';
            }
            if (panelSection3) {
                panelSection3.style.display = 'none';
            }
            
            // ÈöêËóèËøõÂ±ïËÆ∞ÂΩïÈù¢Êùø
            if (panelSectionRecord) {
                panelSectionRecord.style.display = 'none';
            }
            
            // ÈöêËóèËøîÂõûÊåâÈíÆ
            if (backToTasksBtn) {
                backToTasksBtn.style.display = 'none';
            }
            
            // Ê∏ÖÈô§ÁõÆÊ†á‰ø°ÊÅØ
            const existingGoalInfo = panelSection1.querySelector('.goal-info-container');
            if (existingGoalInfo) {
                existingGoalInfo.remove();
            }
            
            // ÊòæÁ§∫ÈªòËÆ§ÊèêÁ§∫ÊñáÂ≠ó
            const defaultHint = document.getElementById('defaultHint');
            if (defaultHint) {
                defaultHint.style.display = 'flex';
            }
        }

        // ÊòæÁ§∫ÁõÆÊ†áÊèèËø∞
        function displayGoalDescription(goal) {
            // ÁõÆÊ†áÊèèËø∞ÂäüËÉΩÂ∑≤ÁßªÈô§ - ÂæÖÂºÄÂèë
            // ËØ•ÂáΩÊï∞‰øùÁïô‰ª•ÈÅøÂÖçË∞ÉÁî®ÈîôËØØÔºå‰ΩÜ‰∏çÊâßË°å‰ªª‰ΩïÊìç‰Ωú
        }

        // Êõ¥Êñ∞‰ªªÂä°ÁªüËÆ°Êï∞ÊçÆ
        function updateTaskStats(goalId) {
            const taskStatsContainer = document.getElementById('taskStatsContainer');
            if (!taskStatsContainer) {
                console.log('Êú™ÊâæÂà∞‰ªªÂä°ÁªüËÆ°ÂÆπÂô®');
                return;
            }
            
            try {
                // Ëé∑ÂèñËØ•ÁõÆÊ†áÁöÑÂÖ≥ËÅî‰ªªÂä°
                const relatedTasks = goalTaskLinksManager.getTasksByGoalId(goalId);
                
                // ËÆ°ÁÆóÁªüËÆ°Êï∞ÊçÆ
                const totalCount = relatedTasks.length;
                const completedCount = relatedTasks.filter(task => task.status === 1).length;
                const percentage = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
                const uncompletedCount = totalCount - completedCount;
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                taskStatsContainer.innerHTML = `
                    <div class="progress-bar-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                    <span class="stats-text">${completedCount}/${totalCount} (${percentage}%) Êú™ÂÆåÊàêÔºö${uncompletedCount}</span>
                `;
                
                console.log('‰ªªÂä°ÁªüËÆ°Â∑≤Êõ¥Êñ∞:', { goalId, totalCount, completedCount, percentage, uncompletedCount });
            } catch (error) {
                console.error('Êõ¥Êñ∞‰ªªÂä°ÁªüËÆ°Â§±Ë¥•:', error);
                // ÊòæÁ§∫ÈªòËÆ§Êï∞ÊçÆ
                taskStatsContainer.innerHTML = `
                    <div class="progress-bar-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <span class="stats-text">0/0 (0%) Êú™ÂÆåÊàêÔºö0</span>
                `;
            }
        }
        
        // Ëé∑ÂèñÁõÆÊ†á‰ªªÂä°ÁªüËÆ°‰ø°ÊÅØ
        function getGoalTaskStats(goalId) {
            try {
                const relatedTasks = goalTaskLinksManager.getTasksByGoalId(goalId);
                
                // ËÆ°ÁÆóÁªüËÆ°Êï∞ÊçÆ
                const totalCount = relatedTasks.length;
                const completedCount = relatedTasks.filter(task => task.status === 1).length;
                const percentage = totalCount > 0 ? Math.round((completedCount / totalCount) * 100) : 0;
                const uncompletedCount = totalCount - completedCount;
                
                return {
                    totalCount,
                    completedCount,
                    percentage,
                    uncompletedCount
                };
            } catch (error) {
                console.error('Ëé∑ÂèñÁõÆÊ†á‰ªªÂä°ÁªüËÆ°Â§±Ë¥•:', error);
                return {
                    totalCount: 0,
                    completedCount: 0,
                    percentage: 0,
                    uncompletedCount: 0
                };
            }
        }

        // ÊòæÁ§∫ÂÖ≥ËÅî‰ªªÂä°
        function displayRelatedTasks(goalId) {
            console.log('=== displayRelatedTasks Ë¢´Ë∞ÉÁî® ===');
            console.log('ÁõÆÊ†áID:', goalId);
            
            const panelSection2 = document.querySelector('.panel-section-2');
            if (!panelSection2) {
                console.error('Êú™ÊâæÂà∞panel-section-2ÂÆπÂô®');
                return;
            }
            console.log('ÊâæÂà∞panel-section-2ÂÆπÂô®:', panelSection2);
            
            // ÊòæÁ§∫panel-section-2
            panelSection2.style.display = 'block';
            
            // Ê∏ÖÁ©∫ÂÖ≥ËÅî‰ªªÂä°ÊòæÁ§∫Âå∫Âüü
            const relatedTasksDisplay = document.getElementById('relatedTasksContainer');
            if (relatedTasksDisplay) {
                console.log('ÊâæÂà∞relatedTasksContainerÂÆπÂô®ÔºåÊ∏ÖÁ©∫ÂÜÖÂÆπ');
                relatedTasksDisplay.innerHTML = '';
            } else {
                console.log('Êú™ÊâæÂà∞relatedTasksContainerÂÆπÂô®');
            }
            
            // Êõ¥Êñ∞‰ªªÂä°ÁªüËÆ°Êï∞ÊçÆ
            updateTaskStats(goalId);
            
            // ‰ªéÊï∞ÊçÆÂ∫ìÂä†ËΩΩÂÖ≥ËÅî‰ªªÂä°
            loadRelatedTasks(goalId);
        }

        // ËÆ°ÁÆóÈ°πÁõÆËøõÂ∫¶
        function calculateProjectProgress(projectName, projectTasks) {
            const total = projectTasks.length;
            const completed = projectTasks.filter(task => task.status === 1).length;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            return {
                total: total,
                completed: completed,
                percentage: percentage
            };
        }

        // ‰ªéÊï∞ÊçÆÂ∫ìÂä†ËΩΩÂÖ≥ËÅî‰ªªÂä°Êï∞ÊçÆ
        function loadRelatedTasks(goalId) {
            console.log('=== loadRelatedTasks Ë¢´Ë∞ÉÁî® ===');
            console.log('ÁõÆÊ†áID:', goalId);
            
            if (!goalId) {
                console.error('ÁõÆÊ†áID‰∏∫Á©∫ÔºåÊó†Ê≥ïÂä†ËΩΩÂÖ≥ËÅî‰ªªÂä°');
                renderRelatedTasks([]);
                return;
            }
            
            try {
                // Ë∞ÉËØïÔºöÊ£ÄÊü•localStorage‰∏≠ÁöÑÊï∞ÊçÆ
                const links = JSON.parse(localStorage.getItem('gms_goal_task_links') || '[]');
                const projects = JSON.parse(localStorage.getItem('projects') || '[]');
                console.log('Ë∞ÉËØï - ÊâÄÊúâÂÖ≥ËÅîÊï∞ÊçÆ:', links);
                console.log('Ë∞ÉËØï - È°πÁõÆÊï∞ÊçÆ:', projects.map(p => ({id: p.id, name: p.name, taskCount: p.subtasks?.length || 0})));
                console.log('Ë∞ÉËØï - Êü•ÊâæÁõÆÊ†áID:', goalId, 'ÁöÑÂÖ≥ËÅî‰ªªÂä°');
                
                // ‰ΩøÁî®goalTaskLinksManagerËé∑ÂèñÂÖ≥ËÅî‰ªªÂä°
                const relatedTasks = goalTaskLinksManager.getTasksByGoalId(goalId);
                console.log('Âä†ËΩΩÁõÆÊ†áÂÖ≥ËÅî‰ªªÂä°:', goalId, '‰ªªÂä°Êï∞Èáè:', relatedTasks.length);
                console.log('ÂÖ≥ËÅî‰ªªÂä°ËØ¶ÊÉÖ:', relatedTasks);
                
                // ÊòæÁ§∫ÂÖ≥ËÅî‰ªªÂä°
                renderRelatedTasks(relatedTasks, goalId);
            } catch (error) {
                console.error('Âä†ËΩΩÂÖ≥ËÅî‰ªªÂä°Â§±Ë¥•:', error);
                renderRelatedTasks([]);
            }
        }

        // Ê∏≤ÊüìÂÖ≥ËÅî‰ªªÂä°Ê†áÁ≠æ
        function renderRelatedTasks(tasks, goalId) {
            console.log('=== renderRelatedTasks Ë¢´Ë∞ÉÁî® ===');
            console.log('‰º†ÂÖ•ÁöÑ‰ªªÂä°Êï∞ÊçÆ:', tasks);
            console.log('ÁõÆÊ†áID:', goalId);
            
            const relatedTasksDisplay = document.getElementById('relatedTasksContainer');
            if (!relatedTasksDisplay) {
                console.error('Êú™ÊâæÂà∞relatedTasksContainerÂÆπÂô®');
                return;
            }
            console.log('ÊâæÂà∞relatedTasksContainerÂÆπÂô®:', relatedTasksDisplay);
            
            // Ê∏ÖÁ©∫Áé∞ÊúâÂÜÖÂÆπ
            relatedTasksDisplay.innerHTML = '';
            console.log('Â∑≤Ê∏ÖÁ©∫ÂÆπÂô®ÂÜÖÂÆπ');
            
            if (tasks.length === 0) {
                // ÊòæÁ§∫Êó†‰ªªÂä°ÊèêÁ§∫
                const noTasksMessage = document.createElement('div');
                noTasksMessage.className = 'no-related-tasks';
                noTasksMessage.textContent = 'ÊöÇÊó†ÂÖ≥ËÅî‰ªªÂä°';
                relatedTasksDisplay.appendChild(noTasksMessage);
            } else {
                // ÊåâÈ°πÁõÆÂàÜÁªÑ‰ªªÂä°
                const tasksByProject = {};
                tasks.forEach(task => {
                    const projectName = task.project_name || 'Êú™Áü•È°πÁõÆ';
                    if (!tasksByProject[projectName]) {
                        tasksByProject[projectName] = [];
                    }
                    tasksByProject[projectName].push(task);
                });
                
                // ÊåâÈ°πÁõÆÂêçÁß∞ÊéíÂ∫è
                const sortedProjects = Object.keys(tasksByProject).sort();
                
                // Ê∏≤ÊüìÊØè‰∏™È°πÁõÆÁªÑ
                sortedProjects.forEach((projectName, index) => {
                    const projectTasks = tasksByProject[projectName];
                    
                    // ÂàõÂª∫È°πÁõÆÂàÜÈöîÊ†áÈ¢ò
                    const projectHeader = document.createElement('div');
                    projectHeader.className = 'project-group-header';
                    
                    // ËÆ°ÁÆóÈ°πÁõÆËøõÂ∫¶
                    const projectProgress = calculateProjectProgress(projectName, projectTasks);
                    
                    projectHeader.innerHTML = `
                        <div class="project-header-content">
                            <div class="project-name" style="display: flex; align-items: center; justify-content: space-between; flex: 1;">
                                <span class="project-title-c">${projectName}</span>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <div class="project-toggle-icon" data-project-name="${projectName}" title="Â±ïÂºÄ/Êî∂Ëµ∑" style="opacity: 0; transition: opacity 0.2s ease; cursor: pointer;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polyline points="6,9 12,15 18,9"></polyline>
                                        </svg>
                                    </div>
                                    <div class="project-delete-icon" data-project-name="${projectName}" title="Âà†Èô§È°πÁõÆ‰∏ãÊâÄÊúâÂÖ≥ËÅî" style="opacity: 0; transition: opacity 0.2s ease; cursor: pointer;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M3 6h18"/>
                                            <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
                                            <path d="M8 6V4c0-1 1-2 2-2h4c-1 0 2 1 2 2v2"/>
                                            <line x1="10" y1="11" x2="10" y2="17"/>
                                            <line x1="14" y1="11" x2="14" y2="17"/>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                            <div class="project-progress-container">
                                <div class="project-progress-text">${projectProgress.completed}/${projectProgress.total}</div>
                                <div class="project-progress-bar">
                                    <div class="project-progress-fill" style="width: ${projectProgress.percentage}%"></div>
                                </div>
                                <div class="project-progress-percentage">${projectProgress.percentage}%</div>
                            </div>
                        </div>
                        <div class="project-divider"></div>
                    `;
                    relatedTasksDisplay.appendChild(projectHeader);
                    
                    // ‰∏∫Âà†Èô§ÂõæÊ†áÂíåÂ±ïÂºÄÊî∂Ëµ∑ÂõæÊ†áÊ∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                    const deleteIcon = projectHeader.querySelector('.project-delete-icon');
                    const toggleIcon = projectHeader.querySelector('.project-toggle-icon');
                    const projectNameContainer = projectHeader.querySelector('.project-name');
                    
                    if (deleteIcon) {
                        deleteIcon.addEventListener('click', function(e) {
                            e.stopPropagation();
                            deleteProjectAssociations(projectName, goalId);
                        });
                    }
                    
                    // ‰∏∫Â±ïÂºÄÊî∂Ëµ∑ÂõæÊ†áÊ∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                     if (toggleIcon) {
                         toggleIcon.addEventListener('click', function(e) {
                             e.stopPropagation();
                             const svg = toggleIcon.querySelector('svg polyline');
                             const isExpanded = projectTasksContainer.classList.contains('expanded');
                             
                             if (isExpanded) {
                                 // Êî∂Ëµ∑Áä∂ÊÄÅÔºöÁÆ≠Â§¥ÂêëÂè≥
                                 svg.setAttribute('points', '9,6 15,12 9,18');
                                 projectTasksContainer.classList.remove('expanded');
                                 projectTasksContainer.classList.add('collapsed');
                             } else {
                                 // Â±ïÂºÄÁä∂ÊÄÅÔºöÁÆ≠Â§¥Âêë‰∏ã
                                 svg.setAttribute('points', '6,9 12,15 18,9');
                                 projectTasksContainer.classList.remove('collapsed');
                                 projectTasksContainer.classList.add('expanded');
                             }
                         });
                     }
                    
                    // Ê∑ªÂä†Èº†Ê†áÊÇ¨ÊµÆÊïàÊûú
                    if (projectNameContainer && (deleteIcon || toggleIcon)) {
                        projectNameContainer.addEventListener('mouseenter', function() {
                            if (deleteIcon) deleteIcon.style.opacity = '1';
                            if (toggleIcon) toggleIcon.style.opacity = '1';
                        });
                        
                        projectNameContainer.addEventListener('mouseleave', function() {
                            if (deleteIcon) deleteIcon.style.opacity = '0';
                            if (toggleIcon) toggleIcon.style.opacity = '0';
                        });
                    }
                    
                    // ÂàõÂª∫È°πÁõÆ‰ªªÂä°ÂÆπÂô®
                    const projectTasksContainer = document.createElement('div');
                    
                    // Ê£ÄÊü•È°πÁõÆ‰∏ãÊâÄÊúâ‰ªªÂä°ÊòØÂê¶ÈÉΩÂ∑≤ÂÆåÊàê
                    const allTasksCompleted = projectTasks.every(task => task.status === 1);
                    
                    // Ê†πÊçÆ‰ªªÂä°ÂÆåÊàêÁä∂ÊÄÅËÆæÁΩÆÂàùÂßãÂ±ïÂºÄ/Êî∂Ëµ∑Áä∂ÊÄÅ
                    if (allTasksCompleted) {
                        projectTasksContainer.className = 'project-tasks-group collapsed';
                        // ÂêåÊó∂Êõ¥Êñ∞Â±ïÂºÄÊî∂Ëµ∑ÂõæÊ†á‰∏∫Êî∂Ëµ∑Áä∂ÊÄÅ
                        const svg = toggleIcon.querySelector('svg polyline');
                        if (svg) {
                            svg.setAttribute('points', '9,6 15,12 9,18'); // ÁÆ≠Â§¥ÂêëÂè≥Ë°®Á§∫Êî∂Ëµ∑
                        }
                    } else {
                        projectTasksContainer.className = 'project-tasks-group expanded';
                    }
                    
                    // ÂØπÈ°πÁõÆ‰ªªÂä°ËøõË°åÊéíÂ∫èÔºöËÆ°Âàí‰∏≠ÁöÑ‰ªªÂä°ÊéíÂú®ÂâçÈù¢ÔºåÁÑ∂ÂêéÊåâcompleteTime‰ªéËøëÂà∞ËøúÊéíÂ∫è
                    const sortedProjectTasks = projectTasks.sort((a, b) => {
                        // È¶ñÂÖàÊåâÁä∂ÊÄÅÊéíÂ∫èÔºöËÆ°Âàí‰∏≠ÁöÑ‰ªªÂä°Ôºàstatus === 0ÔºâÊéíÂú®ÊúÄÂâçÈù¢
                        if (a.status === 0 && b.status !== 0) return -1;
                        if (a.status !== 0 && b.status === 0) return 1;
                        
                        // Â¶ÇÊûúÈÉΩÊòØËÆ°Âàí‰∏≠Áä∂ÊÄÅÔºåÊåâcompleteTimeÊéíÂ∫èÔºàÊó•Êúü‰ªéËøëÂà∞ËøúÔºåÂç≥ÂçáÂ∫èÔºâ
                        if (a.status === 0 && b.status === 0) {
                            const aTime = a.completeTime ? new Date(a.completeTime).getTime() : Number.MAX_SAFE_INTEGER;
                            const bTime = b.completeTime ? new Date(b.completeTime).getTime() : Number.MAX_SAFE_INTEGER;
                            return aTime - bTime; // ÂçáÂ∫èÊéíÂàóÔºàÊó•Êúü‰ªéËøëÂà∞ËøúÔºâ
                        }
                        
                        // ÂÖ∂‰ªñÁä∂ÊÄÅÁöÑ‰ªªÂä°ÊåâÂéüÊúâÈÄªËæëÊéíÂ∫èÔºàÂ∑≤ÂÆåÊàê‰ªªÂä°Á≠âÔºâ
                        if (a.status !== 1 && b.status === 1) return -1;
                        if (a.status === 1 && b.status !== 1) return 1;
                        
                        // Â¶ÇÊûúÁä∂ÊÄÅÁõ∏Âêå‰∏îÈÉΩ‰∏çÊòØËÆ°Âàí‰∏≠Áä∂ÊÄÅÔºåÊåâcompleteTimeÊéíÂ∫èÔºàÊúÄÊñ∞ÁöÑÂú®ÂâçÈù¢Ôºâ
                        const aTime = a.completeTime ? new Date(a.completeTime).getTime() : 0;
                        const bTime = b.completeTime ? new Date(b.completeTime).getTime() : 0;
                        
                        // ÈôçÂ∫èÊéíÂàóÔºàÊúÄÊñ∞ÁöÑÂú®ÂâçÈù¢Ôºâ
                        return bTime - aTime;
                    });
                    
                    // Ê∏≤ÊüìËØ•È°πÁõÆÁöÑ‰ªªÂä°
                    sortedProjectTasks.forEach(task => {
                        const taskTag = document.createElement('div');
                        taskTag.className = 'related-task-tag';
                        taskTag.setAttribute('data-task-id', task.id);
                        taskTag.setAttribute('data-goal-id', goalId);
                        
                        // ÂàõÂª∫‰ªªÂä°Ê†áÁ≠æÂÜÖÂÆπÂÆπÂô®
                        const taskTagContent = document.createElement('div');
                        taskTagContent.className = 'task-tag-content';
                        
                        // ‰ªªÂä°ÂêçÁß∞
                        const taskName = document.createElement('div');
                        taskName.className = 'task-tag-name';
                        taskName.textContent = task.title || 'Êú™ÂëΩÂêç‰ªªÂä°';
                        taskName.title = task.title || 'Êú™ÂëΩÂêç‰ªªÂä°';
                        
                        // ‰ªªÂä°Áä∂ÊÄÅ
                        const taskStatus = document.createElement('div');
                        taskStatus.className = 'task-tag-status';
                        let statusText = 'Êú™ËÆ°Âàí';
                        let statusColor = '#6c757d';
                        
                        if (task.status === 1) {
                            statusText = 'Â∑≤ÂÆåÊàê';
                            statusColor = '#28a745';
                            // ‰∏∫Â∑≤ÂÆåÊàêÁä∂ÊÄÅÊ∑ªÂä†ÊâìÂãæÂõæÊ†á
                            taskStatus.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px; vertical-align: middle;"><polyline points="20,6 9,17 4,12"></polyline></svg>${statusText}`;
                        } else if (task.status === 0) {
                            statusText = 'ËÆ°Âàí‰∏≠';
                            statusColor = '#007bff';
                            taskStatus.textContent = statusText;
                        } else if (task.status === -1) {
                            statusText = 'Êú™ËÆ°Âàí';
                            statusColor = '#6c757d';
                            taskStatus.textContent = statusText;
                        }
                        
                        // Âè™ÊúâÈùûÂ∑≤ÂÆåÊàêÁä∂ÊÄÅÊâçËÆæÁΩÆtextContentÔºåÂ∑≤ÂÆåÊàêÁä∂ÊÄÅ‰ΩøÁî®innerHTML
                        if (task.status !== 1) {
                            taskStatus.textContent = statusText;
                        }
                        
                        taskStatus.style.color = statusColor;
                        taskStatus.style.fontSize = '12px';
                        taskStatus.style.fontWeight = 'bold';
                        taskStatus.style.marginTop = '4px';
                        taskStatus.style.display = 'flex';
                        taskStatus.style.alignItems = 'center';
                        
                        // ‰∏∫ËÆ°Âàí‰∏≠Áä∂ÊÄÅÁöÑ‰ªªÂä°Âç°Ê∑ªÂä†ÁôΩËâ≤ËÉåÊôØ
                        if (task.status === 0) {
                            taskTag.style.background = 'white';
                        }
                        
                        // ÂÆåÊàêÊó∂Èó¥Ôºà‰ªÖÂú®ÈùûÊú™ËÆ°ÂàíÁä∂ÊÄÅ‰∏ãÊòæÁ§∫Ôºâ
                        const taskCompleteTime = document.createElement('div');
                        taskCompleteTime.className = 'task-tag-complete-time';
                        
                        if (task.status !== -1 && task.completeTime) {
                            const completeDate = new Date(task.completeTime);
                            if (!isNaN(completeDate.getTime())) {
                                taskCompleteTime.textContent = completeDate.toLocaleDateString('zh-CN');
                                taskCompleteTime.style.fontSize = '11px';
                                taskCompleteTime.style.color = '#666';
                                taskCompleteTime.style.marginTop = '2px';
                            }
                        }
                        
                        // È°πÁõÆ‰ø°ÊÅØÔºàÂú®ÂàÜÁªÑÂêéÂèØ‰ª•ÈöêËóèÊàñÁÆÄÂåñÊòæÁ§∫Ôºâ
                        const taskProject = document.createElement('div');
                        taskProject.className = 'task-tag-project';
                        taskProject.textContent = task.project_name || 'Êú™Áü•È°πÁõÆ';
                        taskProject.title = task.project_name || 'Êú™Áü•È°πÁõÆ';
                        taskProject.style.display = 'none'; // ÈöêËóèÈ°πÁõÆ‰ø°ÊÅØÔºåÂõ†‰∏∫Â∑≤ÁªèÊúâÂàÜÁªÑÊ†áÈ¢ò
                        
                        // Âà†Èô§ÊåâÈíÆ
                        const removeBtn = document.createElement('button');
                        removeBtn.className = 'task-tag-remove';
                        removeBtn.innerHTML = `<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-trash"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>`;
                        removeBtn.title = 'ÂèñÊ∂àÂÖ≥ËÅî';
                        removeBtn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            removeTaskLink(goalId, task.id, taskTag);
                        });
                        
                        // ÂàõÂª∫‰∏äÂ±ÇÂÆπÂô®ÔºöÊ†áÈ¢òÂíåÂà†Èô§ÂõæÊ†á
                        const topContainer = document.createElement('div');
                        topContainer.className = 'task-tag-top';
                        topContainer.appendChild(taskName);
                        topContainer.appendChild(removeBtn);
                        
                        // ÂàõÂª∫‰∏ãÂ±ÇÂÆπÂô®ÔºöÁä∂ÊÄÅÂíåÂÆåÊàêÊó∂Èó¥
                        const bottomContainer = document.createElement('div');
                        bottomContainer.className = 'task-tag-bottom';
                        bottomContainer.appendChild(taskStatus);
                        if (task.status !== -1 && task.completeTime && taskCompleteTime.textContent) {
                            bottomContainer.appendChild(taskCompleteTime);
                        }
                        
                        // ÁªÑË£ÖÊ†áÁ≠æÂÜÖÂÆπ
                        taskTagContent.appendChild(topContainer);
                        taskTagContent.appendChild(bottomContainer);
                        taskTagContent.appendChild(taskProject);
                        taskTag.appendChild(taskTagContent);
                        
                        // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂ÔºàÂèØÈÄâÔºåÁî®‰∫éÂêéÁª≠ÂäüËÉΩÊâ©Â±ïÔºâ
                        taskTag.addEventListener('click', function() {
                            console.log('ÁÇπÂáª‰∫Ü‰ªªÂä°:', task.title, 'È°πÁõÆ:', task.project_name);
                            // ËøôÈáåÂèØ‰ª•Ê∑ªÂä†Ë∑≥ËΩ¨Âà∞‰ªªÂä°ËØ¶ÊÉÖÁöÑÈÄªËæë
                        });
                        
                        projectTasksContainer.appendChild(taskTag);
                    });
                    
                    relatedTasksDisplay.appendChild(projectTasksContainer);
                });
            }
        }

        // Âà†Èô§‰ªªÂä°ÂÖ≥ËÅî
        function removeTaskLink(goalId, taskId, taskElement) {
            if (!goalId || !taskId) {
                console.error('Âà†Èô§ÂÖ≥ËÅîÂ§±Ë¥•ÔºöÁõÆÊ†áIDÊàñ‰ªªÂä°ID‰∏∫Á©∫');
                return;
            }
            
            // Á°ÆËÆ§Âà†Èô§
            if (!confirm('Á°ÆÂÆöË¶ÅÂèñÊ∂àÊ≠§‰ªªÂä°‰∏éÁõÆÊ†áÁöÑÂÖ≥ËÅîÂêóÔºü')) {
                return;
            }
            
            try {
                // ‰ΩøÁî®goalTaskLinksManagerÂà†Èô§ÂÖ≥ËÅî
                const success = goalTaskLinksManager.deleteGoalTaskLink(goalId, taskId);
                
                if (success) {
                    // ÈáçÊñ∞Âä†ËΩΩÂÖ≥ËÅî‰ªªÂä°‰ª•Âà∑Êñ∞ËøõÂ∫¶ÊòæÁ§∫
                    loadRelatedTasks(goalId);
                    
                    console.log('ÊàêÂäüÂà†Èô§‰ªªÂä°ÂÖ≥ËÅî:', goalId, taskId);
                } else {
                    alert('Âà†Èô§ÂÖ≥ËÅîÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                }
            } catch (error) {
                console.error('Âà†Èô§‰ªªÂä°ÂÖ≥ËÅîÂ§±Ë¥•:', error);
                alert('Âà†Èô§ÂÖ≥ËÅîÂ§±Ë¥•Ôºö' + error.message);
            }
        }
        
        // Âà∑Êñ∞È°πÁõÆËøõÂ∫¶ÊòæÁ§∫Ôºà‰æõÂ§ñÈÉ®Ë∞ÉÁî®Ôºâ
        function refreshProjectProgress(goalId) {
            if (goalId) {
                loadRelatedTasks(goalId);
            }
        }
        
        // Â∞ÜÂà∑Êñ∞ÂáΩÊï∞Êö¥Èú≤Âà∞ÂÖ®Â±Ä‰ΩúÁî®Âüü
        window.refreshProjectProgress = refreshProjectProgress;
        
        // Âà†Èô§È°πÁõÆ‰∏ãÊâÄÊúâÂÖ≥ËÅîÁöÑÁõÆÊ†á-‰ªªÂä°ÂÖ≥ËÅî
        function deleteProjectAssociations(projectName, goalId) {
            console.log('=== ÂºÄÂßãÂà†Èô§È°πÁõÆÂÖ≥ËÅî ===');
            console.log('È°πÁõÆÂêçÁß∞:', projectName);
            console.log('ÁõÆÊ†áID:', goalId);
            
            if (!projectName || !goalId) {
                console.error('Âà†Èô§È°πÁõÆÂÖ≥ËÅîÂ§±Ë¥•ÔºöÈ°πÁõÆÂêçÁß∞ÊàñÁõÆÊ†áID‰∏∫Á©∫');
                alert('Âà†Èô§Â§±Ë¥•ÔºöÈ°πÁõÆÂêçÁß∞ÊàñÁõÆÊ†áID‰∏∫Á©∫');
                return;
            }
            
            try {
                // Ëé∑ÂèñÊâÄÊúâÁõÆÊ†á-‰ªªÂä°ÂÖ≥ËÅîÊï∞ÊçÆ
                const goalTaskLinks = JSON.parse(localStorage.getItem('gms_goal_task_links') || '[]');
                console.log('ÊâÄÊúâÂÖ≥ËÅîÊï∞ÊçÆÊÄªÊï∞:', goalTaskLinks.length);
                console.log('Ââç3Êù°ÂÖ≥ËÅîÊï∞ÊçÆÁ§∫‰æã:', goalTaskLinks.slice(0, 3));
                
                // Êü•ÊâæËØ•È°πÁõÆ‰∏ãÁöÑÊâÄÊúâÂÖ≥ËÅîËÆ∞ÂΩï - ‰ΩøÁî®Â§öÁßçÂåπÈÖçÊù°‰ª∂
                const projectLinks = goalTaskLinks.filter(link => {
                    // Ê£ÄÊü•Êï∞ÊçÆÁªìÊûÑ‰∏≠ÊòØÂê¶Êúâproject_nameÂ≠óÊÆµ
                    let projectMatch = false;
                    if (link.project_name) {
                        projectMatch = link.project_name === projectName;
                    } else {
                        // Â¶ÇÊûúÊ≤°Êúâproject_nameÂ≠óÊÆµÔºåÈÄöËøáproject_idÊü•ÊâæÈ°πÁõÆÂêçÁß∞
                        const projectsData = localStorage.getItem('projects');
                        const projects = projectsData ? JSON.parse(projectsData) : [];
                        const project = projects.find(p => p.id == link.project_id || String(p.id) === String(link.project_id));
                        projectMatch = project && project.name === projectName;
                    }
                    
                    const goalMatch = link.goal_id === goalId;
                    
                    console.log(`Ê£ÄÊü•ÂÖ≥ËÅîËÆ∞ÂΩï: project_name="${link.project_name || '(ÈÄöËøáproject_idÊü•Êâæ)'}", goal_id="${link.goal_id}", task_id="${link.task_id}", project_id="${link.project_id}"`);
                    console.log(`ÂåπÈÖçÁªìÊûú: projectMatch=${projectMatch}, goalMatch=${goalMatch}`);
                    
                    return projectMatch && goalMatch;
                });
                
                console.log(`ÊâæÂà∞ÂåπÈÖçÁöÑÂÖ≥ËÅîËÆ∞ÂΩïÊï∞Èáè: ${projectLinks.length}`);
                console.log('ÂåπÈÖçÁöÑÂÖ≥ËÅîËÆ∞ÂΩï:', projectLinks);
                
                if (projectLinks.length === 0) {
                    // Â∞ùËØïÂè™ÊåâÈ°πÁõÆÂêçÁß∞Êü•Êâæ
                    const projectOnlyLinks = goalTaskLinks.filter(link => {
                        if (link.project_name) {
                            return link.project_name === projectName;
                        } else {
                            const projectsData = localStorage.getItem('projects');
                            const projects = projectsData ? JSON.parse(projectsData) : [];
                            const project = projects.find(p => p.id == link.project_id || String(p.id) === String(link.project_id));
                            return project && project.name === projectName;
                        }
                    });
                    console.log(`‰ªÖÊåâÈ°πÁõÆÂêçÁß∞Êü•ÊâæÂà∞ÁöÑËÆ∞ÂΩïÊï∞Èáè: ${projectOnlyLinks.length}`);
                    console.log('‰ªÖÊåâÈ°πÁõÆÂêçÁß∞ÁöÑËÆ∞ÂΩï:', projectOnlyLinks);
                    
                    // Â∞ùËØïÂè™ÊåâÁõÆÊ†áIDÊü•Êâæ
                    const goalOnlyLinks = goalTaskLinks.filter(link => link.goal_id === goalId);
                    console.log(`‰ªÖÊåâÁõÆÊ†áIDÊü•ÊâæÂà∞ÁöÑËÆ∞ÂΩïÊï∞Èáè: ${goalOnlyLinks.length}`);
                    console.log('‰ªÖÊåâÁõÆÊ†áIDÁöÑËÆ∞ÂΩï:', goalOnlyLinks);
                    
                    // ÊòæÁ§∫ÊâÄÊúâÈ°πÁõÆÁöÑÂêçÁß∞‰ª•‰æøË∞ÉËØï
                    const projectsData = localStorage.getItem('projects');
                    const projects = projectsData ? JSON.parse(projectsData) : [];
                    const projectNames = projects.map(p => p.name);
                    console.log('ÊâÄÊúâÈ°πÁõÆÂêçÁß∞:', projectNames);
                    console.log('ÂΩìÂâçÊü•ÊâæÁöÑÈ°πÁõÆÂêçÁß∞:', projectName);
                    
                    alert(`ËØ•È°πÁõÆ"${projectName}"‰∏ãÊ≤°ÊúâÊâæÂà∞‰∏éÁõÆÊ†á"${goalId}"ÂÖ≥ËÅîÁöÑÂ≠ê‰ªªÂä°\n\nË∞ÉËØï‰ø°ÊÅØÔºö\n- ÊÄªÂÖ≥ËÅîËÆ∞ÂΩïÊï∞: ${goalTaskLinks.length}\n- È°πÁõÆÂåπÈÖçËÆ∞ÂΩïÊï∞: ${projectOnlyLinks.length}\n- ÁõÆÊ†áÂåπÈÖçËÆ∞ÂΩïÊï∞: ${goalOnlyLinks.length}\n- ÊâÄÊúâÈ°πÁõÆ: ${projectNames.join(', ')}`);
                    return;
                }
                
                // Á°ÆËÆ§Âà†Èô§
                if (!confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§È°πÁõÆ"${projectName}"‰∏ãÊâÄÊúâÂÖ≥ËÅîÁöÑÂ≠ê‰ªªÂä°ÂêóÔºü\n\nÊâæÂà∞ ${projectLinks.length} ‰∏™ÂÖ≥ËÅîËÆ∞ÂΩï\nÊ≠§Êìç‰ΩúÂ∞ÜÂèñÊ∂àËØ•È°πÁõÆ‰∏ãÊâÄÊúâÂ≠ê‰ªªÂä°‰∏éÁõÆÊ†áÁöÑÂÖ≥ËÅîÂÖ≥Á≥ªÔºå‰ΩÜ‰∏ç‰ºöÂà†Èô§‰ªªÂä°Êú¨Ë∫´„ÄÇ`)) {
                    return;
                }
                
                // Âà†Èô§ÊâÄÊúâÂåπÈÖçÁöÑÂÖ≥ËÅîËÆ∞ÂΩï
                let deletedCount = 0;
                projectLinks.forEach((link, index) => {
                    console.log(`Ê≠£Âú®Âà†Èô§Á¨¨ ${index + 1} ‰∏™ÂÖ≥ËÅî:`, link);
                    const success = goalTaskLinksManager.deleteGoalTaskLink(link.goal_id, link.task_id, link.project_id);
                    console.log(`Âà†Èô§ÁªìÊûú: ${success}`);
                    if (success) {
                        deletedCount++;
                    }
                });
                
                console.log(`Âà†Èô§Êìç‰ΩúÂÆåÊàêÔºåÊàêÂäüÂà†Èô§ ${deletedCount} ‰∏™ÂÖ≥ËÅî`);
                
                if (deletedCount > 0) {
                    // ÈáçÊñ∞Âä†ËΩΩÂÖ≥ËÅî‰ªªÂä°‰ª•Âà∑Êñ∞ÊòæÁ§∫
                    loadRelatedTasks(goalId);
                    
                    console.log(`ÊàêÂäüÂà†Èô§È°πÁõÆ"${projectName}"‰∏ã ${deletedCount} ‰∏™‰ªªÂä°ÂÖ≥ËÅî`);
                    alert(`ÊàêÂäüÂà†Èô§ ${deletedCount} ‰∏™‰ªªÂä°ÂÖ≥ËÅî`);
                    
                    // ‰∏çÂÜçÂà∑Êñ∞Êï¥‰∏™È°µÈù¢ÔºåÂè™Âà∑Êñ∞ÂÖ≥ËÅî‰ªªÂä°ÂÆπÂô®
                    console.log('Âà†Èô§ÊàêÂäüÔºåÂ∑≤Âà∑Êñ∞ÂÖ≥ËÅî‰ªªÂä°ÊòæÁ§∫');
                } else {
                    alert('Âà†Èô§ÂÖ≥ËÅîÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
                }
            } catch (error) {
                console.error('Âà†Èô§È°πÁõÆÂÖ≥ËÅîÂ§±Ë¥•:', error);
                alert('Âà†Èô§ÂÖ≥ËÅîÂ§±Ë¥•Ôºö' + error.message);
            }
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÊâßË°å
         document.addEventListener('DOMContentLoaded', function() {
             loadDimensionsData();
             
             // Âä†ËΩΩÁõÆÊ†áÂàóË°®
             loadGoalsToContainer();
             
             // Á´ãÂç≥Ê£ÄÊü•Âπ∂Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊï∞ÈáèÊòæÁ§∫
             const selectedGoalId = sessionStorage.getItem('selectedGoalId');
             if (selectedGoalId) {
                 console.log('DOMContentLoaded: Ê£ÄÊµãÂà∞ÈÄâ‰∏≠ÁöÑÁõÆÊ†áID:', selectedGoalId);
                 updateProgressRecordButtonCount(selectedGoalId);
             } else {
                 console.log('DOMContentLoaded: Ê≤°ÊúâÈÄâ‰∏≠ÁöÑÁõÆÊ†áÔºåËÆæÁΩÆËøõÂ±ïËÆ∞ÂΩïÊï∞Èáè‰∏∫0');
                 updateProgressRecordButtonCount(null);
             }
             
             // ÁªëÂÆöÊ∑ªÂä†ÈáåÁ®ãÁ¢ëÊåâÈíÆ‰∫ã‰ª∂
             document.getElementById('addMilestoneBtn').addEventListener('click', showAddMilestoneModal);
             
             // ÁªëÂÆöÊ∑ªÂä†ÁõÆÊ†áÊåâÈíÆ‰∫ã‰ª∂
             setTimeout(() => {
                 const addGoalBtn = document.getElementById('addGoalBtn');
                 console.log('ÁªëÂÆöÊ∑ªÂä†ÁõÆÊ†áÊåâÈíÆ‰∫ã‰ª∂ÔºåÊåâÈíÆÂÖÉÁ¥†:', addGoalBtn);
                 if (addGoalBtn) {
                     addGoalBtn.addEventListener('click', function() {
                         console.log('Ê∑ªÂä†ÁõÆÊ†áÊåâÈíÆË¢´ÁÇπÂáª‰∫ÜÔºÅ');
                         showAddGoalModal();
                     });
                     console.log('Ê∑ªÂä†ÁõÆÊ†áÊåâÈíÆ‰∫ã‰ª∂ÁªëÂÆöÊàêÂäüÔºÅ');
                 } else {
                     console.error('Êú™ÊâæÂà∞addGoalBtnÂÖÉÁ¥†ÔºÅ');
                 }
             }, 100);
             
             // È°µÈù¢Âä†ËΩΩÂêéÊÅ¢Â§çÈÄâ‰∏≠Áä∂ÊÄÅ
             setTimeout(() => {
                 console.log('=== ÂºÄÂßãÊÅ¢Â§çÁõÆÊ†áÈÄâ‰∏≠Áä∂ÊÄÅ ===');
                 const goalCards = document.querySelectorAll('.goal-card');
                 console.log('ÊâæÂà∞ÁõÆÊ†áÂç°ÁâáÊï∞Èáè:', goalCards.length);
                 
                 if (goalCards.length > 0) {
                     // ‰ªésessionStorageËé∑Âèñ‰∏äÊ¨°ÈÄâ‰∏≠ÁöÑÁõÆÊ†áID
                     const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                     console.log('sessionStorage‰∏≠‰øùÂ≠òÁöÑÁõÆÊ†áID:', selectedGoalId);
                     
                     if (selectedGoalId) {
                         // Êü•ÊâæÂØπÂ∫îÁöÑÁõÆÊ†áÂç°Áâá
                         const targetGoalCard = document.querySelector(`[data-goal-id="${selectedGoalId}"]`);
                         
                         if (targetGoalCard) {
                             console.log('ÊÅ¢Â§çÈÄâ‰∏≠Áä∂ÊÄÅÔºåÁõÆÊ†áID:', selectedGoalId);
                             
                             // ‰ªélocalStorageËé∑ÂèñÁõÆÊ†áÊï∞ÊçÆ
                             const goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
                             const goal = goals.find(g => g.goal_id === selectedGoalId);
                             
                             if (goal) {
                                 console.log('ÊâæÂà∞ÁõÆÊ†áÊï∞ÊçÆ:', goal);
                                 
                                 // ÁßªÈô§ÊâÄÊúâÁõÆÊ†áÂç°ÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
                                 document.querySelectorAll('.goal-card.selected').forEach(card => {
                                     card.classList.remove('selected');
                                 });
                                 
                                 // ÈÄâ‰∏≠ÁõÆÊ†áÂç°
                                 targetGoalCard.classList.add('selected');
                                 
                                 // ÊòæÁ§∫ÁõÆÊ†á‰ø°ÊÅØ
                                 displayGoalInRightPanel(goal);
                                 // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊï∞ÈáèÊòæÁ§∫
                                 updateProgressRecordButtonCount(selectedGoalId);
                             } else {
                                 console.log('ÁõÆÊ†áÊï∞ÊçÆ‰∏çÂ≠òÂú®ÔºåÊ∏ÖÈô§sessionStorageËÆ∞ÂΩï');
                                 sessionStorage.removeItem('selectedGoalId');
                             }
                         } else {
                             console.log('ÁõÆÊ†áÂç°Áâá‰∏çÂ≠òÂú®ÔºåÊ∏ÖÈô§sessionStorageËÆ∞ÂΩï');
                             sessionStorage.removeItem('selectedGoalId');
                         }
                     } else {
                         console.log('Ê≤°Êúâ‰øùÂ≠òÁöÑÈÄâ‰∏≠Áä∂ÊÄÅÔºå‰∏çËá™Âä®ÈÄâ‰∏≠‰ªª‰ΩïÁõÆÊ†á');
                     }
                 } else {
                     console.log('Êú™ÊâæÂà∞ÁõÆÊ†áÂç°Áâá');
                 }
             }, 500);
             
             // ÁªëÂÆöÁºñËæëÊåâÈíÆ‰∫ã‰ª∂Ôºà‰ΩøÁî®‰∫ã‰ª∂ÂßîÊâòÔºâ
             document.addEventListener('click', function(e) {
                 if (e.target.closest('.edit-btn')) {
                     const milestoneItem = e.target.closest('.milestone-item');
                     if (milestoneItem) {
                         const milestoneId = milestoneItem.getAttribute('data-milestone-id');
                         showEditMilestoneModal(milestoneId);
                     }
                 }
                 
                 // ÁªëÂÆöÂà†Èô§ÊåâÈíÆ‰∫ã‰ª∂
                 if (e.target.closest('.delete-btn')) {
                     const milestoneItem = e.target.closest('.milestone-item');
                     if (milestoneItem) {
                         const milestoneId = milestoneItem.getAttribute('data-milestone-id');
                         deleteMilestone(milestoneId);
                     }
                 }
             });
             
             // ÁªëÂÆöÁºñËæëÈáåÁ®ãÁ¢ëÂºπÁ™óÂÖ≥Èó≠‰∫ã‰ª∂
             document.getElementById('editMilestoneModalClose').addEventListener('click', function() {
                 document.getElementById('editMilestoneModal').style.display = 'none';
             });
             
             document.getElementById('editMilestoneCancel').addEventListener('click', function() {
                 document.getElementById('editMilestoneModal').style.display = 'none';
             });
             
             // ÁªëÂÆöÁºñËæëÈáåÁ®ãÁ¢ë‰øùÂ≠òÊåâÈíÆ‰∫ã‰ª∂
             document.getElementById('editMilestoneSave').addEventListener('click', saveEditedMilestone);
             
             // ÁÇπÂáªÁºñËæëÈáåÁ®ãÁ¢ëÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
             document.getElementById('editMilestoneModal').addEventListener('click', function(e) {
                 if (e.target === this) {
                     this.style.display = 'none';
                 }
             });
             
             // ÁªëÂÆöÊñ∞Â¢ûÈáåÁ®ãÁ¢ëÂºπÁ™óÂÖ≥Èó≠‰∫ã‰ª∂
             document.getElementById('addMilestoneModalClose').addEventListener('click', function() {
                 document.getElementById('addMilestoneModal').style.display = 'none';
             });
             
             document.getElementById('addMilestoneCancel').addEventListener('click', function() {
                 document.getElementById('addMilestoneModal').style.display = 'none';
             });
             
             // ÁªëÂÆöÊñ∞Â¢ûÈáåÁ®ãÁ¢ë‰øùÂ≠òÊåâÈíÆ‰∫ã‰ª∂
             document.getElementById('addMilestoneSave').addEventListener('click', saveAddMilestone);
             
             // ÁÇπÂáªÊñ∞Â¢ûÈáåÁ®ãÁ¢ëÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
             document.getElementById('addMilestoneModal').addEventListener('click', function(e) {
                 if (e.target === this) {
                     this.style.display = 'none';
                 }
             });
             
             // ÁªëÂÆöÊ∑ªÂä†ÁõÆÊ†áÂºπÁ™óÂÖ≥Èó≠‰∫ã‰ª∂
             document.getElementById('addGoalModalClose').addEventListener('click', function() {
                 document.getElementById('addGoalModal').style.display = 'none';
             });
             
             document.getElementById('addGoalCancel').addEventListener('click', function() {
                 document.getElementById('addGoalModal').style.display = 'none';
             });
             
             // ÁªëÂÆöÊ∑ªÂä†ÁõÆÊ†á‰øùÂ≠òÊåâÈíÆ‰∫ã‰ª∂
             document.getElementById('addGoalSave').addEventListener('click', saveAddGoal);
             
             // ÁÇπÂáªÊ∑ªÂä†ÁõÆÊ†áÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠ÂºπÁ™ó
             document.getElementById('addGoalModal').addEventListener('click', function(e) {
                 if (e.target === this) {
                     this.style.display = 'none';
                 }
             });
             
             // ÁªëÂÆöÈáåÁ®ãÁ¢ëÊêúÁ¥¢ÂäüËÉΩ
             const milestoneSearchIcon = document.getElementById('milestoneSearchIcon');
             const milestoneTitle = document.getElementById('milestoneTitle');
             const milestoneSearchContainer = document.getElementById('milestoneSearchContainer');
             const milestoneSearchInput = document.getElementById('milestoneSearchInput');
             const milestoneSearchClose = document.getElementById('milestoneSearchClose');
             
             // ÁÇπÂáªÊêúÁ¥¢ÂõæÊ†áÊòæÁ§∫ÊêúÁ¥¢Ê°Ü
             milestoneSearchIcon.addEventListener('click', function() {
                 milestoneTitle.style.display = 'none';
                 milestoneSearchIcon.style.display = 'none';
                 milestoneSearchContainer.style.display = 'flex';
                 milestoneSearchInput.focus();
             });
             
             // ÁÇπÂáªÂÖ≥Èó≠ÊåâÈíÆÊÅ¢Â§çÊ†áÈ¢òÊòæÁ§∫
             milestoneSearchClose.addEventListener('click', function() {
                 milestoneTitle.style.display = 'block';
                 milestoneSearchIcon.style.display = 'block';
                 milestoneSearchContainer.style.display = 'none';
                 milestoneSearchInput.value = '';
                 // ÊÅ¢Â§çÊâÄÊúâÈáåÁ®ãÁ¢ëÊòæÁ§∫
                 filterMilestones('');
             });
             
             // ÊêúÁ¥¢Ê°ÜËæìÂÖ•‰∫ã‰ª∂
             milestoneSearchInput.addEventListener('input', function() {
                 const searchTerm = this.value.toLowerCase().trim();
                 filterMilestones(searchTerm);
             });
             
             // ÊåâESCÈîÆÂÖ≥Èó≠ÊêúÁ¥¢ÔºåÊåâÂõûËΩ¶ÈîÆÊêúÁ¥¢
             milestoneSearchInput.addEventListener('keydown', function(e) {
                 if (e.key === 'Escape') {
                     milestoneSearchClose.click();
                 } else if (e.key === 'Enter') {
                     // ÂõûËΩ¶ÈîÆËß¶ÂèëÊêúÁ¥¢ÔºàÂÆûÈôÖ‰∏äinput‰∫ã‰ª∂Â∑≤ÁªèÂ§ÑÁêÜ‰∫ÜÂÆûÊó∂ÊêúÁ¥¢Ôºâ
                     const searchTerm = this.value.toLowerCase().trim();
                     filterMilestones(searchTerm);
                 }
             });
             
             // ÁªëÂÆö'+ÂÖ≥ËÅî‰ªªÂä°'ÊåâÈíÆ‰∫ã‰ª∂
             const addRelatedTaskBtn = document.getElementById('addRelatedTaskBtn');
             if (addRelatedTaskBtn) {
                 addRelatedTaskBtn.addEventListener('click', function() {
                     console.log('ÁÇπÂáª‰∫Ü+ÂÖ≥ËÅî‰ªªÂä°ÊåâÈíÆ');
                     
                     // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†á
                     const selectedGoalCard = document.querySelector('.goal-card.selected');
                     if (!selectedGoalCard) {
                         alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†á');
                         return;
                     }
                     
                     const goalId = selectedGoalCard.dataset.goalId;
                     console.log('ÂΩìÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†áID:', goalId);
                     
                     // ÊâìÂºÄÂÖ≥ËÅî‰ªªÂä°ÂºπÁ™óÂπ∂‰º†ÈÄíÁõÆÊ†áID
                     if (window.linkTaskModal) {
                         window.linkTaskModal.open(goalId);
                     }
                 });
             }
             
             // ÁªëÂÆö'ËøõÂ±ïËÆ∞ÂΩï'ÊåâÈíÆ‰∫ã‰ª∂
             const progressRecordBtn = document.getElementById('progressRecordBtn');
             if (progressRecordBtn) {
                 progressRecordBtn.addEventListener('click', function() {
                     console.log('ÁÇπÂáª‰∫ÜËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆ');
                     
                     // Ê£ÄÊü•ÊåâÈíÆÊòØÂê¶Â∑≤ÁªèÂ§Ñ‰∫éactiveÁä∂ÊÄÅ
                     if (progressRecordBtn.classList.contains('active')) {
                         // Â¶ÇÊûúÂ∑≤ÁªèÊòØactiveÁä∂ÊÄÅÔºåÂàôÂèñÊ∂àÊøÄÊ¥ªÂπ∂ÈöêËóèÈù¢Êùø
                         console.log('ÊåâÈíÆÂ∑≤ÊøÄÊ¥ªÔºåÊâßË°åËøîÂõûÊìç‰Ωú');
                         
                         // Ëé∑ÂèñÈù¢ÊùøÂÆπÂô®
                         const panelSection2 = document.querySelector('.panel-section.panel-section-2:not(.panel-section-record)');
                         const panelSectionRecord = document.querySelector('.panel-section.panel-section-2.panel-section-record');
                         
                         if (panelSection2 && panelSectionRecord) {
                             // ÈöêËóèËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÔºåÊòæÁ§∫ÂéüÈù¢Êùø
                             panelSectionRecord.style.display = 'none';
                             panelSection2.style.display = 'block';
                             
                             // ÁßªÈô§ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÁöÑÊøÄÊ¥ªÁä∂ÊÄÅÊ†∑Âºè
                             progressRecordBtn.classList.remove('active');
                             
                             // ÈöêËóèËøîÂõûÊåâÈíÆ
                             const backToTasksBtn = document.getElementById('backToTasksBtn');
                             if (backToTasksBtn) {
                                 backToTasksBtn.style.display = 'none';
                             }
                             
                             // Ê∑ªÂä†Ê∑°ÂÖ•ÊïàÊûú
                             panelSection2.style.opacity = '0';
                             setTimeout(() => {
                                 panelSection2.style.opacity = '1';
                             }, 10);
                         }
                         return;
                     }
                     
                     // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†áID
                     const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                     if (!selectedGoalId) {
                         alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†á');
                         return;
                     }
                     
                     // Ëé∑ÂèñÈù¢ÊùøÂÆπÂô®
                     const panelSection2 = document.querySelector('.panel-section.panel-section-2:not(.panel-section-record)');
                     const panelSectionRecord = document.querySelector('.panel-section.panel-section-2.panel-section-record');
                     
                     if (panelSection2 && panelSectionRecord) {
                         // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÈù¢Êùø‰∏≠ÁöÑÁõÆÊ†áÊèèËø∞
                         updateProgressRecordGoalDescription();
                         
                         // Âä†ËΩΩÂΩìÂâçÁõÆÊ†áÁöÑËøõÂ±ïËÆ∞ÂΩïÊï∞ÊçÆ
                         loadProgressRecords(selectedGoalId);
                         
                         // ÈöêËóèÂéüÈù¢ÊùøÔºåÊòæÁ§∫ËøõÂ±ïËÆ∞ÂΩïÈù¢Êùø
                         panelSection2.style.display = 'none';
                         panelSectionRecord.style.display = 'block';
                         
                         // ‰∏∫ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊ∑ªÂä†ÊøÄÊ¥ªÁä∂ÊÄÅÊ†∑Âºè
                         progressRecordBtn.classList.add('active');
                         
                         // ÊòæÁ§∫ËøîÂõûÊåâÈíÆ
                         const backToTasksBtn = document.getElementById('backToTasksBtn');
                         if (backToTasksBtn) {
                             backToTasksBtn.style.display = 'block';
                         }
                         
                         // Ê∑ªÂä†Ê∑°ÂÖ•ÊïàÊûú
                         panelSectionRecord.style.opacity = '0';
                         setTimeout(() => {
                             panelSectionRecord.style.opacity = '1';
                         }, 10);
                     }
                 });
             }
             
             // ÁªëÂÆö'ËøîÂõû‰ªªÂä°'ÊåâÈíÆ‰∫ã‰ª∂
             const backToTasksBtn = document.getElementById('backToTasksBtn');
             if (backToTasksBtn) {
                 backToTasksBtn.addEventListener('click', function() {
                     console.log('ÁÇπÂáª‰∫ÜËøîÂõû‰ªªÂä°ÊåâÈíÆ');
                     
                     // Ëé∑ÂèñÈù¢ÊùøÂÆπÂô®
                     const panelSection2 = document.querySelector('.panel-section.panel-section-2:not(.panel-section-record)');
                     const panelSectionRecord = document.querySelector('.panel-section.panel-section-2.panel-section-record');
                     
                     if (panelSection2 && panelSectionRecord) {
                         // ÈöêËóèËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÔºåÊòæÁ§∫ÂéüÈù¢Êùø
                         panelSectionRecord.style.display = 'none';
                         panelSection2.style.display = 'block';
                         
                         // ÁßªÈô§ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÁöÑÊøÄÊ¥ªÁä∂ÊÄÅÊ†∑Âºè
                         const progressRecordBtn = document.getElementById('progressRecordBtn');
                         if (progressRecordBtn) {
                             progressRecordBtn.classList.remove('active');
                         }
                         
                         // ÈöêËóèËøîÂõûÊåâÈíÆ
                         const backToTasksBtn = document.getElementById('backToTasksBtn');
                         if (backToTasksBtn) {
                             backToTasksBtn.style.display = 'none';
                         }
                         
                         // Ê∑ªÂä†Ê∑°ÂÖ•ÊïàÊûú
                         panelSection2.style.opacity = '0';
                         setTimeout(() => {
                             panelSection2.style.opacity = '1';
                         }, 10);
                     }
                 });
             }
             
             // ÁªëÂÆöÁé∞‰ª£ÂåñÊêúÁ¥¢ÂäüËÉΩ
             const searchIconWrapper = document.getElementById('searchIconWrapper');
             const searchInputContainer = document.getElementById('searchInputContainer');
             const modernSearchInput = document.getElementById('modernSearchInput');
             const searchClearBtn = document.getElementById('searchClearBtn');
             const searchCloseBtn = document.getElementById('searchCloseBtn');
             const goalTitle = document.getElementById('goalTitle');
             const titleSearchWrapper = document.querySelector('.title-search-wrapper');
             
             let isSearchActive = false;
             
             // ÁÇπÂáªÊêúÁ¥¢ÂõæÊ†áÂ±ïÂºÄÊêúÁ¥¢Ê°Ü
             searchIconWrapper.addEventListener('click', function() {
                 if (!isSearchActive) {
                     isSearchActive = true;
                     
                     // ÈöêËóèÊ†áÈ¢òÂíåÊêúÁ¥¢ÂõæÊ†áÔºåÊòæÁ§∫ÊêúÁ¥¢Ê°Ü
                     titleSearchWrapper.classList.add('search-active');
                     searchInputContainer.classList.add('active');
                     searchIconWrapper.classList.add('active');
                     
                     // Âª∂ËøüËÅöÁÑ¶ÔºåÁ≠âÂæÖÂä®ÁîªÂÆåÊàê
                     setTimeout(() => {
                         modernSearchInput.focus();
                     }, 300);
                 }
             });
             
             // ÁÇπÂáªÂÖ≥Èó≠ÊåâÈíÆ
             searchCloseBtn.addEventListener('click', function() {
                 closeSearch();
             });
             
             // ÁÇπÂáªÊ∏ÖÈô§ÊåâÈíÆ
             searchClearBtn.addEventListener('click', function() {
                 modernSearchInput.value = '';
                 modernSearchInput.focus();
                 loadGoalsToContainer(); // ÊÅ¢Â§çÊâÄÊúâÁõÆÊ†áÊòæÁ§∫
             });
             
             // ÊêúÁ¥¢Ê°ÜËæìÂÖ•‰∫ã‰ª∂
             modernSearchInput.addEventListener('input', function() {
                 const searchTerm = this.value.toLowerCase().trim();
                 filterGoals(searchTerm);
             });
             
             // ÈîÆÁõò‰∫ã‰ª∂Â§ÑÁêÜ
             modernSearchInput.addEventListener('keydown', function(e) {
                 if (e.key === 'Escape') {
                     closeSearch();
                 } else if (e.key === 'Enter') {
                     const searchTerm = this.value.toLowerCase().trim();
                     filterGoals(searchTerm);
                 }
             });
             
             // ÁßªÈô§ÁÇπÂáªÊêúÁ¥¢Ê°ÜÂ§ñÈÉ®ÂÖ≥Èó≠ÊêúÁ¥¢ÁöÑÂäüËÉΩ
             // Áé∞Âú®Âè™ËÉΩÈÄöËøáÁÇπÂáªÂÖ≥Èó≠ÊåâÈíÆÊù•ÂÖ≥Èó≠ÊêúÁ¥¢Ê°Ü
             
             // ÂÖ≥Èó≠ÊêúÁ¥¢ÂäüËÉΩ
             function closeSearch() {
                 isSearchActive = false;
                 
                 // ÊÅ¢Â§çÊ†áÈ¢òÂíåÊêúÁ¥¢ÂõæÊ†áÊòæÁ§∫ÔºåÈöêËóèÊêúÁ¥¢Ê°Ü
                 titleSearchWrapper.classList.remove('search-active');
                 searchInputContainer.classList.remove('active');
                 searchIconWrapper.classList.remove('active');
                 modernSearchInput.value = '';
                 loadGoalsToContainer(); // ÊÅ¢Â§çÊâÄÊúâÁõÆÊ†áÊòæÁ§∫
             }
             
             // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÈù¢Êùø‰∏≠ÁöÑÁõÆÊ†áÊèèËø∞
             function updateProgressRecordGoalDescription() {
                 const recordGoalDescription = document.getElementById('recordGoalDescription');
                 if (!recordGoalDescription) {
                     console.error('Êú™ÊâæÂà∞recordGoalDescriptionÂÆπÂô®');
                     return;
                 }
                 
                 // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†áID
                 const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                 if (!selectedGoalId) {
                     recordGoalDescription.innerHTML = '<p class="placeholder-text">ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†áÊü•ÁúãÊèèËø∞</p>';
                     return;
                 }
                 
                 // ‰ªélocalStorageËé∑ÂèñÂæÆËßÇÁõÆÊ†áÊï∞ÊçÆ
                 const goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
                 const goal = goals.find(g => g.goal_id === selectedGoalId);
                 
                 if (!goal) {
                     recordGoalDescription.innerHTML = '<p class="placeholder-text">ÁõÆÊ†á‰∏çÂ≠òÂú®ÊàñÂ∑≤Ë¢´Âà†Èô§</p>';
                     return;
                 }
                 
                 // ÊòæÁ§∫ÁõÆÊ†áÊèèËø∞
                 if (goal.description && goal.description.trim()) {
                     recordGoalDescription.innerHTML = `<p class="goal-description-text"><span style="color: black; font-weight: bold;">ÁõÆÊ†áÊèèËø∞Ôºö</span>${goal.description}</p>`;
                 } else {
                     recordGoalDescription.innerHTML = '<p class="placeholder-text">ËØ•ÁõÆÊ†áÊöÇÊó†ÊèèËø∞</p>';
                 }
             }
             
             // ÁõÆÊ†áÊèèËø∞ÁºñËæëÂäüËÉΩÂ∑≤ÁßªÈô§ - ÂæÖÂºÄÂèë
             
             // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫ÈªòËÆ§ÊèêÁ§∫ÊñáÂ≠ó
             showDefaultHint();
             
             // ÂàùÂßãÂåñÂÖ≥ËÅî‰ªªÂä°ÂºπÁ™ó
             window.linkTaskModal = new LinkTaskModal();
             
             // ÁõÆÊ†áÊèèËø∞ÁºñËæëÂäüËÉΩÂ∑≤ÁßªÈô§
             
             // ÁßªÈô§‰∫ÜÁÇπÂáªÁ©∫ÁôΩÂå∫ÂüüÂèñÊ∂àÁõÆÊ†áÈÄâÊã©ÁöÑÂäüËÉΩ
             // Áé∞Âú®ÁõÆÊ†áÂç°Âè™ËÉΩÈÄöËøáÁÇπÂáªÂÖ∂‰ªñÁõÆÊ†áÂç°Êù•ÂàáÊç¢ÈÄâ‰∏≠Áä∂ÊÄÅ
             
             // ÁªëÂÆöËøõÂ±ïËÆ∞ÂΩïÂÆπÂô®ÁÇπÂáª‰∫ã‰ª∂
             const progressRecordsSection = document.querySelector('.progress-records-section');
             const progressPlaceholderText = document.getElementById('progressPlaceholderText');
             const progressInputForm = document.getElementById('progressInputForm');
             const progressCancelBtn = document.getElementById('progressCancelBtn');
             const progressSubmitBtn = document.getElementById('progressSubmitBtn');
             
             // ÁªëÂÆöÂ∑•ÂÖ∑Ê†èÊåâÈíÆ‰∫ã‰ª∂
             const toolbarButtons = document.querySelectorAll('.toolbar-btn');
             const progressEditor = document.getElementById('progressContent');
             
             if (toolbarButtons && progressEditor) {
                 toolbarButtons.forEach((btn, index) => {
                     btn.addEventListener('click', function(e) {
                         e.preventDefault();
                         e.stopPropagation();
                         
                         // Á°Æ‰øùÁºñËæëÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
                         progressEditor.focus();
                         
                         switch(index) {
                             case 0: // B - Âä†Á≤ó
                                 document.execCommand('bold', false, null);
                                 break;
                             case 1: // S - Êñú‰Ωì
                                 document.execCommand('italic', false, null);
                                 break;
                             case 2: // A - ‰∏ãÂàíÁ∫ø
                                 document.execCommand('underline', false, null);
                                 break;
                             case 3: // ‚â° - Êó†Â∫èÂàóË°®
                                 document.execCommand('insertUnorderedList', false, null);
                                 break;
                             case 4: // ‚ãÆ‚ãÆ‚ãÆ - ÂàÜÂâ≤Á∫ø
                                 document.execCommand('insertHTML', false, '<hr>');
                                 break;
                             case 5: // üîó - ÈìæÊé•
                                 const selection = window.getSelection();
                                 const selectedText = selection.toString();
                                 const linkText = selectedText || 'ÈìæÊé•ÊñáÊú¨';
                                 const url = prompt('ËØ∑ËæìÂÖ•ÈìæÊé•Âú∞ÂùÄ:', 'https://');
                                 if (url) {
                                     if (selectedText) {
                                         document.execCommand('createLink', false, url);
                                     } else {
                                         document.execCommand('insertHTML', false, `<a href="${url}">${linkText}</a>`);
                                     }
                                 }
                                 break;
                             case 6: // ‚òë - Â§çÈÄâÊ°Ü
                                 const selection2 = window.getSelection();
                                 const selectedText2 = selection2.toString();
                                 const checkboxText = selectedText2 || 'ÂæÖÂäû‰∫ãÈ°π';
                                 document.execCommand('insertHTML', false, `<div><input type="checkbox"> ${checkboxText}</div>`);
                                 break;
                         }
                         
                         // ‰øùÊåÅÁºñËæëÂô®ÁÑ¶ÁÇπ
                         progressEditor.focus();
                     });
                 });
             }
             
             // ÁªëÂÆöÈ¢úËâ≤ÈÄâÊã©Âô®‰∫ã‰ª∂
             const colorPickerBtn = document.getElementById('colorPickerBtn');
             const colorPicker = document.getElementById('colorPicker');
             
             if (colorPickerBtn && colorPicker && progressEditor) {
                 // ÁÇπÂáªÈ¢úËâ≤ÊåâÈíÆÊó∂Ëß¶ÂèëÈ¢úËâ≤ÈÄâÊã©Âô®
                 colorPickerBtn.addEventListener('click', function(e) {
                     e.preventDefault();
                     e.stopPropagation();
                     colorPicker.click();
                 });
                 
                 // È¢úËâ≤ÈÄâÊã©Âô®ÂèòÂåñ‰∫ã‰ª∂
                 colorPicker.addEventListener('change', function(e) {
                     const selectedColor = e.target.value;
                     
                     // Á°Æ‰øùÁºñËæëÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
                     progressEditor.focus();
                     
                     // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñáÊú¨
                     const selection = window.getSelection();
                     const selectedText = selection.toString();
                     
                     if (selectedText) {
                         // Â¶ÇÊûúÊúâÈÄâ‰∏≠ÊñáÊú¨ÔºåÊîπÂèòÂÖ∂È¢úËâ≤
                         document.execCommand('foreColor', false, selectedColor);
                     } else {
                         // Â¶ÇÊûúÊ≤°ÊúâÈÄâ‰∏≠ÊñáÊú¨ÔºåÊèíÂÖ•Â∏¶È¢úËâ≤ÁöÑÁ§∫‰æãÊñáÊú¨
                         document.execCommand('insertHTML', false, `<span style="color: ${selectedColor};">ÂΩ©Ëâ≤ÊñáÊú¨</span>`);
                     }
                     
                     // ‰øùÊåÅÁºñËæëÂô®ÁÑ¶ÁÇπ
                     progressEditor.focus();
                 });
             }
             
             if (progressRecordsSection && progressPlaceholderText && progressInputForm) {
                 // ÁÇπÂáªÂÆπÂô®ÊòæÁ§∫ËæìÂÖ•Ë°®Âçï
                 progressRecordsSection.addEventListener('click', function(e) {
                     // Â¶ÇÊûúÁÇπÂáªÁöÑÊòØË°®ÂçïÂÜÖÈÉ®ÂÖÉÁ¥†Ôºå‰∏çÂ§ÑÁêÜ
                     if (progressInputForm.contains(e.target) && !progressPlaceholderText.contains(e.target)) {
                         return;
                     }
                     
                     // ÈöêËóèÊèêÁ§∫ÊñáÊú¨ÔºåÊòæÁ§∫ËæìÂÖ•Ë°®Âçï
                     progressPlaceholderText.style.display = 'none';
                     progressInputForm.style.display = 'block';
                     
                     // Ê∑ªÂä†ÊøÄÊ¥ªÁä∂ÊÄÅÊ†∑ÂºèÁ±ª
                     progressRecordsSection.classList.add('active');
                     
                     // ËÅöÁÑ¶Âà∞Á¨¨‰∏Ä‰∏™ËæìÂÖ•Ê°Ü
                     const firstSelect = progressInputForm.querySelector('.progress-select');
                     if (firstSelect) {
                         firstSelect.focus();
                     }
                 });
                 
                 // ÂèñÊ∂àÊåâÈíÆ‰∫ã‰ª∂
                 if (progressCancelBtn) {
                     progressCancelBtn.addEventListener('click', function(e) {
                         e.stopPropagation();
                         // ÈöêËóèËæìÂÖ•Ë°®ÂçïÔºåÊòæÁ§∫ÊèêÁ§∫ÊñáÊú¨
                         progressInputForm.style.display = 'none';
                         progressPlaceholderText.style.display = 'block';
                         
                         // ÁßªÈô§ÊøÄÊ¥ªÁä∂ÊÄÅÊ†∑ÂºèÁ±ª
                         progressRecordsSection.classList.remove('active');
                         
                         // Ê∏ÖÁ©∫Ë°®Âçï
                         const statusSelect = document.getElementById('progressStatus');
                         const expectationSelect = document.getElementById('progressExpectation');
                         const contentTextarea = document.getElementById('progressContent');
                         
                         if (statusSelect) statusSelect.value = '';
                         if (expectationSelect) expectationSelect.value = '';
                         if (contentTextarea) contentTextarea.value = '';
                     });
                 }
                 
                 // ÂèëÂ∏ÉÊåâÈíÆ‰∫ã‰ª∂
                 if (progressSubmitBtn) {
                     progressSubmitBtn.addEventListener('click', function(e) {
                         e.stopPropagation();
                         
                         // Ëé∑ÂèñË°®ÂçïÊï∞ÊçÆ
                         const statusSelect = document.getElementById('progressStatus');
                         const expectationSelect = document.getElementById('progressExpectation');
                         const contentEditor = document.getElementById('progressContent');
                         
                         const status = statusSelect ? statusSelect.value : '';
                         const expectation = expectationSelect ? expectationSelect.value : '';
                         const content = contentEditor ? contentEditor.innerHTML.trim() : '';
                         
                         // È™åËØÅÂøÖÂ°´Â≠óÊÆµ
                         if (!status || !expectation || !content) {
                             alert('ËØ∑Â°´ÂÜôÂÆåÊï¥ÁöÑËøõÂ±ï‰ø°ÊÅØ');
                             return;
                         }
                         
                         // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†áID
                         const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                         if (!selectedGoalId) {
                             alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†á');
                             return;
                         }
                         
                         // ÂàõÂª∫ËøõÂ±ïËÆ∞ÂΩïÊï∞ÊçÆ
                         const progressRecord = {
                             record_id: 'record_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                             goal_id: selectedGoalId,
                             status: status,
                             expectation: expectation,
                             content: content,
                             created_at: new Date().toISOString(),
                             updated_at: new Date().toISOString()
                         };
                         
                         // ‰øùÂ≠òÂà∞localStorageÔºàÊ®°ÊãüÊï∞ÊçÆÂ∫ìÂ≠òÂÇ®Ôºâ
                         const existingRecords = JSON.parse(localStorage.getItem('objective_records') || '[]');
                         existingRecords.push(progressRecord);
                         localStorage.setItem('objective_records', JSON.stringify(existingRecords));
                         
                         console.log('ËøõÂ±ïËÆ∞ÂΩïÂ∑≤‰øùÂ≠ò:', progressRecord);
                         
                         // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
                         alert('ËøõÂ±ïËÆ∞ÂΩïÂèëÂ∏ÉÊàêÂäüÔºÅ');
                         
                         // ÈöêËóèËæìÂÖ•Ë°®ÂçïÔºåÊòæÁ§∫ÊèêÁ§∫ÊñáÊú¨
                         progressInputForm.style.display = 'none';
                         progressPlaceholderText.style.display = 'block';
                         
                         // ÁßªÈô§ÊøÄÊ¥ªÁä∂ÊÄÅÊ†∑ÂºèÁ±ª
                         progressRecordsSection.classList.remove('active');
                         
                         // Ê∏ÖÁ©∫Ë°®Âçï
                         if (statusSelect) statusSelect.value = '';
                         if (expectationSelect) expectationSelect.value = '';
                         if (contentEditor) contentEditor.innerHTML = '';
                         
                         // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊï∞ÈáèÊòæÁ§∫
                         updateProgressRecordButtonCount(selectedGoalId);
                         // Âà∑Êñ∞ËøõÂ±ïËÆ∞ÂΩïÂ±ïÁ§∫
                         loadProgressRecords(selectedGoalId);
                     });
                 }
             }
             

             
             // Âä†ËΩΩËøõÂ±ïËÆ∞ÂΩïÂ±ïÁ§∫ÂäüËÉΩ
             function loadProgressRecords(goalId) {
                 const recordsList = document.getElementById('progressRecordsList');
                 if (!recordsList) {
                     console.error('Êú™ÊâæÂà∞progressRecordsListÂÆπÂô®');
                     return;
                 }
                 
                 if (!goalId) {
                     // Ê≤°ÊúâÈÄâ‰∏≠ÁõÆÊ†áÊó∂ÊòæÁ§∫Á©∫Áä∂ÊÄÅ
                     recordsList.innerHTML = '<div class="records-empty">ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ÁõÆÊ†áÊü•ÁúãËøõÂ±ïËÆ∞ÂΩï</div>';
                     return;
                 }
                 
                 // ‰ªélocalStorageËé∑ÂèñËøõÂ±ïËÆ∞ÂΩïÊï∞ÊçÆ
                 const allRecords = JSON.parse(localStorage.getItem('objective_records') || '[]');
                 
                 // Á≠õÈÄâÂΩìÂâçÁõÆÊ†áÁöÑËÆ∞ÂΩï
                 const goalRecords = allRecords.filter(record => record.goal_id === goalId);
                 
                 if (goalRecords.length === 0) {
                     recordsList.innerHTML = '<div class="records-empty">ËØ•ÁõÆÊ†áÊöÇÊó†ËøõÂ±ïËÆ∞ÂΩï</div>';
                     return;
                 }
                 
                 // ÊåâÂàõÂª∫Êó∂Èó¥ÂÄíÂ∫èÊéíÂàó
                 goalRecords.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                 
                 // ÁîüÊàêËÆ∞ÂΩïÂàóË°®HTML
                 let recordsHTML = '';
                 goalRecords.forEach((record, index) => {
                     const recordNumber = String(goalRecords.length - index).padStart(2, '0');
                     const createdDate = new Date(record.created_at).toLocaleDateString('zh-CN', {
                         month: '2-digit',
                         day: '2-digit',
                         hour: '2-digit',
                         minute: '2-digit'
                     });
                     const updatedDate = new Date(record.updated_at).toLocaleDateString('zh-CN', {
                         month: '2-digit',
                         day: '2-digit',
                         hour: '2-digit',
                         minute: '2-digit'
                     });
                     
                     // Áä∂ÊÄÅÊ†∑ÂºèÊò†Â∞Ñ
                     const statusClass = {
                         'Ê≠£Â∏∏': 'normal',
                         'È£éÈô©': 'risk',
                         'Âª∂Êúü': 'delay'
                     }[record.status] || 'normal';
                     
                     recordsHTML += `
                         <div class="progress-record-item" data-record-id="${record.record_id}">
                             <div class="progress-record-header">
                                 <div class="progress-record-number">${recordNumber}</div>
                                 <div class="progress-record-title">ËøõÂ±ïËÆ∞ÂΩï</div>
                                 <div class="progress-record-time">${createdDate}</div>
                                 <div class="progress-record-edit-btn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-dots"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /></svg></div>
                             </div>
                             <div class="progress-record-meta">
                                 <div class="progress-record-status">
                                     Áä∂ÊÄÅÔºö<span class="status-value ${statusClass}">${record.status}</span>
                                 </div>
                                 <div class="progress-record-expectation">
                                     È¢ÑÊúüÔºö${record.expectation}
                                 </div>
                             </div>
                             <div class="progress-record-content">${record.content}</div>
                             <div class="progress-record-update-time">Êõ¥Êñ∞‰∫éÔºö${updatedDate}</div>
                         </div>
                         <div class="progress-record-edit-update" data-record-id="${record.record_id}" style="display: none;">
                             <div class="progress-form-row">
                                 <div class="progress-form-field">
                                     <label>Áä∂ÊÄÅÔºö</label>
                                     <select class="progress-select edit-status-select">
                                         <option value="ÊöÇÊó†">ÊöÇÊó†</option>
                                         <option value="Ê≠£Â∏∏">Ê≠£Â∏∏</option>
                                         <option value="È£éÈô©">È£éÈô©</option>
                                         <option value="Âª∂Êúü">Âª∂Êúü</option>
                                     </select>
                                 </div>
                                 <div class="progress-form-field">
                                     <label>È¢ÑÊúüÔºö</label>
                                     <select class="progress-select edit-expectation-select">
                                         <option value="Á¨¶ÂêàÈ¢ÑÊúü">Á¨¶ÂêàÈ¢ÑÊúü</option>
                                         <option value="Ë∂ÖÂá∫È¢ÑÊúü">Ë∂ÖÂá∫È¢ÑÊúü</option>
                                         <option value="‰Ωé‰∫éÈ¢ÑÊúü">‰Ωé‰∫éÈ¢ÑÊúü</option>
                                         <option value="‰∏•Èáç‰Ωé‰∫éÈ¢ÑÊúü">‰∏•Èáç‰Ωé‰∫éÈ¢ÑÊúü</option>
                                     </select>
                                 </div>
                             </div>
                             <div class="progress-form-content">
                                 <div class="progress-editor edit-content-editor" contenteditable="true" data-placeholder="ËøôÈáåÊòØËæìÂÖ•Ê°Ü"></div>
                             </div>
                             <div class="progress-form-toolbar">
                                 <div class="progress-toolbar-left">
                                     <button type="button" class="toolbar-btn"><strong>B</strong></button>
                                     <button type="button" class="toolbar-btn"><em>S</em></button>
                                     <button type="button" class="toolbar-btn"><u>A</u></button>
                                     <button type="button" class="toolbar-btn">‚â°</button>
                                     <button type="button" class="toolbar-btn">‚ãÆ‚ãÆ‚ãÆ</button>
                                     <button type="button" class="toolbar-btn">üîó</button>
                                     <button type="button" class="toolbar-btn">‚òë</button>
                                     <div class="color-picker-container">
                                         <button type="button" class="toolbar-btn color-btn">üé®</button>
                                         <input type="color" class="color-input" value="#000000">
                                     </div>
                                     <button type="button" class="toolbar-btn edit-image-btn" title="Ê∑ªÂä†ÂõæÁâá">
                                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                             <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                             <circle cx="8.5" cy="8.5" r="1.5"/>
                                             <polyline points="21,15 16,10 5,21"/>
                                         </svg>
                                     </button>
                                     <input type="file" class="edit-image-input" accept="image/*" style="display: none;">
                                 </div>
                                 <div class="progress-toolbar-right">
                                     <button type="button" class="progress-cancel-btn edit-cancel-btn">ÂèñÊ∂à</button>
                                     <button type="button" class="progress-submit-btn edit-update-btn">Êõ¥Êñ∞</button>
                                 </div>
                             </div>
                             <div class="edit-image-preview" style="display: none; margin-top: 10px;">
                                 <img class="edit-preview-image" style="max-width: 200px; max-height: 150px; border-radius: 4px; border: 1px solid #ddd;">
                                 <button type="button" class="edit-remove-image-btn" style="margin-left: 10px; padding: 4px 8px; background: #dc3545; color: white; border: none; border-radius: 4px; cursor: pointer;">Âà†Èô§</button>
                             </div>
                         </div>
                     `;
                 });
                 
                 recordsList.innerHTML = recordsHTML;
                 
                 // ‰∏∫Êñ∞ÁîüÊàêÁöÑÁºñËæëÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
                 addEditButtonListeners();
                 
                 // ‰∏∫ÁºñËæëË°®ÂçïÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
                 addEditFormListeners();
             }
             
             // ‰∏∫ÁºñËæëÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
             function addEditButtonListeners() {
                 const editButtons = document.querySelectorAll('.progress-record-edit-btn');
                 editButtons.forEach((button, index) => {
                     button.addEventListener('click', function(e) {
                         e.stopPropagation();
                         showEditMenu(e, index);
                     });
                 });
             }
             
             // ‰∏∫ÁºñËæëË°®ÂçïÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
             function addEditFormListeners() {
                 // Êõ¥Êñ∞ÊåâÈíÆ‰∫ã‰ª∂
                 const updateButtons = document.querySelectorAll('.edit-update-btn');
                 updateButtons.forEach(button => {
                     button.addEventListener('click', function(e) {
                         e.preventDefault();
                         const editContainer = this.closest('.progress-record-edit-update');
                         const recordId = editContainer.getAttribute('data-record-id');
                         handleUpdateRecord(recordId);
                     });
                 });
                 
                 // ÂèñÊ∂àÊåâÈíÆ‰∫ã‰ª∂
                 const cancelButtons = document.querySelectorAll('.edit-cancel-btn');
                 cancelButtons.forEach(button => {
                     button.addEventListener('click', function(e) {
                         e.preventDefault();
                         const editContainer = this.closest('.progress-record-edit-update');
                         const recordId = editContainer.getAttribute('data-record-id');
                         handleCancelEdit(recordId);
                     });
                 });
                 
                 // ‰∏∫ÁºñËæëË°®ÂçïÁöÑÂ∑•ÂÖ∑Ê†èÊåâÈíÆÊ∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
                 const editContainers = document.querySelectorAll('.progress-record-edit-update');
                 editContainers.forEach(editContainer => {
                     const toolbarButtons = editContainer.querySelectorAll('.toolbar-btn');
                     const contentEditor = editContainer.querySelector('.edit-content-editor');
                     
                     if (toolbarButtons && contentEditor) {
                         toolbarButtons.forEach((btn, index) => {
                             // ÁßªÈô§‰πãÂâçÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®ÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâ
                             btn.replaceWith(btn.cloneNode(true));
                         });
                         
                         // ÈáçÊñ∞Ëé∑ÂèñÂÖãÈöÜÂêéÁöÑÊåâÈíÆ
                         const newToolbarButtons = editContainer.querySelectorAll('.toolbar-btn');
                         newToolbarButtons.forEach((btn, index) => {
                             btn.addEventListener('click', function(e) {
                                 e.preventDefault();
                                 e.stopPropagation();
                                 
                                 // Á°Æ‰øùÁºñËæëÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
                                 contentEditor.focus();
                                 
                                 switch(index) {
                                     case 0: // B - Âä†Á≤ó
                                         document.execCommand('bold', false, null);
                                         break;
                                     case 1: // S - Êñú‰Ωì
                                         document.execCommand('italic', false, null);
                                         break;
                                     case 2: // A - ‰∏ãÂàíÁ∫ø
                                         document.execCommand('underline', false, null);
                                         break;
                                     case 3: // ‚â° - Êó†Â∫èÂàóË°®
                                         document.execCommand('insertUnorderedList', false, null);
                                         break;
                                     case 4: // ‚ãÆ‚ãÆ‚ãÆ - ÂàÜÂâ≤Á∫ø
                                         document.execCommand('insertHTML', false, '<hr>');
                                         break;
                                     case 5: // üîó - ÈìæÊé•
                                         const selection = window.getSelection();
                                         const selectedText = selection.toString();
                                         const linkText = selectedText || 'ÈìæÊé•ÊñáÊú¨';
                                         const url = prompt('ËØ∑ËæìÂÖ•ÈìæÊé•Âú∞ÂùÄ:', 'https://');
                                         if (url) {
                                             if (selectedText) {
                                                 document.execCommand('createLink', false, url);
                                             } else {
                                                 document.execCommand('insertHTML', false, `<a href="${url}">${linkText}</a>`);
                                             }
                                         }
                                         break;
                                     case 6: // ‚òë - Â§çÈÄâÊ°Ü
                                         const selection2 = window.getSelection();
                                         const selectedText2 = selection2.toString();
                                         const checkboxText = selectedText2 || 'ÂæÖÂäû‰∫ãÈ°π';
                                         document.execCommand('insertHTML', false, `<div><input type="checkbox"> ${checkboxText}</div>`);
                                         break;
                                 }
                                 
                                 // ‰øùÊåÅÁºñËæëÂô®ÁÑ¶ÁÇπ
                                 contentEditor.focus();
                             });
                         });
                     }
                     
                     // ‰∏∫È¢úËâ≤ÈÄâÊã©Âô®Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨Âô®
                     const colorBtn = editContainer.querySelector('.color-btn');
                     const colorInput = editContainer.querySelector('.color-input');
                     
                     if (colorBtn && colorInput && contentEditor) {
                         // ÁßªÈô§‰πãÂâçÁöÑ‰∫ã‰ª∂ÁõëÂê¨Âô®
                         colorBtn.replaceWith(colorBtn.cloneNode(true));
                         colorInput.replaceWith(colorInput.cloneNode(true));
                         
                         // ÈáçÊñ∞Ëé∑ÂèñÂÖãÈöÜÂêéÁöÑÂÖÉÁ¥†
                         const newColorBtn = editContainer.querySelector('.color-btn');
                         const newColorInput = editContainer.querySelector('.color-input');
                         
                         // ÁÇπÂáªÈ¢úËâ≤ÊåâÈíÆÊó∂Ëß¶ÂèëÈ¢úËâ≤ÈÄâÊã©Âô®
                         newColorBtn.addEventListener('click', function(e) {
                             e.preventDefault();
                             e.stopPropagation();
                             newColorInput.click();
                         });
                         
                         // È¢úËâ≤ÈÄâÊã©Âô®ÂèòÂåñ‰∫ã‰ª∂
                         newColorInput.addEventListener('change', function(e) {
                             const selectedColor = e.target.value;
                             
                             // Á°Æ‰øùÁºñËæëÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
                             contentEditor.focus();
                             
                             // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÊñáÊú¨
                             const selection = window.getSelection();
                             const selectedText = selection.toString();
                             
                             if (selectedText) {
                                 // Â¶ÇÊûúÊúâÈÄâ‰∏≠ÊñáÊú¨ÔºåÊîπÂèòÂÖ∂È¢úËâ≤
                                 document.execCommand('foreColor', false, selectedColor);
                             } else {
                                 // Â¶ÇÊûúÊ≤°ÊúâÈÄâ‰∏≠ÊñáÊú¨ÔºåÊèíÂÖ•Â∏¶È¢úËâ≤ÁöÑÁ§∫‰æãÊñáÊú¨
                                 document.execCommand('insertHTML', false, `<span style="color: ${selectedColor};">ÂΩ©Ëâ≤ÊñáÊú¨</span>`);
                             }
                             
                             // ‰øùÊåÅÁºñËæëÂô®ÁÑ¶ÁÇπ
                             contentEditor.focus();
                         });
                     }
                 });
                 
                 // ÂõæÁâá‰∏ä‰º†ÊåâÈíÆ‰∫ã‰ª∂
                 const imageButtons = document.querySelectorAll('.edit-image-btn');
                 imageButtons.forEach(button => {
                     button.addEventListener('click', function(e) {
                         e.preventDefault();
                         const editContainer = this.closest('.progress-record-edit-update');
                         const fileInput = editContainer.querySelector('.edit-image-input');
                         if (fileInput) {
                             fileInput.click();
                         }
                     });
                 });
                 
                 // ÂõæÁâáÊñá‰ª∂ÈÄâÊã©‰∫ã‰ª∂
                 const imageInputs = document.querySelectorAll('.edit-image-input');
                 imageInputs.forEach(input => {
                     input.addEventListener('change', function(e) {
                         const files = e.target.files;
                         if (files && files.length > 0) {
                             const editContainer = this.closest('.progress-record-edit-update');
                             const contentEditor = editContainer.querySelector('.edit-content-editor');
                             
                             Array.from(files).forEach(file => {
                                 if (file.type.startsWith('image/')) {
                                     const reader = new FileReader();
                                     reader.onload = function(e) {
                                         const imageUrl = e.target.result;
                                         
                                         // Á°Æ‰øùÁºñËæëÂô®Ëé∑ÂæóÁÑ¶ÁÇπ
                                         contentEditor.focus();
                                         
                                         // ÊèíÂÖ•ÂõæÁâáÂà∞ÁºñËæëÂô®‰∏≠
                                         const imgHtml = `<img src="${imageUrl}" style="max-width: 100%; height: auto; margin: 10px 0;" alt="‰∏ä‰º†ÁöÑÂõæÁâá">`;
                                         document.execCommand('insertHTML', false, imgHtml);
                                         
                                         // ‰øùÊåÅÁºñËæëÂô®ÁÑ¶ÁÇπ
                                         contentEditor.focus();
                                     };
                                     reader.readAsDataURL(file);
                                 }
                             });
                             
                             // Ê∏ÖÁ©∫Êñá‰ª∂ËæìÂÖ•Ê°ÜÔºåÂÖÅËÆ∏ÈáçÂ§çÈÄâÊã©Âêå‰∏ÄÊñá‰ª∂
                             this.value = '';
                         }
                     });
                 });
                 
                 // Êñá‰ª∂ÈÄâÊã©‰∫ã‰ª∂
                 const fileInputs = document.querySelectorAll('.edit-image-input');
                 fileInputs.forEach(input => {
                     input.addEventListener('change', function(e) {
                         const file = e.target.files[0];
                         if (file) {
                             handleEditImageUpload(file, this);
                         }
                     });
                 });
                 
                 // Âà†Èô§ÂõæÁâáÊåâÈíÆ‰∫ã‰ª∂
                 const removeImageButtons = document.querySelectorAll('.edit-remove-image-btn');
                 removeImageButtons.forEach(button => {
                     button.addEventListener('click', function(e) {
                         e.preventDefault();
                         const editContainer = this.closest('.progress-record-edit-update');
                         const imagePreview = editContainer.querySelector('.edit-image-preview');
                         const fileInput = editContainer.querySelector('.edit-image-input');
                         
                         if (imagePreview) {
                             imagePreview.style.display = 'none';
                         }
                         if (fileInput) {
                             fileInput.value = '';
                         }
                     });
                 });
             }
             
             // ÊòæÁ§∫ÁºñËæëËèúÂçï
             function showEditMenu(event, recordIndex) {
                 const menu = document.getElementById('progressRecordEditMenu');
                 if (!menu) return;
                 
                 // Ëé∑ÂèñÂΩìÂâçÁõÆÊ†áÁöÑËøõÂ±ïËÆ∞ÂΩï
                 const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                 const allRecords = JSON.parse(localStorage.getItem('objective_records') || '[]');
                 const goalRecords = allRecords.filter(record => record.goal_id === selectedGoalId);
                 goalRecords.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));
                 
                 const currentRecord = goalRecords[recordIndex];
                 if (!currentRecord) return;
                 
                 // ËÆæÁΩÆËèúÂçï‰ΩçÁΩÆ
                 const rect = event.target.closest('.progress-record-edit-btn').getBoundingClientRect();
                 menu.style.left = (rect.left - 50) + 'px';
                 menu.style.top = (rect.bottom + 5) + 'px';
                 menu.style.display = 'block';
                 
                 // Â≠òÂÇ®ÂΩìÂâçËÆ∞ÂΩï‰ø°ÊÅØ
                 menu.dataset.recordId = currentRecord.record_id;
                 menu.dataset.recordIndex = recordIndex;
                 
                 // Ê∑ªÂä†ËèúÂçïÈ°πÁÇπÂáª‰∫ã‰ª∂
                 const menuItems = menu.querySelectorAll('.edit-menu-item');
                 menuItems.forEach(item => {
                     item.onclick = function() {
                         const action = this.dataset.action;
                         if (action === 'edit') {
                             handleEditRecord(currentRecord);
                         } else if (action === 'delete') {
                             handleDeleteRecord(currentRecord);
                         }
                         hideEditMenu();
                     };
                 });
             }
             
             // ÈöêËóèÁºñËæëËèúÂçï
             function hideEditMenu() {
                 const menu = document.getElementById('progressRecordEditMenu');
                 if (menu) {
                     menu.style.display = 'none';
                 }
             }
             
             // Â§ÑÁêÜÁºñËæëËÆ∞ÂΩï
             function handleEditRecord(record) {
                 const recordId = record.record_id;
                 const recordItem = document.querySelector(`.progress-record-item[data-record-id="${recordId}"]`);
                 const editContainer = document.querySelector(`.progress-record-edit-update[data-record-id="${recordId}"]`);
                 
                 if (recordItem && editContainer) {
                     // ÈöêËóèËÆ∞ÂΩïÈ°πÔºåÊòæÁ§∫ÁºñËæëË°®Âçï
                     recordItem.style.display = 'none';
                     editContainer.style.display = 'block';
                     
                     // È¢ÑÂ°´ÂÖÖÊï∞ÊçÆ
                     fillEditForm(record);
                 }
             }
             
             // È¢ÑÂ°´ÂÖÖÁºñËæëË°®ÂçïÊï∞ÊçÆ
             function fillEditForm(record) {
                 const recordId = record.record_id;
                 const editContainer = document.querySelector(`.progress-record-edit-update[data-record-id="${recordId}"]`);
                 
                 if (editContainer) {
                     // Â°´ÂÖÖÁä∂ÊÄÅÈÄâÊã©Âô®
                     const statusSelect = editContainer.querySelector('.edit-status-select');
                     if (statusSelect) {
                         statusSelect.value = record.status || 'ÊöÇÊó†';
                     }
                     
                     // Â°´ÂÖÖÈ¢ÑÊúüÈÄâÊã©Âô®
                     const expectationSelect = editContainer.querySelector('.edit-expectation-select');
                     if (expectationSelect) {
                         expectationSelect.value = record.expectation || 'Á¨¶ÂêàÈ¢ÑÊúü';
                     }
                     
                     // Â°´ÂÖÖÂÜÖÂÆπÁºñËæëÂô®
                     const contentEditor = editContainer.querySelector('.edit-content-editor');
                     if (contentEditor) {
                         contentEditor.innerHTML = record.content || '';
                     }
                     
                     // Â°´ÂÖÖÂõæÁâáÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâ
                     if (record.image) {
                         const imagePreview = editContainer.querySelector('.edit-image-preview');
                         const previewImage = editContainer.querySelector('.edit-preview-image');
                         
                         if (imagePreview && previewImage) {
                             previewImage.src = record.image;
                             imagePreview.style.display = 'block';
                         }
                     }
                 }
             }
             
             // Â§ÑÁêÜÁºñËæëÂõæÁâá‰∏ä‰º†
             function handleEditImageUpload(file, fileInput) {
                 // Ê£ÄÊü•Êñá‰ª∂Á±ªÂûã
                 if (!file.type.startsWith('image/')) {
                     alert('ËØ∑ÈÄâÊã©ÂõæÁâáÊñá‰ª∂ÔºÅ');
                     return;
                 }
                 
                 // Ê£ÄÊü•Êñá‰ª∂Â§ßÂ∞èÔºàÈôêÂà∂‰∏∫5MBÔºâ
                 if (file.size > 5 * 1024 * 1024) {
                     alert('ÂõæÁâáÊñá‰ª∂Â§ßÂ∞è‰∏çËÉΩË∂ÖËøá5MBÔºÅ');
                     return;
                 }
                 
                 const editContainer = fileInput.closest('.progress-record-edit-update');
                 const imagePreview = editContainer.querySelector('.edit-image-preview');
                 const previewImage = editContainer.querySelector('.edit-preview-image');
                 
                 // ËØªÂèñÊñá‰ª∂Âπ∂ÊòæÁ§∫È¢ÑËßà
                 const reader = new FileReader();
                 reader.onload = function(e) {
                     if (previewImage && imagePreview) {
                         previewImage.src = e.target.result;
                         imagePreview.style.display = 'block';
                     }
                 };
                 reader.readAsDataURL(file);
             }
             
             // Â§ÑÁêÜÊõ¥Êñ∞ËÆ∞ÂΩï
             function handleUpdateRecord(recordId) {
                 const editContainer = document.querySelector(`.progress-record-edit-update[data-record-id="${recordId}"]`);
                 
                 if (editContainer) {
                     // Ëé∑ÂèñË°®ÂçïÊï∞ÊçÆ
                     const statusSelect = editContainer.querySelector('.edit-status-select');
                     const expectationSelect = editContainer.querySelector('.edit-expectation-select');
                     const contentEditor = editContainer.querySelector('.edit-content-editor');
                     const previewImage = editContainer.querySelector('.edit-preview-image');
                     
                     const updatedData = {
                         status: statusSelect ? statusSelect.value : 'ÊöÇÊó†',
                         expectation: expectationSelect ? expectationSelect.value : 'Á¨¶ÂêàÈ¢ÑÊúü',
                         content: contentEditor ? contentEditor.innerHTML.trim() : ''
                     };
                     
                     // Ê∑ªÂä†ÂõæÁâáÊï∞ÊçÆÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâ
                     if (previewImage && previewImage.src && previewImage.src !== window.location.href) {
                         updatedData.image = previewImage.src;
                     }
                     
                     // È™åËØÅÂÜÖÂÆπ‰∏çËÉΩ‰∏∫Á©∫
                     if (!updatedData.content) {
                         alert('ËØ∑ËæìÂÖ•ËøõÂ±ïÂÜÖÂÆπ');
                         return;
                     }
                     
                     // Êõ¥Êñ∞localStorage‰∏≠ÁöÑÊï∞ÊçÆ
                     const allRecords = JSON.parse(localStorage.getItem('objective_records') || '[]');
                     const recordIndex = allRecords.findIndex(r => r.record_id === recordId);
                     
                     if (recordIndex !== -1) {
                         allRecords[recordIndex] = {
                             ...allRecords[recordIndex],
                             ...updatedData,
                             updated_at: new Date().toISOString()
                         };
                         
                         localStorage.setItem('objective_records', JSON.stringify(allRecords));
                         
                         // ÈöêËóèÁºñËæëË°®ÂçïÔºåÊòæÁ§∫ËÆ∞ÂΩïÈ°π
                         editContainer.style.display = 'none';
                         const recordItem = document.querySelector(`.progress-record-item[data-record-id="${recordId}"]`);
                         if (recordItem) {
                             recordItem.style.display = 'block';
                         }
                         
                         // ÈáçÊñ∞Âä†ËΩΩËøõÂ±ïËÆ∞ÂΩïÊòæÁ§∫
                         const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                         loadProgressRecords(selectedGoalId);
                     }
                 }
             }
             
             // Â§ÑÁêÜÂèñÊ∂àÁºñËæë
             function handleCancelEdit(recordId) {
                 const editContainer = document.querySelector(`.progress-record-edit-update[data-record-id="${recordId}"]`);
                 const recordItem = document.querySelector(`.progress-record-item[data-record-id="${recordId}"]`);
                 
                 if (editContainer && recordItem) {
                     // ÈöêËóèÁºñËæëË°®ÂçïÔºåÊòæÁ§∫ËÆ∞ÂΩïÈ°π
                     editContainer.style.display = 'none';
                     recordItem.style.display = 'block';
                     
                     // Ê∏ÖÁêÜÂõæÁâáÈ¢ÑËßà
                     const imagePreview = editContainer.querySelector('.edit-image-preview');
                     const fileInput = editContainer.querySelector('.edit-image-input');
                     
                     if (imagePreview) {
                         imagePreview.style.display = 'none';
                     }
                     if (fileInput) {
                         fileInput.value = '';
                     }
                 }
             }
             
             // Â§ÑÁêÜÂà†Èô§ËÆ∞ÂΩï
             function handleDeleteRecord(record) {
                 if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ËøõÂ±ïËÆ∞ÂΩïÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊí§ÈîÄ„ÄÇ')) {
                     // ‰ªélocalStorageÂà†Èô§ËÆ∞ÂΩï
                     const allRecords = JSON.parse(localStorage.getItem('objective_records') || '[]');
                     const updatedRecords = allRecords.filter(r => r.record_id !== record.record_id);
                     localStorage.setItem('objective_records', JSON.stringify(updatedRecords));
                     
                     // Êõ¥Êñ∞ÁïåÈù¢ÊòæÁ§∫
                     const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                     loadProgressRecords(selectedGoalId);
                     updateProgressRecordButtonCount(selectedGoalId);
                 }
             }
             
             // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠ËèúÂçï
             document.addEventListener('click', function(e) {
                 const menu = document.getElementById('progressRecordEditMenu');
                 if (menu && !menu.contains(e.target) && !e.target.closest('.progress-record-edit-btn')) {
                     hideEditMenu();
                 }
             });
             
             // ÁõëÂê¨ÁõÆÊ†áÈÄâÊã©ÂèòÂåñÔºåËá™Âä®Âä†ËΩΩËøõÂ±ïËÆ∞ÂΩï
             function onGoalSelectionChange() {
                 const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                 loadProgressRecords(selectedGoalId);
             }
             
             // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñËøõÂ±ïËÆ∞ÂΩïÂ±ïÁ§∫
             setTimeout(() => {
                 const selectedGoalId = sessionStorage.getItem('selectedGoalId');
                 loadProgressRecords(selectedGoalId);
             }, 500);
         });
         
         // Âä®ÊÄÅÂπ¥ÊúàÁ≠õÈÄâÂô®ÂäüËÉΩÂÆûÁé∞
         let selectedMonths = [];
         let isSelectingRange = false;
         let rangeStart = null;
         let currentDisplayYear = new Date().getFullYear();
         let currentDisplayMonth = 1; // ÂΩìÂâçÊòæÁ§∫ÁöÑËµ∑ÂßãÊúà‰ªΩ
         
         // ÂàùÂßãÂåñÂä®ÊÄÅÂπ¥ÊúàÁ≠õÈÄâÂô®
         function initCalendarFilter() {
             const resetBtn = document.querySelector('.calendar-reset-btn');
             const prevBtn = document.getElementById('calendarNavPrev');
             const nextBtn = document.getElementById('calendarNavNext');
             
             // ÁîüÊàêÂàùÂßãÊúà‰ªΩÊ†áÁ≠æ
             generateMonthTags();
             
             // ÂØºËà™ÊåâÈíÆ‰∫ã‰ª∂
             if (prevBtn) {
                 prevBtn.addEventListener('click', function() {
                     navigateMonth(-1);
                 });
             }
             
             if (nextBtn) {
                 nextBtn.addEventListener('click', function() {
                     navigateMonth(1);
                 });
             }
             
             // ÈáçÁΩÆÊåâÈíÆ‰∫ã‰ª∂
             if (resetBtn) {
                 resetBtn.addEventListener('click', function() {
                     resetCalendarFilter();
                 });
             }
         }
         
         // ÁîüÊàêÊúà‰ªΩÊ†áÁ≠æ
         function generateMonthTags() {
             const container = document.getElementById('calendarMonthsContainer');
             if (!container) return;
             
             container.innerHTML = '';
             
             // ÁîüÊàê12‰∏™Êúà‰ªΩÊ†áÁ≠æ
             for (let i = 0; i < 12; i++) {
                 let displayMonth = currentDisplayMonth + i;
                 let displayYear = currentDisplayYear;
                 
                 // Â§ÑÁêÜË∑®Âπ¥ÊÉÖÂÜµ
                 if (displayMonth > 12) {
                     displayMonth = displayMonth - 12;
                     displayYear = currentDisplayYear + 1;
                 }
                 
                 const monthTag = document.createElement('div');
                 monthTag.className = 'month-tag';
                 monthTag.setAttribute('data-year', displayYear);
                 monthTag.setAttribute('data-month', displayMonth);
                 monthTag.textContent = `${displayYear}-${displayMonth}Êúà`;
                 
                 // Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂
                 monthTag.addEventListener('click', function() {
                     const year = parseInt(this.getAttribute('data-year'));
                     const month = parseInt(this.getAttribute('data-month'));
                     handleMonthSelection(year, month, this);
                 });
                 
                 container.appendChild(monthTag);
             }
             
             // Êõ¥Êñ∞ÈÄâ‰∏≠Áä∂ÊÄÅÊòæÁ§∫
             updateMonthTagsDisplay();
         }
         
         // ÂØºËà™Êúà‰ªΩ
         function navigateMonth(direction) {
             const container = document.getElementById('calendarMonthsContainer');
             
             // Ê∑ªÂä†ÊªëÂä®ÊïàÊûú
             container.classList.add('sliding');
             
             setTimeout(() => {
                 currentDisplayMonth += direction;
                 
                 // Â§ÑÁêÜË∑®Âπ¥
                 if (currentDisplayMonth > 12) {
                     currentDisplayMonth = 1;
                     currentDisplayYear++;
                 } else if (currentDisplayMonth < 1) {
                     currentDisplayMonth = 12;
                     currentDisplayYear--;
                 }
                 
                 // ÈáçÊñ∞ÁîüÊàêÊúà‰ªΩÊ†áÁ≠æ
                 generateMonthTags();
                 
                 // ÁßªÈô§ÊªëÂä®ÊïàÊûú
                 container.classList.remove('sliding');
             }, 150);
         }
         
         // Â§ÑÁêÜÂπ¥ÊúàÈÄâÊã©ÈÄªËæë
         function handleMonthSelection(year, month, element) {
             const yearMonth = `${year}-${month}`;
             console.log('ÁÇπÂáªÊúà‰ªΩ:', yearMonth);
             
             if (selectedMonths.length === 0) {
                 // Á¨¨‰∏ÄÊ¨°ÈÄâÊã©
                 selectedMonths = [yearMonth];
                 rangeStart = { year, month };
                 element.classList.add('selected', 'range-start');
                 console.log('Á¨¨‰∏ÄÊ¨°ÈÄâÊã©ÔºåselectedMonths:', selectedMonths);
             } else if (selectedMonths.length === 1) {
                 // Á¨¨‰∫åÊ¨°ÈÄâÊã©
                 const firstYearMonth = selectedMonths[0];
                 if (yearMonth === firstYearMonth) {
                     // ÁÇπÂáªÂêå‰∏Ä‰∏™Âπ¥ÊúàÔºåÂèñÊ∂àÈÄâÊã©
                     selectedMonths = [];
                     rangeStart = null;
                     element.classList.remove('selected', 'range-start');
                     console.log('ÂèñÊ∂àÈÄâÊã©ÔºåselectedMonths:', selectedMonths);
                 } else {
                     // ÈÄâÊã©‰∏çÂêåÂπ¥ÊúàÔºåÂΩ¢ÊàêÂå∫Èó¥
                     const startDate = new Date(rangeStart.year, rangeStart.month - 1);
                     const endDate = new Date(year, month - 1);
                     
                     if (startDate > endDate) {
                         [startDate, endDate] = [endDate, startDate];
                     }
                     
                     selectedMonths = [];
                     const current = new Date(startDate);
                     
                     // ÁîüÊàêÂå∫Èó¥ÂÜÖÁöÑÊâÄÊúâÂπ¥Êúà
                     while (current <= endDate) {
                         const currentYear = current.getFullYear();
                         const currentMonth = current.getMonth() + 1;
                         selectedMonths.push(`${currentYear}-${currentMonth}`);
                         current.setMonth(current.getMonth() + 1);
                     }
                     
                     console.log('Âå∫Èó¥ÈÄâÊã©ÔºåselectedMonths:', selectedMonths);
                     
                     // Êõ¥Êñ∞UIÊòæÁ§∫
                     updateMonthTagsDisplay();
                 }
             } else {
                 // Â∑≤ÊúâÂå∫Èó¥ÈÄâÊã©ÔºåÈáçÊñ∞ÂºÄÂßã
                 resetCalendarFilter();
                 selectedMonths = [yearMonth];
                 rangeStart = { year, month };
                 element.classList.add('selected', 'range-start');
                 console.log('ÈáçÊñ∞ÂºÄÂßãÈÄâÊã©ÔºåselectedMonths:', selectedMonths);
             }
             
             // Â∫îÁî®Á≠õÈÄâ
             applyCalendarFilter();
         }
         
         // Êõ¥Êñ∞Êúà‰ªΩÊ†áÁ≠æÊòæÁ§∫Áä∂ÊÄÅ
         function updateMonthTagsDisplay() {
             const monthTags = document.querySelectorAll('.month-tag');
             
             monthTags.forEach(tag => {
                 const year = parseInt(tag.getAttribute('data-year'));
                 const month = parseInt(tag.getAttribute('data-month'));
                 const yearMonth = `${year}-${month}`;
                 
                 tag.classList.remove('selected', 'range-start', 'range-end', 'range-middle');
                 
                 if (selectedMonths.includes(yearMonth)) {
                     tag.classList.add('selected');
                     
                     if (selectedMonths.length > 1) {
                         if (yearMonth === selectedMonths[0]) {
                             tag.classList.add('range-start');
                         } else if (yearMonth === selectedMonths[selectedMonths.length - 1]) {
                             tag.classList.add('range-end');
                         } else {
                             tag.classList.add('range-middle');
                         }
                     } else {
                         tag.classList.add('range-start');
                     }
                 }
             });
         }
         
         // ÈáçÁΩÆÊúà‰ªΩÁ≠õÈÄâÂô®
         function resetCalendarFilter() {
             selectedMonths = [];
             rangeStart = null;
             isSelectingRange = false;
             
             const monthTags = document.querySelectorAll('.month-tag');
             monthTags.forEach(tag => {
                 tag.classList.remove('selected', 'range-start', 'range-end', 'range-middle');
             });
             
             // ÈáçÊñ∞Âä†ËΩΩÊâÄÊúâÁõÆÊ†á
             loadGoalsToContainer();
         }
         
         // Â∫îÁî®Êúà‰ªΩÁ≠õÈÄâ
         function applyCalendarFilter() {
             if (selectedMonths.length === 0) {
                 // Ê≤°ÊúâÈÄâÊã©Êúà‰ªΩÔºåÊòæÁ§∫ÊâÄÊúâÁõÆÊ†á
                 loadGoalsToContainer();
                 return;
             }
             
             // Ëé∑ÂèñÊâÄÊúâÁõÆÊ†áÊï∞ÊçÆ
             const goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
             
             // Ê†πÊçÆÈÄâ‰∏≠ÁöÑÊúà‰ªΩÁ≠õÈÄâÁõÆÊ†á
             const filteredGoals = goals.filter(goal => {
                 return isGoalInSelectedMonths(goal, selectedMonths);
             });
             
             // ÊòæÁ§∫Á≠õÈÄâÂêéÁöÑÁõÆÊ†á
             displayFilteredGoals(filteredGoals);
         }
         
         // Âà§Êñ≠ÁõÆÊ†áÊòØÂê¶Âú®ÈÄâ‰∏≠ÁöÑÂπ¥ÊúàÂå∫Èó¥ÂÜÖ
         function isGoalInSelectedMonths(goal, months) {
             if (!goal.start_date || !goal.end_date) {
                 return false; // Ê≤°ÊúâÊó•Êúü‰ø°ÊÅØÁöÑÁõÆÊ†á‰∏çÂèÇ‰∏éÁ≠õÈÄâ
             }
             
             const startDate = new Date(goal.start_date);
             const endDate = new Date(goal.end_date);
             
             // Ëé∑ÂèñÁõÆÊ†áÁöÑËµ∑ÂßãÂπ¥ÊúàÂíåÁªìÊùüÂπ¥Êúà
             const goalStartYear = startDate.getFullYear();
             const goalStartMonth = startDate.getMonth() + 1;
             const goalEndYear = endDate.getFullYear();
             const goalEndMonth = endDate.getMonth() + 1;
             
             const goalStartYearMonth = `${goalStartYear}-${goalStartMonth}`;
             const goalEndYearMonth = `${goalEndYear}-${goalEndMonth}`;
             
             // Â¶ÇÊûúÂè™ÈÄâÊã©‰∫Ü‰∏Ä‰∏™Âπ¥Êúà
             if (months.length === 1) {
                 const selectedYearMonth = months[0];
                 // Ê£ÄÊü•ÁõÆÊ†áÁöÑÊó∂Èó¥ËåÉÂõ¥ÊòØÂê¶ÂåÖÂê´ÈÄâ‰∏≠ÁöÑÂπ¥Êúà
                 return isYearMonthInRange(selectedYearMonth, goalStartYearMonth, goalEndYearMonth);
             } else {
                 // Â¶ÇÊûúÈÄâÊã©‰∫ÜÂπ¥ÊúàÂå∫Èó¥ÔºåÈúÄË¶ÅÂÖàÊéíÂ∫èÁ°Æ‰øùÊ≠£Á°ÆÁöÑËµ∑ÂßãÂíåÁªìÊùüÊúà‰ªΩ
                 const sortedMonths = [...months].sort((a, b) => {
                     const [yearA, monthA] = a.split('-').map(Number);
                     const [yearB, monthB] = b.split('-').map(Number);
                     if (yearA !== yearB) return yearA - yearB;
                     return monthA - monthB;
                 });
                 const selectedStartYearMonth = sortedMonths[0];
                 const selectedEndYearMonth = sortedMonths[sortedMonths.length - 1];
                 
                 // Ê£ÄÊü•ÁõÆÊ†áÁöÑÂπ¥ÊúàÂå∫Èó¥ÊòØÂê¶‰∏éÈÄâ‰∏≠ÁöÑÂπ¥ÊúàÂå∫Èó¥Êúâ‰∫§ÈõÜ
                 return isYearMonthRangeOverlap(
                     goalStartYearMonth, goalEndYearMonth,
                     selectedStartYearMonth, selectedEndYearMonth
                 );
             }
         }
         
         // Ê£ÄÊü•Âπ¥ÊúàÊòØÂê¶Âú®ÊåáÂÆöËåÉÂõ¥ÂÜÖ
         function isYearMonthInRange(yearMonth, startYearMonth, endYearMonth) {
             return compareYearMonth(yearMonth, startYearMonth) >= 0 && 
                    compareYearMonth(yearMonth, endYearMonth) <= 0;
         }
         
         // Ê£ÄÊü•‰∏§‰∏™Âπ¥ÊúàÂå∫Èó¥ÊòØÂê¶Êúâ‰∫§ÈõÜ
         function isYearMonthRangeOverlap(start1, end1, start2, end2) {
             return compareYearMonth(start1, end2) <= 0 && compareYearMonth(start2, end1) <= 0;
         }
         
         // ÊØîËæÉ‰∏§‰∏™Âπ¥ÊúàÂ≠óÁ¨¶‰∏≤ (Ê†ºÂºè: "YYYY-M")
         function compareYearMonth(yearMonth1, yearMonth2) {
             const [year1, month1] = yearMonth1.split('-').map(Number);
             const [year2, month2] = yearMonth2.split('-').map(Number);
             
             if (year1 !== year2) {
                 return year1 - year2;
             }
             return month1 - month2;
         }
         
         // ÊòæÁ§∫Á≠õÈÄâÂêéÁöÑÁõÆÊ†á
         function displayFilteredGoals(filteredGoals) {
             const container = document.querySelector('.bottom-section');
             if (!container) {
                 console.error('Êú™ÊâæÂà∞bottom-sectionÂÆπÂô®');
                 return;
             }
             
             // ÊåâÊà™Ê≠¢Êó•ÊúüÊéíÂ∫è
             filteredGoals.sort((a, b) => {
                 const today = new Date();
                 today.setHours(0, 0, 0, 0);
                 
                 if (!a.end_date && !b.end_date) {
                     return 0;
                 }
                 
                 if (!a.end_date) return 1;
                 if (!b.end_date) return -1;
                 
                 const dateA = new Date(a.end_date);
                 const dateB = new Date(b.end_date);
                 
                 return dateA - dateB;
             });
             
             // Ê∏ÖÁ©∫ÂÆπÂô®
             container.innerHTML = '';
             
             // Â¶ÇÊûúÊ≤°ÊúâÂåπÈÖçÁöÑÁõÆÊ†áÔºåÊòæÁ§∫Á©∫Áä∂ÊÄÅ
             if (filteredGoals.length === 0) {
                 let timeRangeText = '';
                 if (selectedMonths.length === 1) {
                     timeRangeText = selectedMonths[0];
                 } else if (selectedMonths.length > 1) {
                     timeRangeText = `${selectedMonths[0]} Ëá≥ ${selectedMonths[selectedMonths.length - 1]}`;
                 }
                 
                 container.innerHTML = `
                     <div class="goals-empty-state">
                         <div class="empty-icon">üìÖ</div>
                         <div class="empty-text">Ê≤°ÊúâÂåπÈÖçÁöÑÁõÆÊ†á</div>
                         <div class="empty-hint">Ê≤°ÊúâÊâæÂà∞Âú® ${timeRangeText} ÊúüÈó¥ÁöÑÁõÆÊ†á</div>
                     </div>
                 `;
                 return;
             }
             
             // ÂàõÂª∫ÁõÆÊ†áÂàóË°®ÂÆπÂô®
             const goalsListContainer = document.createElement('div');
             goalsListContainer.className = 'goals-list-container';
             
             // Ê∏≤ÊüìÊØè‰∏™ÁõÆÊ†áÔºàÂ§çÁî®Áé∞ÊúâÁöÑÁõÆÊ†áÊ∏≤ÊüìÈÄªËæëÔºâ
             filteredGoals.forEach(goal => {
                 const goalCard = createGoalCard(goal);
                 goalsListContainer.appendChild(goalCard);
             });
             
             container.appendChild(goalsListContainer);
             
             // ÊÅ¢Â§ç‰πãÂâçÈÄâ‰∏≠ÁöÑÁõÆÊ†áÂç°ÁâáÁä∂ÊÄÅ
             const selectedGoalId = sessionStorage.getItem('selectedGoalId');
             if (selectedGoalId) {
                 const selectedGoalCard = container.querySelector(`[data-goal-id="${selectedGoalId}"]`);
                 if (selectedGoalCard) {
                     selectedGoalCard.classList.add('selected');
                     updateProgressRecordButtonCount(selectedGoalId);
                 }
             }
         }
         
         // ÂàõÂª∫ÁõÆÊ†áÂç°ÁâáÔºàÊèêÂèñÂÖ¨ÂÖ±ÈÄªËæëÔºâ
         function createGoalCard(goal) {
             const goalCard = document.createElement('div');
             goalCard.className = 'goal-card';
             goalCard.setAttribute('data-goal-id', goal.goal_id);
             
             // ÂàõÂª∫Ê†áÈ¢òÂíåÊ†áÁ≠æÁöÑÂÆπÂô®
             const titleTagContainer = document.createElement('div');
             titleTagContainer.className = 'goal-title-tag-container';
             
             // ÂàõÂª∫Áä∂ÊÄÅÂúÜÁéØÂÆπÂô®
             const statusCircleContainer = document.createElement('div');
             statusCircleContainer.className = 'goal-status-circle';
             
             // ÂàõÂª∫Ê†áÁ≠æÂÆπÂô®
             const tagsContainer = document.createElement('div');
             tagsContainer.className = 'goal-tags';
             
             // Ëé∑Âèñ‰ªªÂä°ÁªüËÆ°‰ø°ÊÅØ
             const taskStats = getGoalTaskStats(goal.goal_id);
             const completedCount = taskStats.completedCount;
             const totalCount = taskStats.totalCount;
             const progressPercentage = taskStats.percentage;
             
             // ËÆ°ÁÆóÂâ©‰ΩôÂ§©Êï∞
             const remainingDays = calculateRemainingDays(goal.end_date);
             const isOverdue = remainingDays < 0;
             const isTaskCompleted = progressPercentage === 100;
             
             // Ê†πÊçÆÁä∂ÊÄÅËÆæÁΩÆÂúÜÁéØÂÜÖÂÆπÂíåÈ¢úËâ≤
             let circleContent = '';
             let circleColor = '#4CAF50'; // ÈªòËÆ§ÁªøËâ≤
             
             if (isTaskCompleted) {
                 // ‰ªªÂä°100%ÂÆåÊàêÔºöÊòæÁ§∫‚àöÂõæÊ†á
                 circleContent = `
                     <svg class="status-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                         <polyline points="20,6 9,17 4,12"></polyline>
                     </svg>
                 `;
             } else if (isOverdue) {
                 // ‰ªªÂä°Êú™ÂÆåÊàê‰∏îÂ∑≤ËøáÊúüÔºöÊòæÁ§∫Ë≠¶ÂëäÂõæÊ†áÔºåÂúÜÁéØÊîπ‰∏∫Ê©ôËâ≤
                 circleColor = '#f59e0b';
                 circleContent = `
                     <svg class="status-icon" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                         <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                         <line x1="12" y1="9" x2="12" y2="13"/>
                         <line x1="12" y1="17" x2="12.01" y2="17"/>
                     </svg>
                 `;
             } else {
                 // ‰ªªÂä°Êú™ÂÆåÊàê‰ΩÜÊú™ËøáÊúüÔºöÊòæÁ§∫Ââ©‰ΩôÂ§©Êï∞
                 circleContent = `<span class="days-number">${Math.abs(remainingDays)}</span>`;
             }
             
             // ÂàõÂª∫ÂúÜÁéØËøõÂ∫¶Êù°Âíå‰∏≠ÂøÉÂÜÖÂÆπ
             statusCircleContainer.innerHTML = `
                 <div class="progress-circle">
                     <svg class="progress-ring" width="30" height="30">
                         <circle class="progress-ring-circle-bg" cx="15" cy="15" r="12" fill="transparent" stroke="#e6e6e6" stroke-width="2.5"/>
                         <circle class="progress-ring-circle" cx="15" cy="15" r="12" fill="transparent" stroke="${circleColor}" stroke-width="2.5" 
                             stroke-dasharray="${2 * Math.PI * 12}" 
                             stroke-dashoffset="${2 * Math.PI * 12 * (1 - progressPercentage / 100)}" 
                             transform="rotate(-90 15 15)"/>
                     </svg>
                     <div class="progress-text">
                         ${circleContent}
                     </div>
                 </div>
             `;
             
             // ÂàõÂª∫ÁõÆÊ†áÊ†áÈ¢ò
             const goalTitle = document.createElement('div');
             goalTitle.className = 'goal-title';
             goalTitle.textContent = goal.title || 'Êú™ÂëΩÂêçÁõÆÊ†á';
             
             // Ê∏≤ÊüìÊ†áÁ≠æ
             if (goal.tags && goal.tags.length > 0) {
                 goal.tags.forEach(tag => {
                     const tagElement = document.createElement('span');
                     const colorClass = getTagColorClass(tag);
                     tagElement.className = `goal-tag ${colorClass}`;
                     tagElement.textContent = tag;
                     tagsContainer.appendChild(tagElement);
                 });
             } else {
                 const noTagsElement = document.createElement('span');
                 noTagsElement.className = 'goal-no-tags';
                 noTagsElement.textContent = 'Êó†Ê†áÁ≠æ';
                 tagsContainer.appendChild(noTagsElement);
             }
             
             // goal-date-info ÂÆπÂô®Â∑≤Âà†Èô§
             
             // ÂàõÂª∫Êìç‰ΩúÊåâÈíÆÂå∫Âüü
             const actionButtons = document.createElement('div');
             actionButtons.className = 'goal-action-buttons';
             
             // ÁºñËæëÊåâÈíÆ
             const editButton = document.createElement('button');
             editButton.className = 'goal-action-btn edit-btn';
             editButton.innerHTML = `
                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                     <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                     <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                 </svg>
             `;
             editButton.title = 'ÁºñËæëÁõÆÊ†á';
             
             editButton.addEventListener('click', (e) => {
                 e.stopPropagation();
                 editGoal(goal.goal_id);
             });
             
             // Âà†Èô§ÊåâÈíÆ
             const deleteButton = document.createElement('button');
             deleteButton.className = 'goal-action-btn delete-btn';
             deleteButton.innerHTML = `
                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                     <polyline points="3,6 5,6 21,6"></polyline>
                     <path d="M19,6v14a2,2,0,0,1-2,2H7a2,2,0,0,1-2-2V6m3,0V4a2,2,0,0,1,2-2h4a2,2,0,0,1,2,2V6"></path>
                     <line x1="10" y1="11" x2="10" y2="17"></line>
                     <line x1="14" y1="11" x2="14" y2="17"></line>
                 </svg>
             `;
             deleteButton.title = 'Âà†Èô§ÁõÆÊ†á';
             
             deleteButton.addEventListener('click', (e) => {
                 e.stopPropagation();
                 deleteGoal(goal.goal_id);
             });
             
             // Ê∑ªÂä†ÊåâÈíÆÂà∞Êìç‰ΩúÂå∫Âüü
             actionButtons.appendChild(editButton);
             actionButtons.appendChild(deleteButton);
             
             // Â∞ÜÁä∂ÊÄÅÂúÜÁéØ„ÄÅÊ†áÁ≠æÂíåÊ†áÈ¢òÊ∑ªÂä†Âà∞ÂÆπÂô®‰∏≠ÔºàÁä∂ÊÄÅÂúÜÁéØÂú®Â∑¶ÔºåÊ†áÁ≠æÂú®‰∏≠ÔºåÊ†áÈ¢òÂú®Âè≥Ôºâ
             titleTagContainer.appendChild(statusCircleContainer);
             titleTagContainer.appendChild(tagsContainer);
             titleTagContainer.appendChild(goalTitle);
             
             // ÁªÑË£ÖÁõÆÊ†áÂç°Áâá
             goalCard.appendChild(titleTagContainer);
             goalCard.appendChild(actionButtons);
             
             // ‰∏∫ÁõÆÊ†áÂç°Ê∑ªÂä†ÁÇπÂáª‰∫ã‰ª∂ÁõëÂê¨Âô®
             goalCard.addEventListener('click', (e) => {
                 // ÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°
                 e.stopPropagation();
                 
                 console.log('ÁõÆÊ†áÂç°ÁâáË¢´ÁÇπÂáªÔºågoalÂØπË±°:', goal);
                 console.log('ÁõÆÊ†áID:', goal.goal_id, 'Ê†áÈ¢ò:', goal.title);
                 
                 // Ê£ÄÊü•ÂΩìÂâçÁõÆÊ†áÂç°ÊòØÂê¶Â∑≤ÁªèË¢´ÈÄâ‰∏≠
                 const isCurrentlySelected = goalCard.classList.contains('selected');
                 
                 // ÁßªÈô§ÊâÄÊúâÁõÆÊ†áÂç°ÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
                 document.querySelectorAll('.goal-card.selected').forEach(card => {
                     card.classList.remove('selected');
                 });
                 
                 if (isCurrentlySelected) {
                     // Â¶ÇÊûúÂΩìÂâçÁõÆÊ†áÂç°Â∑≤ÁªèË¢´ÈÄâ‰∏≠ÔºåÂàôÂèñÊ∂àÈÄâ‰∏≠Âπ∂ÈöêËóèÂè≥‰æßÈù¢Êùø
                     console.log('ÂèñÊ∂àÈÄâ‰∏≠ÁõÆÊ†áÂç°Áâá');
                     hideRightPanel();
                     // Ê∏ÖÁ©∫sessionStorage‰∏≠ÁöÑÈÄâ‰∏≠ÁõÆÊ†áID
                     sessionStorage.removeItem('selectedGoalId');
                     // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊï∞ÈáèÊòæÁ§∫‰∏∫0
                     updateProgressRecordButtonCount(null);
                     // Ê∏ÖÁ©∫ËøõÂ±ïËÆ∞ÂΩïÂ±ïÁ§∫
                     loadProgressRecords(null);
                 } else {
                     // Â¶ÇÊûúÂΩìÂâçÁõÆÊ†áÂç°Êú™Ë¢´ÈÄâ‰∏≠ÔºåÂàôÈÄâ‰∏≠Âπ∂ÊòæÁ§∫ÁõÆÊ†á‰ø°ÊÅØ
                     console.log('ÈÄâ‰∏≠ÁõÆÊ†áÂç°ÁâáÔºåÂáÜÂ§áÊòæÁ§∫ÁõÆÊ†á‰ø°ÊÅØ');
                     goalCard.classList.add('selected');
                     
                     // ÈöêËóèËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÂíåËøîÂõûÊåâÈíÆÔºàÂàáÊç¢ÁõÆÊ†áÊó∂Ôºâ
                     const panelSection2 = document.querySelector('.panel-section.panel-section-2:not(.panel-section-record)');
                     const panelSectionRecord = document.querySelector('.panel-section.panel-section-2.panel-section-record');
                     const backToTasksBtn = document.getElementById('backToTasksBtn');
                     const progressRecordBtn = document.getElementById('progressRecordBtn');
                     
                     if (panelSectionRecord && panelSectionRecord.style.display !== 'none') {
                         // Â¶ÇÊûúËøõÂ±ïËÆ∞ÂΩïÈù¢ÊùøÊ≠£Âú®ÊòæÁ§∫ÔºåÂàôÈöêËóèÂÆÉÂπ∂ÊòæÁ§∫ÂéüÈù¢Êùø
                         panelSectionRecord.style.display = 'none';
                         if (panelSection2) {
                             panelSection2.style.display = 'block';
                         }
                         // ÁßªÈô§ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÁöÑÊøÄÊ¥ªÁä∂ÊÄÅ
                         if (progressRecordBtn) {
                             progressRecordBtn.classList.remove('active');
                         }
                     }
                     
                     // ÈöêËóèËøîÂõûÊåâÈíÆ
                     if (backToTasksBtn) {
                         backToTasksBtn.style.display = 'none';
                     }
                     
                     // Á°Æ‰øùgoalÂØπË±°ÊúâÊïàÔºåÂ¶ÇÊûúÊó†ÊïàÂàô‰ªélocalStorageÈáçÊñ∞Ëé∑Âèñ
                     let validGoal = goal;
                     if (!validGoal || !validGoal.goal_id) {
                         console.warn('goalÂØπË±°Êó†ÊïàÔºå‰ªélocalStorageÈáçÊñ∞Ëé∑Âèñ');
                         const goals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
                         const goalId = goalCard.getAttribute('data-goal-id');
                         validGoal = goals.find(g => g.goal_id === goalId);
                         console.log('ÈáçÊñ∞Ëé∑ÂèñÁöÑÁõÆÊ†áÊï∞ÊçÆ:', validGoal);
                     }
                     
                     if (validGoal && validGoal.goal_id) {
                         displayGoalInRightPanel(validGoal);
                         // ‰øùÂ≠òÈÄâ‰∏≠ÁöÑÁõÆÊ†áIDÂà∞sessionStorage
                         sessionStorage.setItem('selectedGoalId', validGoal.goal_id);
                         // Êõ¥Êñ∞ËøõÂ±ïËÆ∞ÂΩïÊåâÈíÆÊï∞ÈáèÊòæÁ§∫
                         updateProgressRecordButtonCount(validGoal.goal_id);
                         // Âä†ËΩΩËøõÂ±ïËÆ∞ÂΩï
                         loadProgressRecords(validGoal.goal_id);
                     } else {
                         console.error('Êó†Ê≥ïËé∑ÂèñÊúâÊïàÁöÑÁõÆÊ†áÊï∞ÊçÆ');
                     }
                 }
             });
             
             return goalCard;
         }
         
         // Ê∑ªÂä†ÊµãËØïÊï∞ÊçÆÂáΩÊï∞
        function addTestGoalsData() {
            const testGoals = [
                {
                    goal_id: 'test_goal_1',
                    title: '2024Âπ¥12ÊúàÁõÆÊ†á',
                    start_date: '2024-12-01',
                    end_date: '2024-12-31',
                    description: 'ÊµãËØï2024Âπ¥12ÊúàÁöÑÁõÆÊ†á',
                    category: 'Â≠¶‰π†',
                    status: 'ËøõË°å‰∏≠'
                },
                {
                    goal_id: 'test_goal_2', 
                    title: '2025Âπ¥1ÊúàÁõÆÊ†á',
                    start_date: '2025-01-01',
                    end_date: '2025-01-31',
                    description: 'ÊµãËØï2025Âπ¥1ÊúàÁöÑÁõÆÊ†á',
                    category: 'Â∑•‰Ωú',
                    status: 'ËøõË°å‰∏≠'
                },
                {
                    goal_id: 'test_goal_3',
                    title: 'Ë∑®Âπ¥ÁõÆÊ†á(2024Âπ¥12Êúà-2025Âπ¥2Êúà)',
                    start_date: '2024-12-15',
                    end_date: '2025-02-15',
                    description: 'ÊµãËØïË∑®Âπ¥ÁöÑÁõÆÊ†á',
                    category: 'È°πÁõÆ',
                    status: 'ËøõË°å‰∏≠'
                },
                {
                    goal_id: 'test_goal_4',
                    title: '2025Âπ¥3ÊúàÁõÆÊ†á',
                    start_date: '2025-03-01',
                    end_date: '2025-03-31',
                    description: 'ÊµãËØï2025Âπ¥3ÊúàÁöÑÁõÆÊ†á',
                    category: 'ÂÅ•Â∫∑',
                    status: 'ËøõË°å‰∏≠'
                },
                {
                    goal_id: 'test_goal_5',
                    title: 'ÈïøÊúüÁõÆÊ†á(2024Âπ¥11Êúà-2025Âπ¥6Êúà)',
                    start_date: '2024-11-01',
                    end_date: '2025-06-30',
                    description: 'ÊµãËØïÈïøÊúüÁõÆÊ†á',
                    category: '‰∏™‰∫∫ÂèëÂ±ï',
                    status: 'ËøõË°å‰∏≠'
                }
            ];
            
            // Ëé∑ÂèñÁé∞ÊúâÁõÆÊ†á
            const existingGoals = JSON.parse(localStorage.getItem('gms_micro_goals') || '[]');
            
            // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÊúâÊµãËØïÊï∞ÊçÆ
            const hasTestData = existingGoals.some(goal => goal.goal_id && goal.goal_id.startsWith('test_goal_'));
            
            if (!hasTestData) {
                // ÂêàÂπ∂ÊµãËØïÊï∞ÊçÆÂíåÁé∞ÊúâÊï∞ÊçÆ
                const allGoals = [...existingGoals, ...testGoals];
                localStorage.setItem('gms_micro_goals', JSON.stringify(allGoals));
                console.log('Â∑≤Ê∑ªÂä†ÊµãËØïÊï∞ÊçÆÂà∞localStorage');
                
                // ÈáçÊñ∞Âä†ËΩΩÁõÆÊ†áÂàóË°®
                if (typeof loadGoalsToContainer === 'function') {
                    loadGoalsToContainer();
                }
            } else {
                console.log('ÊµãËØïÊï∞ÊçÆÂ∑≤Â≠òÂú®ÔºåË∑≥ËøáÊ∑ªÂä†');
            }
        }
        
        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñÊúà‰ªΩÁ≠õÈÄâÂô®
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                initCalendarFilter();
                // Ê≥®ÈáäÊéâËá™Âä®Ê∑ªÂä†ÊµãËØïÊï∞ÊçÆÔºåÈÅøÂÖçÊØèÊ¨°Âà∑Êñ∞ÈÉΩÊ∑ªÂä†
                // addTestGoalsData();
            }, 500);
        });
        
        // Ê∑ªÂä†ÂÖ®Â±ÄÂáΩÊï∞‰æõË∞ÉËØï‰ΩøÁî®
        window.addTestGoalsData = addTestGoalsData;
        window.testCalendarFilter = function(months) {
            selectedMonths = months;
            console.log('ÊâãÂä®ËÆæÁΩÆÁ≠õÈÄâÊúà‰ªΩ:', selectedMonths);
            applyCalendarFilter();
        };
    </script>

    <!-- ËøõÂ±ïËÆ∞ÂΩïÁºñËæëËèúÂçïÂºπÁ™ó -->
    <div id="progressRecordEditMenu" style="display: none; position: absolute; background: white; border: 1px solid #ddd; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.15); z-index: 2000; min-width: 100px;">
        <div class="edit-menu-item" data-action="edit" style="padding: 8px 16px; cursor: pointer; font-size: 14px; color: #333; border-bottom: 1px solid #eee; transition: background-color 0.2s;">
            <span>ÁºñËæë</span>
        </div>
        <div class="edit-menu-item" data-action="delete" style="padding: 8px 16px; cursor: pointer; font-size: 14px; color: #dc3545; transition: background-color 0.2s;">
            <span>Âà†Èô§</span>
        </div>
    </div>

    <!-- ÂÖ≥ËÅî‰ªªÂä°ÂºπÁ™ó -->
    <div id="linkTaskModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 3000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 800px; max-height: 80vh; background: white; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); overflow: hidden;">
            <!-- ÂºπÁ™óÂ§¥ÈÉ® -->
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid #eee; background: #f8f9fa;">
                <h3 style="margin: 0; color: #333; font-size: 18px;">üîó ÂÖ≥ËÅî‰ªªÂä°</h3>
                <button id="linkTaskModalClose" style="background: transparent; border: none; font-size: 24px; cursor: pointer; color: #666; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">&times;</button>
            </div>
            
            <!-- ÂºπÁ™óÂÜÖÂÆπ -->
            <div style="padding: 20px; max-height: 60vh; overflow-y: auto;">
                <!-- Ê†áÁ≠æÂ∫ìÂíåÊêúÁ¥¢Âå∫Âüü -->
                <div id="projectFilterContainer" style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <!-- ÊêúÁ¥¢Ê°Ü -->
                    <div style="margin-bottom: 12px;">
                        <input type="text" id="projectSearchInput" placeholder="ÊêúÁ¥¢È°πÁõÆÂêçÁß∞..." style="width: calc(100% - 24px); padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; outline: none; transition: border-color 0.2s; box-sizing: border-box;" onmouseover="this.style.borderColor='#007bff'" onmouseout="this.style.borderColor='#ddd'" onfocus="this.style.borderColor='#007bff'" onblur="this.style.borderColor='#ddd'">
                    </div>
                    
                    <!-- Ê†áÁ≠æÁ≠õÈÄâÂå∫Âüü -->
                    <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                        <span style="color: #666; font-size: 13px; margin-right: 5px;">ÂàÜÁ±ªÁ≠õÈÄâÔºö</span>
                        <div id="projectTagsContainer" style="display: flex; flex-wrap: wrap; gap: 6px;">
                            <!-- Ê†áÁ≠æÊåâÈíÆÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                        </div>
                    </div>
                </div>
                
                <!-- È°πÁõÆÂàóË°®ÂÆπÂô® -->
                <div id="linkTaskProjectList" style="margin-bottom: 20px;">
                    <!-- È°πÁõÆÂç°ÁâáÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                </div>
                
                <!-- Â∑≤ÈÄâÊã©ÁöÑ‰ªªÂä°ÊòæÁ§∫ -->
                <div id="selectedTasksContainer" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; display: none;">
                    <h4 style="margin: 0 0 10px 0; color: #333; font-size: 14px;">Â∑≤ÈÄâÊã©ÁöÑ‰ªªÂä°Ôºö</h4>
                    <div id="selectedTasksList" style="display: flex; flex-wrap: wrap; gap: 8px;">
                        <!-- Â∑≤ÈÄâÊã©ÁöÑ‰ªªÂä°Ê†áÁ≠æÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                    </div>
                </div>
            </div>
            
            <!-- ÂºπÁ™óÂ∫ïÈÉ® -->
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 20px; border-top: 1px solid #eee; background: #f8f9fa;">
                <div style="color: #666; font-size: 13px;">
                    ÂÖ≥ËÅîÁ±ªÂûãÔºö<strong>Ê†∏ÂøÉ‰ªªÂä°</strong> | ÂÖ≥ËÅîÂº∫Â∫¶Ôºö<strong>5</strong>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button id="linkTaskCancel" style="padding: 8px 20px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">ÂèñÊ∂à</button>
                    <button id="linkTaskSubmit" style="padding: 8px 20px; background: #50b767; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;" disabled>Á°ÆËÆ§ÂÖ≥ËÅî</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>