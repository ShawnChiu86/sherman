<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GMS成长系统 - 学习计划日历</title>
    <link rel="stylesheet" href="gms.css">
</head>
<body>
    <div class="header">
    <button id="dataStatsBtn">数据统计</button>
    <button id="backupBtn" style="background: #4CAF50; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-size: 14px; margin-right: 10px;">💾 备份数据</button>
    
    <a href="学习计划表.html"><button>切换到 打卡模式</button></a>
    

    
        <div class="font-size-control">
            <span>任务字体大小:</span>
            <input type="range" id="fontSizeSlider" min="12" max="24" value="16">
            <span id="fontSizeValue">16px</span>
        </div>
</div>
    <div style="height: 5px;"></div> <!-- 为固定header添加占位 -->
    
    <!-- 滑块式菜单导航层 -->
    <div class="nav-menu-container">
        <div class="nav-menu">
            <div class="nav-menu-item active" data-tab="home">
                <span>首页</span>
            </div>
            <div class="nav-menu-item" data-tab="process">
                <span>进程管理</span>
            </div>
            <div class="nav-menu-item" data-tab="project">
                <span>项目管理</span>
            </div>
            <div class="nav-menu-item" data-tab="plan">
                <span>计划管理</span>
            </div>
            <div class="nav-slider"></div>
        </div>
    </div>
    
    <!-- 内容容器 -->
    <div class="content-container">
        <!-- 首页容器 -->
        <div class="content-panel active" id="home-panel">
            <div class="panel-content">
                <!-- 统计卡片区域 -->
                <div class="stats-cards">
                    <div class="stats-card">
                        <div class="stats-icon">📅</div>
                        <div class="stats-content">
                            <div class="stats-title">今日任务</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">已完成</span>
                                    <span class="stats-value" id="todayCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">总任务</span>
                                    <span class="stats-value" id="todayTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">用时</span>
                                    <span class="stats-value" id="todayTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon">📊</div>
                        <div class="stats-content">
                            <div class="stats-title">本周任务</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">已完成</span>
                                    <span class="stats-value" id="weekCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">总任务</span>
                                    <span class="stats-value" id="weekTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">用时</span>
                                    <span class="stats-value" id="weekTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon">📈</div>
                        <div class="stats-content">
                            <div class="stats-title">本月任务</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">已完成</span>
                                    <span class="stats-value" id="monthCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">总任务</span>
                                    <span class="stats-value" id="monthTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">用时</span>
                                    <span class="stats-value" id="monthTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-card">
                        <div class="stats-icon">🎯</div>
                        <div class="stats-content">
                            <div class="stats-title">年任务数据</div>
                            <div class="stats-numbers">
                                <div class="stats-item">
                                    <span class="stats-label">已完成</span>
                                    <span class="stats-value" id="yearCompleted">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">总任务</span>
                                    <span class="stats-value" id="yearTotal">0</span>
                                </div>
                                <div class="stats-item">
                                    <span class="stats-label">用时</span>
                                    <span class="stats-value" id="yearTime">0h</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 分类用时统计容器 -->
                <div class="category-time-stats">
                    <div class="category-time-header">
                        <div class="category-time-title-section">
                            <h3>分类用时统计</h3>
                            <select id="categoryTimeFilter" class="category-time-select">
                                <option value="all">全部</option>
                                <option value="thisYear">今年</option>
                                <option value="thisMonth">本月</option>
                                <option value="1">1月</option>
                                <option value="2">2月</option>
                                <option value="3">3月</option>
                                <option value="4">4月</option>
                                <option value="5">5月</option>
                                <option value="6">6月</option>
                                <option value="7">7月</option>
                                <option value="8">8月</option>
                                <option value="9">9月</option>
                                <option value="10">10月</option>
                                <option value="11">11月</option>
                                <option value="12">12月</option>
                            </select>
                        </div>
                        <span class="category-time-subtitle">各分类已完成任务用时对比</span>
                    </div>
                    <div class="category-time-bars" id="categoryTimeBars">
                        <!-- 分类用时条将在这里动态生成 -->
                    </div>
                </div>
                
                <!-- 新增的两个并排容器 -->
                <div class="additional-containers">
                    <div class="additional-container left-container">
                        <div class="container-header">
                            <h3>项目用时排名</h3>
                            <span class="container-subtitle">已完成任务用时排行</span>
                        </div>
                        <div class="project-time-ranking">
                            <div class="ranking-header">
                                <div class="ranking-project-name">项目名称</div>
                                <div class="ranking-time">用时</div>
                                <div class="ranking-progress">进度</div>
                            </div>
                            <div class="ranking-list" id="projectTimeRankingList">
                                <!-- 项目排名列表将在这里动态生成 -->
                            </div>
                            <div class="load-more-container" id="loadMoreContainer" style="display: none;">
                                <button class="load-more-btn" id="loadMoreBtn">加载更多</button>
                            </div>
                        </div>
                    </div>
                    <div class="additional-container right-container">
                        <div class="container-header">
                            <h3>任务用时统计</h3>
                            <div class="view-toggle">
                                <button class="toggle-btn active" data-view="daily">按日</button>
                                <button class="toggle-btn" data-view="monthly">按月</button>
                            </div>
                        </div>
                        <div class="task-time-stats-container">
                            <!-- 按日视图 -->
                            <div class="task-time-view daily-view" id="dailyTaskView">
                                <div class="task-time-header">
                                    <div class="task-time-date sortable" data-sort="date">
                                        日期 <span class="sort-icon">↕</span>
                                    </div>
                                    <div class="task-time-count sortable" data-sort="count">
                                        已完成 <span class="sort-icon">↕</span>
                                    </div>
                                    <div class="task-time-duration sortable" data-sort="duration">
                                        用时 <span class="sort-icon">↕</span>
                                    </div>
                                    <div class="task-time-progress">进度</div>
                                </div>
                                <div class="task-time-list" id="dailyTaskList">
                                    <!-- 日任务列表将在这里动态生成 -->
                                </div>
                            </div>
                            
                            <!-- 按月视图 -->
                            <div class="task-time-view monthly-view" id="monthlyTaskView" style="display: none;">
                                <div class="task-time-header">
                                    <div class="task-time-month sortable" data-sort="month">
                                        月份 <span class="sort-icon">↕</span>
                                    </div>
                                    <div class="task-time-count sortable" data-sort="count">
                                        已完成 <span class="sort-icon">↕</span>
                                    </div>
                                    <div class="task-time-duration sortable" data-sort="duration">
                                        用时 <span class="sort-icon">↕</span>
                                    </div>
                                    <div class="task-time-progress">进度</div>
                                </div>
                                <div class="task-time-list" id="monthlyTaskList">
                                    <!-- 月任务列表将在这里动态生成 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="intro-cards">
                    <div class="intro-card">
                        <h3>进程管理说明</h3>
                        <h4>Process Management</h4>
                        <p>内容准备中...</p>
                    </div>
                    <div class="intro-card">
                        <h3>项目管理说明</h3>
                        <h4>Project Management</h4>
                        <p>内容准备中...</p>
                    </div>
                    <div class="intro-card">
                        <h3>计划管理</h3>
                        <h4>Plan Management</h4>
                        <p>内容准备中...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 进程管理容器 -->
        <div class="content-panel" id="process-panel">
            <div class="panel-content">
                <h2>进程管理</h2>
                <p>开发中...</p>
            </div>
        </div>
        
        <!-- 项目管理容器 -->
        <div class="content-panel" id="project-panel">
            <div class="panel-content">
                
                <!-- 搜索和筛选面板 -->
                <div class="project-search-panel">
                    <!-- 搜索区域 - 已移至标题栏 -->
                    <!-- 分类标签区域 -->
                    <div class="category-section">
                        <span class="category-label">分类：</span>
                        <div id="projectPanelCategoryTags" class="category-tags-container"></div>
                    </div>
                </div>
                
                <!-- 主要内容区域 -->
                <div class="project-main-content">
                    <!-- 左侧项目清单 -->
                    <div class="project-list-section">
                        <div class="project-list-header">
                            <!-- 搜索图标 -->
                            <div class="search-icon-container" id="searchIconContainer">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <path d="m21 21-4.35-4.35"></path>
                                </svg>
                                <!-- 展开的搜索框 -->
                                <div class="search-input-expanded" id="searchInputExpanded">
                                    <input type="text" id="headerProjectSearch" placeholder="搜索项目..." class="header-search-input">
                                    <button id="headerClearSearch" class="header-clear-btn">×</button>
                                </div>
                            </div>
                            <h3>项目清单</h3>
                            <div id="addProjectBtn" class="add-project-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 24 24" fill="#50b767" class="icon icon-tabler icons-tabler-filled icon-tabler-square-rounded-plus">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
                                    <path d="M12 2l.324 .001l.318 .004l.616 .017l.299 .013l.579 .034l.553 .046c4.785 .464 6.732 2.411 7.196 7.196l.046 .553l.034 .579c.005 .098 .01 .198 .013 .299l.017 .616l.005 .642l-.005 .642l-.017 .616l-.013 .299l-.034 .579l-.046 .553c-.464 4.785 -2.411 6.732 -7.196 7.196l-.553 .046l-.579 .034c-.098 .005 -.198 .01 -.299 .013l-.616 .017l-.642 .005l-.642 -.005l-.616 -.017l-.299 -.013l-.579 -.034l-.553 -.046c-4.785 -.464 -6.732 -2.411 -7.196 -7.196l-.046 -.553l-.034 -.579a28.058 28.058 0 0 1 -.013 -.299l-.017 -.616c-.003 -.21 -.005 -.424 -.005 -.642l.001 -.324l.004 -.318l.017 -.616l.013 -.299l.034 -.579l.046 -.553c.464 -4.785 2.411 -6.732 7.196 -7.196l.553 -.046l.579 -.034c.098 -.005 .198 -.01 .299 -.013l.616 -.017c.21 -.003 .424 -.005 .642 -.005zm0 6a1 1 0 0 0 -1 1v2h-2l-.117 .007a1 1 0 0 0 .117 1.993h2v2l.007 .117a1 1 0 0 0 1.993 -.117v-2h2l.117 -.007a1 1 0 0 0 -.117 -1.993h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z" fill="#50b767" stroke-width="0" />
                                </svg>
                                <div class="text-button">添加项目</div>
                            </div>
                        </div>
                        <div id="projectPanelList" class="project-panel-list">
                            <!-- 弹力区域 -->
                            <div class="bounce-area">
                                <div class="bounce-message">
                                    <span class="bounce-icon">🔝</span>
                                    <span>已经到顶啦！</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 右侧子任务展示 -->
                    <div class="subtask-section">
                        <div class="subtask-header">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <h3>子任务详情</h3>
                                <span id="selectedProjectName" class="selected-project-name"></span>
                            </div>

                        </div>
                        

                        
                        <div id="projectPanelSubtaskList" class="subtask-panel-list"></div>
                        
                        <!-- 子任务底部操作栏 -->
                        <div class="subtask-bottom" id="subtaskBottom" style="display: none;">
                            <div class="subtask-bottom-left">
                                <label class="select-all-checkbox">
                                    <input type="checkbox" id="selectAllSubtasks">
                                    <span>全选未完成任务 <span class="selected-count">(0)</span></span>
                                </label>
                            </div>
                            <div class="subtask-bottom-right">
                                <button class="batch-btn batch-delete-btn" id="batchDeleteSubtasks" disabled>批量删除</button>
                                <div style="position: relative;">
                                    <button class="batch-btn batch-edit-btn" id="batchEditSubtasks" disabled>批量编辑</button>
                                    <div class="batch-edit-menu" id="batchEditMenu">
                                        <div class="batch-menu-item" data-action="consumingTime">批量改用时</div>
                                        <div class="batch-menu-item" data-action="schedule">批量排期</div>
                                        <div class="batch-menu-item" data-action="startTime">批量开始时间</div>
                                        <div class="batch-menu-item" data-action="complete">批量完成</div>
                                        <div class="batch-menu-item" data-action="dailyPlan">批量计划每天</div>
                                        <div class="batch-menu-item" data-action="weeklyPlan">批量计划每周</div>
                                        <div class="batch-menu-item" data-action="noPlan">批量取消计划</div>
                                        <div class="batch-menu-item" data-action="unifyName">统一名称</div>
                                        <div class="batch-menu-item" data-action="unifyDate">统一日期</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    

                </div>
            </div>
        </div>
        
                <!-- 计划管理容器 -->
        <div class="content-panel" id="plan-panel">
            <div class="calendar-container">
                <div class="month-view active-view" id="monthView">
                    <div class="day-panel" id="dayPanel">
                        
                    </div>
                    <div class="month-panel" id="monthPanel"></div>
                    <div class="taskpicker-panel" id="taskpickerPanel">
                        <div class="taskpicker-header">
                          <!--  <h3 style="text-align: center; color: #50b767; margin-bottom: 15px;">任务选择器</h3>-->
                            
                            <!-- 搜索功能 -->
                            <div class="taskpicker-search-section">
                                <div class="taskpicker-search-section-left">在这里选择要添加的任务：</div>
                                <input type="text" id="taskpickerSearchInput" placeholder="搜索项目或任务..." class="taskpicker-search-input">
                                <button id="taskpickerClearSearch" class="taskpicker-clear-btn">清除</button>
                </div>
                            
                            <!-- 分类标签 -->
                            <div class="taskpicker-category-section">
                                <span class="taskpicker-category-label">分类：</span>
                                <div id="taskpickerCategoryTags" class="taskpicker-category-tags-container"></div>
                            </div>
                        </div>
                        
                        <div id="projectListContainer" class="project-list-container">
                            <!-- 项目列表将在这里动态生成 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 模态遮罩层 -->
    <div id="modalOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1999;"></div>
    
    <!-- 设置弹窗 -->
    <div id="settingsModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 630px; background: white; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 2000; padding: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px;">
            <h3 style="margin: 0;">系统设置</h3>
           <button id="closeSettingsBtn" style="background: transparent; border: none; font-size: 20px; cursor: pointer;">&times;</button>
        </div>
        <div style="display: flex; border-bottom: 1px solid #eee; margin-bottom: 15px;">
            <button class="tab-btn active" data-tab="holidays" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #50b767;">节假日设置</button>
            <button class="tab-btn" data-tab="temporary" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">临时计划管理</button>
            <button class="tab-btn" data-tab="backup" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">数据备份</button>
            <button class="tab-btn" data-tab="autoBackup" style="flex: 1; padding: 10px; border: none; background: transparent; cursor: pointer; font-weight: bold; color: #666;">自动备份设置</button>
        </div>
        <div class="tab-content" id="holidaysContent">
            <!-- 节假日设置内容 -->
            <div style="margin-bottom: 15px;">
                <h4 style="margin: 0 0 10px 0;">自定义节假日</h4>
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <input type="text" id="holidayDate" placeholder="日期 (MM-DD)" style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="text" id="holidayName" placeholder="节假日名称" style="flex: 2; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <button id="addHolidayBtn" style="padding: 8px 15px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer;">添加</button>
                    <button id="refreshHolidaysBtn" style="padding: 8px 15px; background: #ffc107; color: white; border: none; border-radius: 4px; cursor: pointer;">刷新列表</button>
                </div>

            </div>
            <div>
                <h4 style="margin: 0 0 10px 0;">节假日列表</h4>
                <div id="holidaysList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 4px; padding: 10px;"></div>
            </div>
        </div>
        <div class="tab-content" id="temporaryContent" style="display: none;">
            <!-- 临时计划管理内容 -->
            <div style="margin-bottom: 15px;">
                <h4 style="margin: 0 0 10px 0;">添加临时计划</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
                    <input type="text" id="planName" placeholder="计划名称" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="date" id="planDate" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="time" id="planStartTime" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    <input type="time" id="planEndTime" style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <button id="addPlanBtn" style="padding: 8px 15px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer;">添加计划</button>
            </div>
            <div>
                <h4 style="margin: 0 0 10px 0;">临时计划列表</h4>
                <div id="plansList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 4px; padding: 10px;"></div>
            </div>
        </div>
        <div class="tab-content" id="backupContent" style="display: none;">
            <!-- 数据备份和恢复内容 -->
            <div style="height: 400px; overflow-y: auto; padding-right: 10px;">
                <h4 style="margin: 0 0 15px 0; color: #50b767;">💾 数据备份与恢复</h4>
                
                <!-- 备份功能 -->
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 10px 0; color: #333;">📤 备份数据</h5>
                    <p style="margin: 0 0 10px 0; font-size: 13px; color: #666;">将当前所有数据导出为备份文件，包含项目、标签、设置等信息。</p>
                    <button id="manualBackupBtn" style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">立即备份</button>
                </div>
                
                <!-- 恢复功能 -->
                <div style="margin-bottom: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                    <h5 style="margin: 0 0 10px 0; color: #856404;">📥 恢复数据</h5>
                    <p style="margin: 0 0 10px 0; font-size: 13px; color: #856404;">⚠️ 警告：恢复数据将覆盖当前所有数据，请谨慎操作！</p>
                    <input type="file" id="restoreFileInput" accept=".json" style="display: none;">
                    <button id="restoreDataBtn" style="padding: 8px 16px; background: #ffc107; color: #333; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">选择备份文件恢复</button>
                </div>
                
                <!-- localStorage使用量监控 -->
                <div style="margin-bottom: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffeaa7;">
                    <h5 style="margin: 0 0 10px 0; color: #856404;">💾 localStorage使用量监控</h5>
                    <p style="margin: 0 0 15px 0; font-size: 13px; color: #856404;">监控浏览器本地存储空间使用情况</p>
                    
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <span style="font-size: 13px; color: #856404;">使用进度</span>
                            <span id="storageUsageText" style="font-size: 12px; color: #856404; font-weight: bold;">0 KB / 5 MB</span>
                        </div>
                        <div style="width: 100%; height: 8px; background: #f0f0f0; border-radius: 4px; overflow: hidden;">
                            <div id="storageUsageBar" style="height: 100%; background: linear-gradient(90deg, #4CAF50, #8BC34A); width: 0%; transition: width 0.3s ease; border-radius: 4px;"></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #856404;">
                        <span>已使用：<span id="usedStorage">0 KB</span></span>
                        <span>可用：<span id="availableStorage">5 MB</span></span>
                    </div>
                    
                    <div style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.5); border-radius: 4px;">
                        <div style="font-size: 11px; color: #856404;">
                            <div style="margin-bottom: 3px;">📊 存储详情：</div>
                            <div id="storageDetails" style="font-family: monospace; font-size: 10px;">
                                <!-- 动态显示存储详情 -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 备份说明 -->
                <div style="padding: 15px; background: #e7f3ff; border-radius: 8px; border: 1px solid #b3d9ff;">
                    <h5 style="margin: 0 0 10px 0; color: #0066cc;">ℹ️ 备份说明</h5>
                    <ul style="margin: 0; padding-left: 20px; font-size: 13px; color: #0066cc;">
                        <li>自动备份：根据设置自动备份（可在"自动备份设置"中配置）</li>
                        <li>手动备份：点击"立即备份"按钮手动创建备份</li>
                        <li>备份文件：包含项目、标签、设置等完整数据</li>
                        <li>文件位置：备份文件将下载到您的"下载"文件夹</li>
                        <li>详细设置：请查看"自动备份设置"标签页</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="tab-content" id="autoBackupContent" style="display: none;">
            <!-- 自动备份设置内容 -->
            <div style="height: 400px; overflow-y: auto; padding-right: 10px;">
                <h4 style="margin: 0 0 15px 0; color: #50b767;">⚙️ 自动备份设置</h4>
                
                <!-- 自动备份开关 -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                        <div>
                            <h5 style="margin: 0 0 3px 0; color: #333; font-size: 14px;">🔄 自动备份功能</h5>
                            <p style="margin: 0; font-size: 12px; color: #666;">启用后，系统会在数据变更时自动创建备份</p>
                        </div>
                        <label style="position: relative; display: inline-block; width: 50px; height: 24px;">
                            <input type="checkbox" id="autoBackupEnabled" style="opacity: 0; width: 0; height: 0;">
                            <span id="autoBackupToggle" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;">
                                <span id="autoBackupSlider" style="position: absolute; content: ''; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%;"></span>
                            </span>
                        </label>
                    </div>
                </div>
                
                <!-- 备份间隔设置 -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">⏱️ 备份间隔设置</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">设置自动备份的最小时间间隔，避免频繁备份</p>
                    
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                        <label style="font-size: 13px; color: #333;">最小备份间隔：</label>
                        <select id="backupIntervalSelect" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            <option value="1">1分钟</option>
                            <option value="5" selected>5分钟</option>
                            <option value="10">10分钟</option>
                            <option value="15">15分钟</option>
                            <option value="30">30分钟</option>
                            <option value="60">1小时</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <label style="font-size: 13px; color: #333;">延迟执行时间：</label>
                        <select id="backupDelaySelect" style="padding: 4px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 13px;">
                            <option value="1">1秒</option>
                            <option value="2" selected>2秒</option>
                            <option value="3">3秒</option>
                            <option value="5">5秒</option>
                        </select>
                    </div>
                </div>
                
                <!-- 备份模式设置 -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">📁 备份模式设置</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">选择自动备份的行为方式</p>
                    
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="radio" id="backupModeDownload" name="backupMode" value="download" checked>
                            <span>自动下载备份文件</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">每次备份时自动下载文件到下载文件夹</p>
                    </div>
                    
                    <div>
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="radio" id="backupModeSilent" name="backupMode" value="silent">
                            <span>静默保存到浏览器</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">备份文件保存在浏览器内部，不自动下载</p>
                    </div>
                </div>
                
                <!-- 备份通知设置 -->
                <div style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">
                    <h5 style="margin: 0 0 8px 0; color: #333; font-size: 14px;">🔔 备份通知设置</h5>
                    <p style="margin: 0 0 10px 0; font-size: 12px; color: #666;">设置备份完成后的通知方式</p>
                    
                    <div style="margin-bottom: 8px;">
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="checkbox" id="backupNotificationEnabled" checked>
                            <span>显示备份状态提示</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">备份完成后在右上角显示状态提示</p>
                    </div>
                    
                    <div>
                        <label style="display: flex; align-items: center; gap: 6px; font-size: 13px; color: #333;">
                            <input type="checkbox" id="backupConsoleLogEnabled" checked>
                            <span>在控制台输出日志</span>
                        </label>
                        <p style="margin: 3px 0 0 18px; font-size: 11px; color: #666;">在浏览器控制台显示详细的备份日志</p>
                    </div>
                </div>
                
                <!-- 当前设置状态 -->
                <div style="padding: 12px; background: #e7f3ff; border-radius: 8px; border: 1px solid #b3d9ff;">
                    <h5 style="margin: 0 0 8px 0; color: #0066cc; font-size: 14px;">📊 当前设置状态</h5>
                    <div id="backupSettingsStatus" style="font-size: 12px; color: #0066cc;">
                        <div style="margin-bottom: 3px;">自动备份：<span id="statusAutoBackup">已启用</span></div>
                        <div style="margin-bottom: 3px;">备份间隔：<span id="statusInterval">5分钟</span></div>
                        <div style="margin-bottom: 3px;">备份模式：<span id="statusMode">自动下载</span></div>
                        <div>上次备份：<span id="statusLastBackup">未备份</span></div>
                    </div>
                </div>
            </div>
        </div>
        <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
            <button id="confirmSettingsBtn" style="padding: 5px 10px; background: #50b767; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px;">确认</button>
        </div>
    </div>

  <script src="gms.js"></script>
  
</body>
</html>